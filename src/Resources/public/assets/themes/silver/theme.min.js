!function(){"use strict";var t=function(){},n=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t(n.apply(null,e))}},e=function(t){return function(){return t}},o=function(t){return t};function r(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=n.concat(e);return t.apply(null,r)}}var i=function(t){return function(n){return!t(n)}},u=function(t){return function(){throw new Error(t)}},a=e(!1),c=e(!0),s=tinymce.util.Tools.resolve("tinymce.ThemeManager"),l=function(){return(l=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)};function f(t,n){var e={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&n.indexOf(o)<0&&(e[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(e[o[r]]=t[o[r]])}return e}function d(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var o=Array(t),r=0;for(n=0;n<e;n++)for(var i=arguments[n],u=0,a=i.length;u<a;u++,r++)o[r]=i[u];return o}var m,g,p,h,v,b=function(){return y},y=(m=function(t){return t.isNone()},{fold:function(t,n){return t()},is:a,isSome:a,isNone:c,getOr:p=function(t){return t},getOrThunk:g=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:e(null),getOrUndefined:e(void 0),or:p,orThunk:g,map:b,each:t,bind:b,exists:a,forall:c,filter:b,equals:m,equals_:m,toArray:function(){return[]},toString:e("none()")}),x=function(t){var n=e(t),o=function(){return i},r=function(n){return n(t)},i={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:c,isNone:a,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:o,orThunk:o,map:function(n){return x(n(t))},each:function(n){n(t)},bind:r,exists:r,forall:r,filter:function(n){return n(t)?i:y},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(a,(function(n){return e(t,n)}))}};return i},w={some:x,none:b,from:function(t){return null==t?y:x(t)}},S=function(t){return function(n){return o=typeof(e=n),(null===e?"null":"object"==o&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==o&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":o)===t;var e,o}},k=function(t){return function(n){return typeof n===t}},C=S("string"),O=S("object"),_=S("array"),T=k("boolean"),E=(void 0,function(t){return undefined===t}),B=function(t){return!(null===(n=t)||void 0===n);var n},A=k("function"),M=k("number"),D=function(t,n){if(_(t)){for(var e=0,o=t.length;e<o;++e)if(!n(t[e]))return!1;return!0}return!1},F=Array.prototype.slice,I=Array.prototype.indexOf,R=Array.prototype.push,V=function(t,n){return I.call(t,n)},P=function(t,n){return-1<V(t,n)},H=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return!0;return!1},z=function(t,n){for(var e=[],o=0;o<t;o++)e.push(n(o));return e},N=function(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=F.call(t,o,o+n);e.push(r)}return e},L=function(t,n){for(var e=t.length,o=new Array(e),r=0;r<e;r++){var i=t[r];o[r]=n(i,r)}return o},j=function(t,n){for(var e=0,o=t.length;e<o;e++)n(t[e],e)},U=function(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r];(n(u,r)?e:o).push(u)}return{pass:e,fail:o}},W=function(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o];n(i,o)&&e.push(i)}return e},G=function(t,n,e){return function(t,n){for(var e=t.length-1;0<=e;e--)n(t[e])}(t,(function(t){e=n(e,t)})),e},X=function(t,n,e){return j(t,(function(t){e=n(e,t)})),e},Y=function(t,n){return function(t,n,e){for(var o=0,r=t.length;o<r;o++){var i=t[o];if(n(i,o))return w.some(i);if(e(i,o))break}return w.none()}(t,n,a)},q=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return w.some(e);return w.none()},K=function(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!_(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);R.apply(n,t[e])}return n},J=function(t,n){return K(L(t,n))},$=function(t,n){for(var e=0,o=t.length;e<o;++e)if(!0!==n(t[e],e))return!1;return!0},Q=function(t){var n=F.call(t,0);return n.reverse(),n},Z=function(t,n){return W(t,(function(t){return!P(n,t)}))},tt=function(t,n){var e=F.call(t,0);return e.sort(n),e},nt=function(t,n){return 0<=n&&n<t.length?w.some(t[n]):w.none()},et=function(t){return nt(t,0)},ot=function(t){return nt(t,t.length-1)},rt=A(Array.from)?Array.from:function(t){return F.call(t)},it=function(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e);if(o.isSome())return o}return w.none()},ut=function(t){return{is:function(n){return t===n},isValue:c,isError:a,getOr:e(t),getOrThunk:e(t),getOrDie:e(t),or:function(n){return ut(t)},orThunk:function(n){return ut(t)},fold:function(n,e){return e(t)},map:function(n){return ut(n(t))},mapError:function(n){return ut(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOptional:function(){return w.some(t)}}},at=function(n){return{is:a,isValue:a,isError:c,getOr:o,getOrThunk:function(t){return t()},getOrDie:function(){return u(String(n))()},or:function(t){return t},orThunk:function(t){return t()},fold:function(t,e){return t(n)},map:function(t){return at(n)},mapError:function(t){return at(t(n))},each:t,bind:function(t){return at(n)},exists:a,forall:c,toOptional:w.none}},ct={value:ut,error:at,fromOption:function(t,n){return t.fold((function(){return at(n)}),ut)}};(v=h=h||{})[v.Error=0]="Error",v[v.Value=1]="Value";var st,lt,ft=function(t,n,e){return t.stype===h.Error?n(t.serror):e(t.svalue)},dt=function(t){return{stype:h.Value,svalue:t}},mt=function(t){return{stype:h.Error,serror:t}},gt=dt,pt=function(t){var n=[],e=[];return j(t,(function(t){ft(t,(function(t){return e.push(t)}),(function(t){return n.push(t)}))})),{values:n,errors:e}},ht=mt,vt=function(t,n){return t.stype===h.Value?n(t.svalue):t},bt=function(t,n){return t.stype===h.Value?{stype:h.Value,svalue:n(t.svalue)}:t},yt=Object.keys,xt=Object.hasOwnProperty,wt=function(t,n){for(var e=yt(t),o=0,r=e.length;o<r;o++){var i=e[o];n(t[i],i)}},St=function(t,n){return kt(t,(function(t,e){return{k:e,v:n(t,e)}}))},kt=function(t,n){var e={};return wt(t,(function(t,o){var r=n(t,o);e[r.k]=r.v})),e},Ct=function(t,n){var e=[];return wt(t,(function(t,o){e.push(n(t,o))})),e},Ot=function(t,n){for(var e=yt(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i];if(n(u,i,t))return w.some(u)}return w.none()},_t=function(t){return Ct(t,(function(t){return t}))},Tt=function(t,n){return Et(t,n)?w.from(t[n]):w.none()},Et=function(t,n){return xt.call(t,n)},Bt=function(t,n){return Et(t,n)&&void 0!==t[n]&&null!==t[n]},At=function(t){if(!_(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var n=[],e={};return j(t,(function(o,r){var i=yt(o);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],a=o[u];if(void 0!==e[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!_(a))throw new Error("case arguments must be an array");n.push(u),e[u]=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var i=e.length;if(i!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+i);return{fold:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(n.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+n.length);return n[r].apply(null,e)},match:function(t){var o=yt(t);if(n.length!==o.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+o.join(","));if(!$(n,(function(t){return P(o,t)})))throw new Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+n.join(", "));return t[u].apply(null,e)},log:function(t){console.log(t,{constructors:n,constructor:u,params:e})}}}})),e},Mt=Object.prototype.hasOwnProperty,Dt=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var o={},r=0;r<n.length;r++){var i=n[r];for(var u in i)Mt.call(i,u)&&(o[u]=t(o[u],i[u]))}return o}},Ft=Dt((function(t,n){return O(t)&&O(n)?Ft(t,n):n})),It=Dt((function(t,n){return n})),Rt=function(t){var n,e=!1;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return e||(e=!0,n=t.apply(null,o)),n}},Vt=At([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Pt=function(t){return Vt.defaultedThunk(e(t))},Ht=Vt.strict,zt=Vt.asOption,Nt=Vt.defaultedThunk,Lt=(Vt.asDefaultedOptionThunk,Vt.mergeWithThunk),jt=(At([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(t,n){var e={};return e[t]=n,e}),Ut=jt,Wt=function(t){return n={},j(t,(function(t){n[t.key]=t.value})),n;var n},Gt=function(t){return n(ht,K)(t)},Xt=function(t){var n=pt(t);return 0<n.errors.length?Gt(n.errors):gt(n.values)},Yt=function(t){return O(t)&&100<yt(t).length?" removed due to size":JSON.stringify(t,null,2)},qt=function(t,n){return ht([{path:t,getErrorInfo:n}])},Kt=At([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Jt=function(t,n,e){var r=Tt(t,n).fold((function(){return e(t)}),o);return gt(r)},$t=function(t,n,o,r){return o.fold((function(o,i,u,a){var c=function(n){var e=a.extract(t.concat([o]),r,n);return bt(e,(function(t){return jt(i,r(t))}))},s=function(n){return n.fold((function(){var t=jt(i,r(w.none()));return gt(t)}),(function(n){var e=a.extract(t.concat([o]),r,n);return bt(e,(function(t){return jt(i,r(w.some(t)))}))}))};return u.fold((function(){return vt(function(t,n,e){return Tt(n,e).fold((function(){return o=e,r=n,qt(t,(function(){return'Could not find valid *strict* value for "'+o+'" in '+Yt(r)}));var o,r}),gt)}(t,n,o),c)}),(function(t){return vt(Jt(n,o,t),c)}),(function(){return vt(gt(Tt(n,o)),s)}),(function(t){return vt((r=t,i=Tt(e=n,o).map((function(t){return!0===t?r(e):t})),gt(i)),s);var e,r,i}),(function(t){var r=t(n),i=bt(Jt(n,o,e({})),(function(t){return Ft(r,t)}));return vt(i,c)}))}),(function(t,e){var o=e(n);return gt(jt(t,r(o)))}))},Qt=function(t){return{extract:function(n,e,o){return function(t,n){return t.stype===h.Error?n(t.serror):t}(t(o,e),(function(t){return e=t,qt(n,(function(){return e}));var e}))},toString:function(){return"val"}}},Zt=function(n){var o=tn(n),r=G(n,(function(t,n){return n.fold((function(n){return Ft(t,Ut(n,!0))}),e(t))}),{});return{extract:function(n,e,i){var u,a=T(i)?[]:yt(function(n,e){var o,r,i,u,a={};return o=e,u=a,r=function(t,n){u[n]=t},i=t,wt(n,(function(t,n){(o(t,n)?r:i)(t,n)})),a}(i,(function(t){return null!=t}))),c=W(a,(function(t){return!Bt(r,t)}));return 0===c.length?o.extract(n,e,i):(u=c,qt(n,(function(){return"There are unsupported fields: ["+u.join(", ")+"] specified"})))},toString:o.toString}},tn=function(t){return{extract:function(n,e,o){return r=n,i=o,u=e,function(t,n){var e,o,r=pt(t);return 0<r.errors.length?Gt(r.errors):(o=n,0<(e=r.values).length?gt(Ft(o,It.apply(void 0,e))):gt(o))}(L(t,(function(t){return $t(r,i,t,u)})),{});var r,i,u},toString:function(){return"obj{\n"+L(t,(function(t){return t.fold((function(t,n,e,o){return t+" -> "+o.toString()}),(function(t,n){return"state("+t+")"}))})).join("\n")+"}"}}},nn=function(t){return{extract:function(n,e,o){var r=L(o,(function(o,r){return t.extract(n.concat(["["+r+"]"]),e,o)}));return Xt(r)},toString:function(){return"array("+t.toString()+")"}}},en=function(t){return{extract:function(n,e,o){for(var r=[],i=0,u=t;i<u.length;i++){var a=u[i].extract(n,e,o);if(a.stype===h.Value)return a;r.push(a)}return Xt(r)},toString:function(){return"oneOf("+L(t,(function(t){return t.toString()})).join(", ")+")"}}},on=e(Qt(gt)),rn=n(nn,tn),un=Kt.state,an=Kt.field,cn=function(t,n){return{extract:function(e,o,r){return Tt(r,t).fold((function(){return n=t,qt(e,(function(){return'Choice schema did not contain choice key: "'+n+'"'}));var n}),(function(t){return function(t,n,e,o,r){return Tt(o,r).fold((function(){return n=o,e=r,qt(t,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+Yt(n)}));var n,e}),(function(o){return o.extract(t.concat(["branch: "+r]),n,e)}))}(e,o,r,n,t)}))},toString:function(){return"chooseOn("+t+"). Possible values: "+yt(n)}}},sn=Qt(gt),ln=function(t){return rn(t)},fn=function(t){return{extract:function(n,e,o){return t().extract(n,e,o)},toString:function(){return t().toString()}}},dn=function(t){return Qt((function(n){return t(n).fold(ht,gt)}))},mn=function(t,n){return function(t,n){return{extract:function(e,r,i){var u,a,c=yt(i),s=(u=e,a=c,nn(Qt(t)).extract(u,o,a));return vt(s,(function(t){var o=L(t,(function(t){return Kt.field(t,t,Ht(),n)}));return tn(o).extract(e,r,i)}))},toString:function(){return"setOf("+n.toString()+")"}}}((function(n){return function(t){return t.fold(mt,dt)}(t(n))}),n)},gn=function(t,n,e){return function(t){return ft(t,ct.error,ct.value)}((r=t,i=o,u=e,function(t,n){return t.stype===h.Error?{stype:h.Error,serror:n(t.serror)}:t}(n.extract([r],i,u),(function(t){return{input:u,errors:t}}))));var r,i,u},pn=function(t){return t.fold((function(t){throw new Error(vn(t))}),o)},hn=function(t,n,e){return pn(gn(t,n,e))},vn=function(t){return"Errors: \n"+(e=10<(n=t.errors).length?n.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):n,L(e,(function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()})).join("\n")+"\n\nInput object: ")+Yt(t.input);var n,e},bn=cn,yn=function(t,n){return cn(t,St(n,tn))},xn=e(sn),wn=function(t,n){return Qt((function(e){var o=typeof e;return t(e)?gt(e):ht("Expected type: "+n+" but got: "+o)}))},Sn=wn(M,"number"),kn=wn(C,"string"),Cn=wn(T,"boolean"),On=wn(A,"function"),_n=function(t){var n=function(t,n){for(var e=t.next();!e.done;){if(!n(e.value))return!1;e=t.next()}return!0};if(Object(t)!==t)return!0;switch({}.toString.call(t).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(t).every((function(n){return _n(t[n])}));case"Map":return n(t.keys(),_n)&&n(t.values(),_n);case"Set":return n(t.keys(),_n);default:return!1}},Tn=Qt((function(t){return _n(t)?gt(t):ht("Expected value to be acceptable for sending via postMessage")})),En=function(t){return dn((function(n){return P(t,n)?ct.value(n):ct.error('Unsupported value: "'+n+'", choose one of "'+t.join(", ")+'".')}))},Bn=function(t){return an(t,t,Ht(),on())},An=function(t,n){return an(t,t,Ht(),n)},Mn=function(t){return An(t,kn)},Dn=function(t,n){return an(t,t,Ht(),En(n))},Fn=function(t){return An(t,On)},In=function(t,n){return an(t,t,Ht(),tn(n))},Rn=function(t,n){return an(t,t,Ht(),rn(n))},Vn=function(t,n){return an(t,t,Ht(),nn(n))},Pn=function(t){return an(t,t,zt(),on())},Hn=function(t,n){return an(t,t,zt(),n)},zn=function(t){return Hn(t,Sn)},Nn=function(t){return Hn(t,kn)},Ln=function(t){return Hn(t,On)},jn=function(t,n){return Hn(t,tn(n))},Un=function(t,n){return an(t,t,Pt(n),on())},Wn=function(t,n,e){return an(t,t,Pt(n),e)},Gn=function(t,n){return Wn(t,n,Sn)},Xn=function(t,n){return Wn(t,n,kn)},Yn=function(t,n,e){return Wn(t,n,En(e))},qn=function(t,n){return Wn(t,n,Cn)},Kn=function(t,n){return Wn(t,n,On)},Jn=function(t,n,e){return Wn(t,n,nn(e))},$n=function(t,n,e){return Wn(t,n,tn(e))},Qn=function(t,n){return un(t,n)},Zn=function(t){var n=t;return{get:function(){return n},set:function(t){n=t}}},te=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:t}},ne=function(t,n){var e=(n||document).createElement("div");if(e.innerHTML=t,!e.hasChildNodes()||1<e.childNodes.length)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return te(e.childNodes[0])},ee=function(t,n){var e=(n||document).createElement(t);return te(e)},oe=function(t,n){var e=(n||document).createTextNode(t);return te(e)},re=te,ie=function(){return ue(0,0)},ue=function(t,n){return{major:t,minor:n}},ae=function(t,n){var e=String(n).toLowerCase();return 0===t.length?ie():function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var o=t[e];if(o.test(n))return o}}(t,n);if(!e)return{major:0,minor:0};var o=function(t){return Number(n.replace(e,"$"+t))};return ue(o(1),o(2))}(t,e)},ce=ie,se=function(t,n){var e=String(n).toLowerCase();return Y(t,(function(t){return t.search(e)}))},le=function(t,n){return-1!==t.indexOf(n)},fe=function(t,n){return o=n,r=(e=t).length-n.length,""===o||e.length>=o.length&&e.substr(r,r+o.length)===o;var e,o,r},de=(st=/^\s+|\s+$/g,function(t){return t.replace(st,"")}),me=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ge=function(t){return function(n){return le(n,t)}},pe=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return le(t,"edge/")&&le(t,"chrome")&&le(t,"safari")&&le(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,me],search:function(t){return le(t,"chrome")&&!le(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return le(t,"msie")||le(t,"trident")}},{name:"Opera",versionRegexes:[me,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ge("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ge("firefox")},{name:"Safari",versionRegexes:[me,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(le(t,"safari")||le(t,"mobile/"))&&le(t,"applewebkit")}}],he=[{name:"Windows",search:ge("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return le(t,"iphone")||le(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ge("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:ge("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ge("linux"),versionRegexes:[]},{name:"Solaris",search:ge("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ge("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:ge("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ve={browsers:e(pe),oses:e(he)},be="Firefox",ye=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isEdge:o("Edge"),isChrome:o("Chrome"),isIE:o("IE"),isOpera:o("Opera"),isFirefox:o(be),isSafari:o("Safari")}},xe=function(){return ye({current:void 0,version:ce()})},we=ye,Se=(e("Edge"),e("Chrome"),e("IE"),e("Opera"),e(be),e("Safari"),"Windows"),ke="Android",Ce="Solaris",Oe="FreeBSD",_e="ChromeOS",Te=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isWindows:o(Se),isiOS:o("iOS"),isAndroid:o(ke),isOSX:o("OSX"),isLinux:o("Linux"),isSolaris:o(Ce),isFreeBSD:o(Oe),isChromeOS:o(_e)}},Ee=function(){return Te({current:void 0,version:ce()})},Be=Te,Ae=(e(Se),e("iOS"),e(ke),e("Linux"),e("OSX"),e(Ce),e(Oe),e(_e),function(t,n){var o,r,i,u,a,c,s,l,f,d,m,g,p=ve.browsers(),h=ve.oses(),v=function(t,n){return se(t,n).map((function(t){var e=ae(t.versionRegexes,n);return{current:t.name,version:e}}))}(p,t).fold(xe,we),b=function(t,n){return se(t,n).map((function(t){var e=ae(t.versionRegexes,n);return{current:t.name,version:e}}))}(h,t).fold(Ee,Be);return{browser:v,os:b,deviceType:(r=v,i=t,u=n,a=(o=b).isiOS()&&!0===/ipad/i.test(i),c=o.isiOS()&&!a,s=o.isiOS()||o.isAndroid(),l=s||u("(pointer:coarse)"),f=a||!c&&s&&u("(min-device-width:768px)"),d=c||s&&!f,m=r.isSafari()&&o.isiOS()&&!1===/safari/i.test(i),g=!d&&!f&&!m,{isiPad:e(a),isiPhone:e(c),isTablet:e(f),isPhone:e(d),isTouch:e(l),isAndroid:o.isAndroid,isiOS:o.isiOS,isWebView:e(m),isDesktop:e(g)})}}),Me=function(t){return window.matchMedia(t).matches},De=Rt((function(){return Ae(navigator.userAgent,Me)})),Fe=function(){return De()},Ie=function(t,n){var e=t.dom;if(1!==e.nodeType)return!1;var o=e;if(void 0!==o.matches)return o.matches(n);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(n);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(n);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},Re=function(t){return 1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount},Ve=function(t,n){return t.dom===n.dom},Pe=function(t,n){return Fe().browser.isIE()?function(t,n){return e=t.dom,o=n.dom,r=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(e.compareDocumentPosition(o)&r);var e,o,r}(t,n):(e=n,(o=t.dom)!==(r=e.dom)&&o.contains(r));var e,o,r},He=function(t){return A(t)?t:a},ze=function(t,n,e){for(var o=t.dom,r=He(e);o.parentNode;){o=o.parentNode;var i=re(o),u=n(i);if(u.isSome())return u;if(r(i))break}return w.none()},Ne=function(t,n,e){var o=n(t),r=He(e);return o.orThunk((function(){return r(t)?w.none():ze(t,n,r)}))},Le=function(t,n){return Ve(t.element,n.event.target)},je=function(n){if(!Bt(n,"can")&&!Bt(n,"abort")&&!Bt(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return hn("Extracting event.handler",Zt([Un("can",c),Un("abort",a),Un("run",t)]),n)},Ue=e,We=Ue("touchstart"),Ge=Ue("touchmove"),Xe=Ue("touchend"),Ye=Ue("touchcancel"),qe=Ue("mousedown"),Ke=Ue("mousemove"),Je=Ue("mouseout"),$e=Ue("mouseup"),Qe=Ue("mouseover"),Ze=Ue("focusin"),to=Ue("focusout"),no=Ue("keydown"),eo=Ue("keyup"),oo=Ue("input"),ro=Ue("change"),io=Ue("click"),uo=Ue("transitionend"),ao=Ue("selectstart"),co=function(t){return e("alloy."+t)},so={tap:co("tap")},lo=co("focus"),fo=co("blur.post"),mo=co("paste.post"),go=co("receive"),po=co("execute"),ho=co("focus.item"),vo=so.tap,bo=co("longpress"),yo=co("sandbox.close"),xo=co("typeahead.cancel"),wo=co("system.init"),So=co("system.touchmove"),ko=co("system.touchend"),Co=co("system.scroll"),Oo=co("system.resize"),_o=co("system.attached"),To=co("system.detached"),Eo=co("system.dismissRequested"),Bo=co("system.repositionRequested"),Ao=co("focusmanager.shifted"),Mo=co("slotcontainer.visibility"),Do=co("change.tab"),Fo=co("dismiss.tab"),Io=co("highlight"),Ro=co("dehighlight"),Vo=function(t,n){No(t,t.element,n,{})},Po=function(t,n,e){No(t,t.element,n,e)},Ho=function(t){Vo(t,po())},zo=function(t,n,e){No(t,n,e,{})},No=function(t,n,e,o){var r=l({target:n},o);t.getSystem().triggerEvent(e,n,r)},Lo=function(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event)},jo=Wt,Uo=function(t,n){return{key:t,value:je({abort:n})}},Wo=function(t){return{key:t,value:je({run:function(t,n){n.event.prevent()}})}},Go=function(t,n){return{key:t,value:je({run:n})}},Xo=function(t,n,e){return{key:t,value:je({run:function(t,o){n.apply(void 0,[t,o].concat(e))}})}},Yo=function(t){return function(n){return{key:t,value:je({run:function(t,e){Le(t,e)&&n(t,e)}})}}},qo=function(t,n,e){var o,r,i=n.partUids[e];return r=i,Go(o=t,(function(t,n){t.getSystem().getByUid(r).each((function(t){Lo(t,t.element,o,n)}))}))},Ko=function(t,n){return Go(t,(function(t,e){var o=e.event,r=t.getSystem().getByDom(o.target).fold((function(){return Ne(o.target,(function(n){return t.getSystem().getByDom(n).toOptional()}),a).getOr(t)}),(function(t){return t}));n(t,r,e)}))},Jo=function(t){return Go(t,(function(t,n){n.cut()}))},$o=function(t,n){return Yo(t)(n)},Qo=Yo(_o()),Zo=Yo(To()),tr=Yo(wo()),nr=(lt=po(),function(t){return Go(lt,t)}),er=("undefined"!=typeof window||Function("return this;")(),function(t){return t.dom.nodeName.toLowerCase()}),or=function(t){return function(n){return n.dom.nodeType===t}},rr=or(1),ir=or(3),ur=or(9),ar=or(11),cr=function(t){return re(t.dom.ownerDocument)},sr=function(t){return ur(t)?t:cr(t)},lr=function(t){return re(sr(t).dom.documentElement)},fr=function(t){return re(sr(t).dom.defaultView)},dr=function(t){return w.from(t.dom.parentNode).map(re)},mr=dr,gr=function(t){return w.from(t.dom.offsetParent).map(re)},pr=function(t){return L(t.dom.childNodes,re)},hr=function(t,n){var e=t.dom.childNodes;return w.from(e[n]).map(re)},vr=function(t){return ar(t)&&B(t.dom.host)},br=A(Element.prototype.attachShadow)&&A(Node.prototype.getRootNode),yr=e(br),xr=br?function(t){return re(t.dom.getRootNode())}:sr,wr=function(t){return vr(t)?t:re(sr(t).dom.body)},Sr=function(t){var n=xr(t);return vr(n)?w.some(n):w.none()},kr=function(t){return re(t.dom.host)},Cr=function(t,n){dr(t).each((function(e){e.dom.insertBefore(n.dom,t.dom)}))},Or=function(t,n){var e;(e=t,w.from(e.dom.nextSibling).map(re)).fold((function(){dr(t).each((function(t){Tr(t,n)}))}),(function(t){Cr(t,n)}))},_r=function(t,n){hr(t,0).fold((function(){Tr(t,n)}),(function(e){t.dom.insertBefore(n.dom,e.dom)}))},Tr=function(t,n){t.dom.appendChild(n.dom)},Er=function(t,n){j(n,(function(n){Tr(t,n)}))},Br=function(t){t.dom.textContent="",j(pr(t),(function(t){Ar(t)}))},Ar=function(t){var n=t.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},Mr=function(t){var n,e=pr(t);0<e.length&&(n=t,j(e,(function(t){Cr(n,t)}))),Ar(t)},Dr=function(t){return t.dom.innerHTML},Fr=function(t,n){var e,o,r=cr(t).dom,i=re(r.createDocumentFragment()),u=(e=n,(o=(r||document).createElement("div")).innerHTML=e,pr(re(o)));Er(i,u),Br(t),Tr(t,i)},Ir=function(t,n,e){if(!(C(e)||T(e)||M(e)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,e+"")},Rr=function(t,n,e){Ir(t.dom,n,e)},Vr=function(t,n){var e=t.dom.getAttribute(n);return null===e?void 0:e},Pr=function(t,n){return w.from(Vr(t,n))},Hr=function(t,n){var e=t.dom;return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},zr=function(t,n){t.dom.removeAttribute(n)},Nr=function(t){return vr(t)?"#shadow-root":(n=function(t){return re(t.dom.cloneNode(!1))}(t),e=ee("div"),o=re(n.dom.cloneNode(!0)),Tr(e,o),Dr(e));var n,e,o},Lr=jo([{key:lo(),value:je({can:function(t,n){var e,o,r=n.event,i=r.originator,u=r.target;return o=u,!(Ve(e=i,t.element)&&!Ve(e,o)&&(console.warn(lo()+" did not get interpreted by the desired target. \nOriginator: "+Nr(i)+"\nTarget: "+Nr(u)+"\nCheck the "+lo()+" event handlers"),1))}})}]),jr=Object.freeze({__proto__:null,events:Lr}),Ur=0,Wr=function(t){var n=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++Ur+String(n)},Gr=e("alloy-id-"),Xr=e("data-alloy-id"),Yr=Gr(),qr=Xr(),Kr=function(t,n){Object.defineProperty(t.dom,qr,{value:n,writable:!0})},Jr=function(t){var n=rr(t)?t.dom[qr]:null;return w.from(n)},$r=Wr,Qr=o,Zr=function(t){var n=function(n){return function(){throw new Error("The component must be in a context to send: "+n+(t?"\n"+Nr(t().element)+" is not in context.":""))}};return{debugInfo:e("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),build:n("build"),addToWorld:n("addToWorld"),removeFromWorld:n("removeFromWorld"),addToGui:n("addToGui"),removeFromGui:n("removeFromGui"),getByUid:n("getByUid"),getByDom:n("getByDom"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),isConnected:a}},ti=Zr(),ni=function(t){return L(t,(function(t){return fe(t,"/*")?t.substring(0,t.length-"/*".length):t}))},ei=function(t,n){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:ni(i)}},t},oi=Wr("alloy-premade"),ri=function(t){return Ut(oi,t)},ii=function(t){return n=function(n){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return t.apply(void 0,d([n.getApis(),n],e))},o=(e=t.toString()).indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/),n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:ni(i.slice(1))}},n;var n,e,o,r,i},ui={init:function(){return ai({readState:function(){return"No State required"}})}},ai=function(t){return t},ci=function(t,n){var e={};return wt(t,(function(t,o){wt(t,(function(t,r){var i=Tt(e,r).getOr([]);e[r]=i.concat([n(o,t)])}))})),e},si=function(t){return{classes:void 0!==t.classes?t.classes:[],attributes:void 0!==t.attributes?t.attributes:{},styles:void 0!==t.styles?t.styles:{}}},li=function(t){return t.cHandler},fi=function(t,n){return{name:t,handler:n}},di=function(t,n,e){var o,r,i=n[e];return i?function(t,n,e,o){try{var r=tt(e,(function(e,r){var i=e[n],u=r[n],a=o.indexOf(i),c=o.indexOf(u);if(-1===a)throw new Error("The ordering for "+t+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(o,null,2));if(-1===c)throw new Error("The ordering for "+t+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(o,null,2));return a<c?-1:c<a?1:0}));return ct.value(r)}catch(t){return ct.error([t])}}("Event: "+e,"name",t,i).map((function(t){return function(t){var n,e,o,r,i=(e=function(t){return t.can},function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return X(n,(function(n,o){return n&&e(o).apply(void 0,t)}),!0)}),u=(o=n=t,r=function(t){return t.abort},function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return X(o,(function(n,e){return n||r(e).apply(void 0,t)}),!1)});return je({can:i,abort:u,run:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];j(t,(function(t){t.run.apply(void 0,n)}))}})}(L(t,(function(t){return t.handler})))})):(o=e,r=t,ct.error(["The event ("+o+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(L(r,(function(t){return t.name})),null,2)]))},mi=function(t,n){return function(t,n){var e,o,r,i,u,a=(e=[],o=[],j(t,(function(t){t.fold((function(t){e.push(t)}),(function(t){o.push(t)}))})),{errors:e,values:o});return 0<a.errors.length?(u=a.errors,ct.error(K(u))):(i=n,0===(r=a.values).length?ct.value(i):ct.value(Ft(i,It.apply(void 0,r))))}(Ct(t,(function(t,e){return(1===t.length?ct.value(t[0].handler):di(t,n,e)).map((function(o){var r=function(t){var n,e=A(n=t)?{can:c,abort:a,run:n}:n;return function(t,n){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var i=[t,n].concat(o);e.abort.apply(void 0,i)?n.stop():e.can.apply(void 0,i)&&e.run.apply(void 0,i)}}(o),i=1<t.length?W(n[e],(function(n){return H(t,(function(t){return t.name===n}))})).join(" > "):t[0].name;return Ut(e,{handler:r,purpose:i})}))})),{})},gi="alloy.base.behaviour",pi=function(t,n){var e=Vr(t,n);return void 0===e||""===e?[]:e.split(" ")},hi=function(t){return void 0!==t.dom.classList},vi=function(t,n){hi(t)?t.dom.classList.add(n):function(t,n){return o=n,r=pi(e=t,"class").concat([o]),Rr(e,"class",r.join(" ")),!0;var e,o,r}(t,n)},bi=function(t,n){hi(t)?t.dom.classList.remove(n):function(t,n){return r=n,0<(i=W(pi(e=t,o="class"),(function(t){return t!==r}))).length?Rr(e,o,i.join(" ")):zr(e,o),!1;var e,o,r,i}(t,n),function(t){0===(hi(t)?t.dom.classList:pi(t,"class")).length&&zr(t,"class")}(t)},yi=function(t,n){return hi(t)&&t.dom.classList.contains(n)},xi=function(t,n){j(n,(function(n){vi(t,n)}))},wi=function(t,n){j(n,(function(n){bi(t,n)}))},Si=function(t){return void 0!==t.style&&A(t.style.getPropertyValue)},ki=function(t){var n=ir(t)?t.dom.parentNode:t.dom;if(null==n||null===n.ownerDocument)return!1;var e,o,r=n.ownerDocument;return Sr(re(n)).fold((function(){return r.body.contains(n)}),(e=ki,o=kr,function(t){return e(o(t))}))},Ci=function(){return Oi(re(document))},Oi=function(t){var n=t.dom.body;if(null==n)throw new Error("Body is not available yet");return re(n)},_i=function(t,n,e){if(!C(e))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e);Si(t)&&t.style.setProperty(n,e)},Ti=function(t,n){Si(t)&&t.style.removeProperty(n)},Ei=function(t,n,e){var o=t.dom;_i(o,n,e)},Bi=function(t,n){var e=t.dom;wt(n,(function(t,n){_i(e,n,t)}))},Ai=function(t,n){var e=t.dom;wt(n,(function(t,n){t.fold((function(){Ti(e,n)}),(function(t){_i(e,n,t)}))}))},Mi=function(t,n){var e=t.dom,o=window.getComputedStyle(e).getPropertyValue(n);return""!==o||ki(t)?o:Di(e,n)},Di=function(t,n){return Si(t)?t.style.getPropertyValue(n):""},Fi=function(t,n){var e=t.dom,o=Di(e,n);return w.from(o).filter((function(t){return 0<t.length}))},Ii=function(t,n,e){var o=ee(t);return Ei(o,n,e),Fi(o,n).isSome()},Ri=function(t,n){var e=t.dom;Ti(e,n),Pr(t,"style").map(de).is("")&&zr(t,"style")},Vi=function(t){return t.dom.offsetWidth},Pi=function(t){return t.dom.value},Hi=function(t,n){if(void 0===n)throw new Error("Value.set was undefined");t.dom.value=n},zi=function(t){var n,e;return function(t,n){return e=t,r=L(o=n,(function(t){return jn(t.name(),[Bn("config"),Un("state",ui)])})),i=gn("component.behaviours",tn(r),e.behaviours).fold((function(t){throw new Error(vn(t)+"\nComplete spec:\n"+JSON.stringify(e,null,2))}),(function(t){return t})),{list:o,data:St(i,(function(t){var n=t.map((function(t){return{config:t.config,state:t.state.init(t.config)}}));return function(){return n}}))};var e,o,r,i}(t,(n=Tt(t,"behaviours").getOr({}),e=W(yt(n),(function(t){return void 0!==n[t]})),L(e,(function(t){return n[t].me}))))},Ni=function(t,n,e){var o,r,i,u={"alloy.base.behaviour":t.events};return o=e,r=t.eventOrder,i=function(t,n,e){var o,r,i=l(l({},e),(o=t,r={},j(n,(function(t){r[t.name()]=t.handlers(o)})),r));return ci(i,fi)}(o,n,u),mi(i,r).getOrDie()},Li=function(t){var n,o,r,i,u,a,c,s,d,m,g,p,h,v=Qr(t),b=v.events,y=f(v,["events"]),x=(n=Tt(y,"components").getOr([]),L(n,Gi)),w=l(l({},y),{events:l(l({},jr),b),components:x});return ct.value((r=function(){return h},i=Zn(ti),u=pn(function(t){var n,o;return gn("custom.definition",tn([an("dom","dom",Ht(),tn([Bn("tag"),Un("styles",{}),Un("classes",[]),Un("attributes",{}),Pn("value"),Pn("innerHtml")])),Bn("components"),Bn("uid"),Un("events",{}),Un("apis",{}),an("eventOrder","eventOrder",((n={})[po()]=["disabling",gi,"toggling","typeaheadevents"],n[lo()]=[gi,"focusing","keying"],n[wo()]=[gi,"disabling","toggling","representing"],n[oo()]=[gi,"representing","streaming","invalidating"],n[To()]=[gi,"representing","item-events","tooltipping"],n[qe()]=["focusing",gi,"item-type-events"],n[We()]=["focusing",gi,"item-type-events"],n[Qe()]=["item-type-events","tooltipping"],n[go()]=["receiving","reflecting","tooltipping"],o=n,Vt.mergeWithThunk(e(o))),xn()),Pn("domModification")]),t)}(o=w)),c=(a=zi(o)).list,s=a.data,d=function(t,n,e){var o,r,i,u=l(l({},(o=t).dom),{uid:o.uid,domChildren:L(o.components,(function(t){return t.element}))}),a=t.domModification.fold((function(){return si({})}),si),c={"alloy.base.modification":a};return i=0<n.length?function(t,n,e,o){var r=l({},n);j(e,(function(n){r[n.name()]=n.exhibit(t,o)}));var i=ci(r,(function(t,n){return{name:t,modification:n}})),u=function(t){return G(t,(function(t,n){return l(l({},n.modification),t)}),{})},a=G(i.classes,(function(t,n){return n.modification.concat(t)}),[]),c=u(i.attributes),s=u(i.styles);return si({classes:a,attributes:c,styles:s})}(e,c,n,u):a,l(l({},r=u),{attributes:l(l({},r.attributes),i.attributes),styles:l(l({},r.styles),i.styles),classes:r.classes.concat(i.classes)})}(u,c,s),m=function(t){var n,e,o,r=ee(t.tag);n=r,e=t.attributes,o=n.dom,wt(e,(function(t,n){Ir(o,n,t)})),xi(r,t.classes),Bi(r,t.styles),t.innerHtml.each((function(t){return Fr(r,t)}));var i=t.domChildren;return Er(r,i),t.value.each((function(t){Hi(r,t)})),t.uid,Kr(r,t.uid),r}(d),g=Ni(u,c,s),p=Zn(u.components),h={getSystem:i.get,config:function(t){var n=s;return(A(n[t.name()])?n[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(o,null,2))})()},hasConfigured:function(t){return A(s[t.name()])},spec:o,readState:function(t){return s[t]().map((function(t){return t.state.readState()})).getOr("not enabled")},getApis:function(){return u.apis},connect:function(t){i.set(t)},disconnect:function(){i.set(Zr(r))},element:m,syncComponents:function(){var t=pr(m),n=J(t,(function(t){return i.get().getByDom(t).fold((function(){return[]}),(function(t){return[t]}))}));p.set(n)},components:p.get,events:g}))},ji=function(t){var n=oe(t);return Ui({element:n})},Ui=function(n){var o=hn("external.component",Zt([Bn("element"),Pn("uid")]),n),r=Zn(Zr());o.uid.each((function(t){Kr(o.element,t)}));var i={getSystem:r.get,config:w.none,hasConfigured:a,connect:function(t){r.set(t)},disconnect:function(){r.set(Zr((function(){return i})))},getApis:function(){return{}},element:o.element,spec:n,readState:e("No state"),syncComponents:t,components:e([]),events:{}};return ri(i)},Wi=$r,Gi=function(t){return Tt(t,oi).fold((function(){var n=t.hasOwnProperty("uid")?t:l({uid:Wi("")},t);return Li(n).getOrDie()}),(function(t){return t}))},Xi=ri,Yi=function(t,n){var e=function(e){var o=n(e);if(o<=0||null===o){var r=Mi(e,t);return parseFloat(r)||0}return o},o=function(t,n){return X(n,(function(n,e){var o=Mi(t,e),r=void 0===o?0:parseInt(o,10);return isNaN(r)?n:n+r}),0)};return{set:function(n,e){if(!M(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);var o=n.dom;Si(o)&&(o.style[t]=e+"px")},get:e,getOuter:e,aggregate:o,max:function(t,n,e){var r=o(t,e);return r<n?n-r:0}}},qi=Yi("height",(function(t){var n=t.dom;return ki(t)?n.getBoundingClientRect().height:n.offsetHeight})),Ki=function(t){return qi.get(t)},Ji=function(t){return qi.getOuter(t)},$i=function(t,n){return{left:t,top:n,translate:function(e,o){return $i(t+e,n+o)}}},Qi=$i,Zi=function(t,n){return void 0!==t?t:void 0!==n?n:0},tu=function(t){var n=t.dom.ownerDocument,e=n.body,o=n.defaultView,r=n.documentElement;if(e===t.dom)return Qi(e.offsetLeft,e.offsetTop);var i=Zi(null==o?void 0:o.pageYOffset,r.scrollTop),u=Zi(null==o?void 0:o.pageXOffset,r.scrollLeft),a=Zi(r.clientTop,e.clientTop),c=Zi(r.clientLeft,e.clientLeft);return nu(t).translate(u-c,i-a)},nu=function(t){var n,e=t.dom,o=e.ownerDocument.body;return o===e?Qi(o.offsetLeft,o.offsetTop):ki(t)?(n=e.getBoundingClientRect(),Qi(n.left,n.top)):Qi(0,0)},eu=Yi("width",(function(t){return t.dom.offsetWidth})),ou=function(t){return eu.get(t)},ru=function(t){return eu.getOuter(t)},iu=function(t){var e=re(function(t){if(yr()&&B(t.target)){var n=re(t.target);if(rr(n)&&function(t){return B(t.dom.shadowRoot)}(n)&&t.composed&&t.composedPath){var e=t.composedPath();if(e)return et(e)}}return w.from(t.target)}(t).getOr(t.target)),o=function(){return t.stopPropagation()},r=function(){return t.preventDefault()},i=n(r,o);return{target:e,x:t.clientX,y:t.clientY,stop:o,prevent:r,kill:i,raw:t}},uu=function(t,n,e,o,i){var u,a,c=(u=e,a=o,function(t){u(t)&&a(iu(t))});return t.dom.addEventListener(n,c,i),{unbind:r(au,t,n,c,i)}},au=function(t,n,e,o){t.dom.removeEventListener(n,e,o)},cu=function(t){var n=void 0!==t?t.dom:document,e=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop;return Qi(e,o)},su=function(t,n,e){var o=(void 0!==e?e.dom:document).defaultView;o&&o.scrollTo(t,n)},lu=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},fu=function(t){var n,e,o=void 0===t?window:t,r=o.document,i=cu(re(r));return e=void 0===(n=o)?window:n,w.from(e.visualViewport).fold((function(){var t=o.document.documentElement,n=t.clientWidth,e=t.clientHeight;return lu(i.left,i.top,n,e)}),(function(t){return lu(Math.max(t.pageLeft,i.left),Math.max(t.pageTop,i.top),t.width,t.height)}))},du=function(t,n){return t.view(n).fold(e([]),(function(n){var e=t.owner(n),o=du(t,e);return[n].concat(o)}))},mu=Object.freeze({__proto__:null,view:function(t){var n;return(t.dom===document?w.none():w.from(null===(n=t.dom.defaultView)||void 0===n?void 0:n.frameElement)).map(re)},owner:cr}),gu=function(t){var n,e,o,i,u=re(document),a=cu(u);return(n=t,o=(e=mu).owner(n),i=du(e,o),w.some(i)).fold(r(tu,t),(function(n){var e=nu(t),o=G(n,(function(t,n){var e=nu(n);return{left:t.left+e.left,top:t.top+e.top}}),{left:0,top:0});return Qi(o.left+e.left+a.left,o.top+e.top+a.top)}))},pu=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},hu=function(t){var n=tu(t),e=ru(t),o=Ji(t);return pu(n.left,n.top,e,o)},vu=function(t){var n=gu(t),e=ru(t),o=Ji(t);return pu(n.left,n.top,e,o)},bu=function(){return fu(window)};function yu(t,n,e,o,r){return t(e,o)?w.some(e):A(r)&&r(e)?w.none():n(e,o,r)}var xu,wu,Su=function(t,n,e){for(var o=t.dom,r=A(e)?e:a;o.parentNode;){o=o.parentNode;var i=re(o);if(n(i))return w.some(i);if(r(i))break}return w.none()},ku=function(t,n,e){return yu((function(t,n){return n(t)}),Su,t,n,e)},Cu=function(t,n,e){return ku(t,n,e).isSome()},Ou=function(t,n,e){return Su(t,(function(t){return Ie(t,n)}),e)},_u=function(t,n){return e=n,r=void 0===(o=t)?document:o.dom,Re(r)?w.none():w.from(r.querySelector(e)).map(re);var e,o,r},Tu=function(t,n,e){return yu(Ie,Ou,t,n,e)},Eu=function(){var t=Wr("aria-owns");return{id:t,link:function(n){Rr(n,"aria-owns",t)},unlink:function(t){zr(t,"aria-owns")}}},Bu=function(t,n){return Cu(n,(function(n){return Ve(n,t.element)}),a)||function(t,n){return ku(n,(function(t){if(!rr(t))return!1;var n=Vr(t,"id");return void 0!==n&&-1<n.indexOf("aria-owns")})).bind((function(t){var n=Vr(t,"id"),e=xr(t);return _u(e,'[aria-owns="'+n+'"]')})).exists((function(n){return Bu(t,n)}))}(t,n)};(wu=xu=xu||{})[wu.STOP=0]="STOP",wu[wu.NORMAL=1]="NORMAL",wu[wu.LOGGING=2]="LOGGING";var Au,Mu,Du=Zn({}),Fu=["alloy/data/Fields","alloy/debugging/Debugging"],Iu=function(t,n,e){var o,r,i,u;switch(Tt(Du.get(),t).orThunk((function(){var n=yt(Du.get());return it(n,(function(n){return-1<t.indexOf(n)?w.some(Du.get()[n]):w.none()}))})).getOr(xu.NORMAL)){case xu.NORMAL:return e(Ru());case xu.LOGGING:var a=(o=t,r=n,i=[],u=(new Date).getTime(),{logEventCut:function(t,n,e){i.push({outcome:"cut",target:n,purpose:e})},logEventStopped:function(t,n,e){i.push({outcome:"stopped",target:n,purpose:e})},logNoParent:function(t,n,e){i.push({outcome:"no-parent",target:n,purpose:e})},logEventNoHandlers:function(t,n){i.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,e){i.push({outcome:"response",purpose:e,target:n})},write:function(){var t=(new Date).getTime();P(["mousemove","mouseover","mouseout",wo()],o)||console.log(o,{event:o,time:t-u,target:r.dom,sequence:L(i,(function(t){return P(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+Nr(t.target)+")":t.outcome}))})}}),c=e(a);return a.write(),c;case xu.STOP:return!0}},Ru=e({logEventCut:t,logEventStopped:t,logNoParent:t,logEventNoHandlers:t,logEventResponse:t,write:t}),Vu=e([Bn("menu"),Bn("selectedMenu")]),Pu=e([Bn("item"),Bn("selectedItem")]),Hu=(e(tn(Pu().concat(Vu()))),e(tn(Pu()))),zu=In("initSize",[Bn("numColumns"),Bn("numRows")]),Nu=function(){return In("markers",[Bn("backgroundMenu")].concat(Vu()).concat(Pu()))},Lu=function(t){return In("markers",L(t,Bn))},ju=function(t,n,e){return function(){var t=new Error;if(void 0!==t.stack){var n=t.stack.split("\n");Y(n,(function(t){return 0<t.indexOf("alloy")&&!H(Fu,(function(n){return-1<t.indexOf(n)}))})).getOr("unknown")}}(),an(n,n,e,dn((function(t){return ct.value((function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(void 0,n)}))})))},Uu=function(n){return ju(0,n,Pt(t))},Wu=function(t){return ju(0,t,Pt(w.none))},Gu=function(t){return ju(0,t,Ht())},Xu=function(t){return ju(0,t,Ht())},Yu=function(t,n){return Qn(t,e(n))},qu=function(t){return Qn(t,o)},Ku=e(zu),Ju=function(t,n,e,o,r,i){return{x:t,y:n,bubble:e,direction:o,boundsRestriction:r,label:i}},$u=At([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Qu=$u.southeast,Zu=$u.southwest,ta=$u.northeast,na=$u.northwest,ea=$u.south,oa=$u.north,ra=$u.east,ia=$u.west,ua=function(t,n){return function(t,n){for(var e={},o=0,r=t.length;o<r;o++){var i=t[o];e[String(i)]=n(i)}return e}(["left","right","top","bottom"],(function(e){return Tt(n,e).map((function(n){return function(t,n){switch(n){case 1:return t.x;case 0:return t.x+t.width;case 2:return t.y;case 3:return t.y+t.height}}(t,n)}))}))},aa=function(t){return t.x},ca=function(t,n){return t.x+t.width/2-n.width/2},sa=function(t,n){return t.x+t.width-n.width},la=function(t,n){return t.y-n.height},fa=function(t){return t.y+t.height},da=function(t,n){return t.y+t.height/2-n.height/2},ma=function(t,n,e){return Ju(aa(t),fa(t),e.southeast(),Qu(),ua(t,{left:1,top:3}),"layout-se")},ga=function(t,n,e){return Ju(sa(t,n),fa(t),e.southwest(),Zu(),ua(t,{right:0,top:3}),"layout-sw")},pa=function(t,n,e){return Ju(aa(t),la(t,n),e.northeast(),ta(),ua(t,{left:1,bottom:2}),"layout-ne")},ha=function(t,n,e){return Ju(sa(t,n),la(t,n),e.northwest(),na(),ua(t,{right:0,bottom:2}),"layout-nw")},va=function(t,n,e){return Ju(ca(t,n),la(t,n),e.north(),oa(),ua(t,{bottom:2}),"layout-n")},ba=function(t,n,e){return Ju(ca(t,n),fa(t),e.south(),ea(),ua(t,{top:3}),"layout-s")},ya=function(t,n,e){return Ju((o=t).x+o.width,da(t,n),e.east(),ra(),ua(t,{left:0}),"layout-e");var o},xa=function(t,n,e){return Ju((o=n,t.x-o.width),da(t,n),e.west(),ia(),ua(t,{right:1}),"layout-w");var o},wa=function(){return[ma,ga,pa,ha,ba,va,ya,xa]},Sa=function(){return[ga,ma,ha,pa,ba,va,ya,xa]},ka=function(){return[pa,ha,ma,ga,va,ba]},Ca=function(){return[ha,pa,ga,ma,va,ba]},Oa=function(){return[ma,ga,pa,ha,ba,va]},_a=function(){return[ga,ma,ha,pa,ba,va]},Ta=Object.freeze({__proto__:null,events:function(t){return jo([Go(go(),(function(n,e){var o,r,i=t.channels,u=yt(i),a=e,c=(o=u,(r=a).universal?o:W(o,(function(t){return P(r.channels,t)})));j(c,(function(t){var e=i[t],o=e.schema,r=hn("channel["+t+"] data\nReceiver: "+Nr(n.element),o,a.data);e.onReceive(n,r)}))}))])}}),Ea=[An("channels",mn(ct.value,Zt([Gu("onReceive"),Un("schema",xn())])))],Ba=function(t,n,e){return tr((function(o,r){e(o,t,n)}))},Aa=function(t){return{key:t,value:void 0}},Ma=function(t,n,o,i,u,a,c){var s=function(t){return Bt(t,o)?t[o]():w.none()},f=St(u,(function(t,n){return function(t,n,o){var r,i,u,a,c,s;return r=function(r){for(var i=[],u=1;u<arguments.length;u++)i[u-1]=arguments[u];var a=[r].concat(i);return r.config({name:e(t)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+t+". Using API: "+o)}),(function(t){var e=Array.prototype.slice.call(a,1);return n.apply(void 0,[r,t.config,t.state].concat(e))}))},i=o,a=(u=n.toString()).indexOf(")")+1,c=u.indexOf("("),s=u.substring(c+1,a-1).split(/,\s*/),r.toFunctionAnnotation=function(){return{name:i,parameters:ni(s.slice(0,1).concat(s.slice(3)))}},r}(o,t,n)})),d=St(a,ei),m=l(l(l({},d),f),{revoke:r(Aa,o),config:function(n){var e=hn(o+"-config",t,n);return{key:o,value:{config:e,me:m,configAsRaw:Rt((function(){return hn(o+"-config",t,n)})),initialConfig:n,state:c}}},schema:e(n),exhibit:function(t,n){return s(t).bind((function(t){return Tt(i,"exhibit").map((function(e){return e(n,t.config,t.state)}))})).getOr(si({}))},name:e(o),handlers:function(t){return s(t).map((function(t){return Tt(i,"events").getOr((function(){return{}}))(t.config,t.state)})).getOr({})}});return m},Da=Wt,Fa=Zt([Bn("fields"),Bn("name"),Un("active",{}),Un("apis",{}),Un("state",ui),Un("extra",{})]),Ia=function(t){var n=hn("Creating behaviour: "+t.name,Fa,t);return function(t,n,e,o,r,i){var u=Zt(t),a=jn(n,[Hn("config",Zt(t))]);return Ma(u,a,n,e,o,r,i)}(n.fields,n.name,n.active,n.apis,n.extra,n.state)},Ra=Zt([Bn("branchKey"),Bn("branches"),Bn("name"),Un("active",{}),Un("apis",{}),Un("state",ui),Un("extra",{})]),Va=function(t){var n,e,o,r,i,u,a,c,s=hn("Creating behaviour: "+t.name,Ra,t);return n=yn(s.branchKey,s.branches),e=s.name,o=s.active,r=s.apis,i=s.extra,u=s.state,c=jn(e,[Hn("config",a=n)]),Ma(a,c,e,o,r,i,u)},Pa=e(void 0),Ha=Ia({fields:Ea,name:"receiving",active:Ta}),za=Object.freeze({__proto__:null,exhibit:function(t,n){return si({classes:[],styles:n.useFixed()?{}:{position:"relative"}})}}),Na=function(t){return t.dom.focus()},La=function(t){return void 0===t&&(t=re(document)),w.from(t.dom.activeElement).map(re)},ja=function(t){return La(xr(t)).filter((function(n){return t.dom.contains(n.dom)}))},Ua=function(n,e){var o=xr(e),r=La(o).bind((function(t){var n,o,r=function(n){return Ve(t,n)};return r(e)?w.some(e):(n=r,(o=function(t){for(var e=0;e<t.childNodes.length;e++){var r=re(t.childNodes[e]);if(n(r))return w.some(r);var i=o(t.childNodes[e]);if(i.isSome())return i}return w.none()})(e.dom))})),i=n(e);return r.each((function(n){La(o).filter((function(t){return Ve(t,n)})).fold((function(){Na(n)}),t)})),i},Wa=function(t,n,e,o,r){return{position:t,left:n,top:e,right:o,bottom:r}},Ga=function(t,n){var e=function(t){return t+"px"};Ai(t,{position:w.some(n.position),left:n.left.map(e),top:n.top.map(e),right:n.right.map(e),bottom:n.bottom.map(e)})},Xa=At([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),Ya=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g=n.x-e,p=n.y-o,h=r-(g+n.width),v=i-(p+n.height),b=w.some(g),y=w.some(p),x=w.some(h),S=w.some(v),k=w.none();return u=function(){return Wa(t,b,y,k,k)},a=function(){return Wa(t,k,y,x,k)},c=function(){return Wa(t,b,k,k,S)},s=function(){return Wa(t,k,k,x,S)},l=function(){return Wa(t,b,y,k,k)},f=function(){return Wa(t,b,k,k,S)},d=function(){return Wa(t,b,y,k,k)},m=function(){return Wa(t,k,y,x,k)},n.direction.fold(u,a,c,s,l,f,d,m)},qa=function(t,n){var e=r(gu,n),o=t.fold(e,e,(function(){var t=cu();return gu(n).translate(-t.left,-t.top)})),i=ru(n),u=Ji(n);return pu(o.left,o.top,i,u)},Ka=function(t,n,o){var r=Qi(n,o);return t.fold(e(r),e(r),(function(){var t=cu();return r.translate(-t.left,-t.top)}))},Ja=(Xa.none,Xa.relative),$a=Xa.fixed,Qa=function(t,n,e,o){var r=t+n;return o<r?e:r<e?o:r},Za=function(t,n,e){return Math.min(Math.max(t,n),e)},tc=At([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),nc=function(t,n,i,u){Ri(n,"max-height"),Ri(n,"max-width");var a,c,s,l,f,d,m,g,p,h={width:ru(a=n),height:Ji(a)};return c=u.preference,s=t,l=h,f=i,d=u.bounds,m=l.width,g=l.height,p=function(t,n,r,i){return function(t,n,r,i){var u,a,c,s,l,f,d,m,g,p,h,v,b,y,x,S,k,C,O,_,T,E,B,A,M,D,F,I,R,V,P,H,z=t.x,N=t.y,L=t.bubble.offset,j=L.left,U=L.top,W=(u=i,a=t.boundsRestriction,c=L,l=(s=function(t,n){var e="top"===t||"bottom"===t?c.top:c.left;return Tt(a,t).bind(o).bind((function(e){return"left"===t||"top"===t?n<=e?w.some(e):w.none():e<=n?w.some(e):w.none()})).map((function(t){return t+e})).getOr(n)})("left",u.x),f=s("top",u.y),d=s("right",u.right),m=s("bottom",u.bottom),pu(l,f,d-l,m-f)),G=W.y,X=W.bottom,Y=W.x,q=W.right,K=N+U,J=(g=z+j,p=K,h=n,v=r,y=(b=W).x,x=b.y,S=b.width,k=b.height,O=x<=p,_=(C=y<=g)&&O,T=g+h<=y+S&&p+v<=x+k,E=Math.abs(Math.min(h,C?y+S-g:y-(g+h))),B=Math.abs(Math.min(v,O?x+k-p:x-(p+v))),A=Math.max(b.x,b.right-h),M=Math.max(b.y,b.bottom-v),{originInBounds:_,sizeInBounds:T,limitX:Za(g,b.x,A),limitY:Za(p,b.y,M),deltaW:E,deltaH:B}),$=J.originInBounds,Q=J.sizeInBounds,Z=J.limitX,tt=J.limitY,nt=J.deltaW,et=J.deltaH,ot=e(tt+et-G),rt=(F=D=e(X-tt),I=ot,t.direction.fold(D,D,I,I,D,I,F,F)),it=e(Z+nt-Y),ut=e(q-Z),at={x:Z,y:tt,width:nt,height:et,maxHeight:rt,maxWidth:(R=t.direction,P=V=ut,H=it,R.fold(V,H,V,H,P,P,V,H)),direction:t.direction,classes:{on:t.bubble.classesOn,off:t.bubble.classesOff},label:t.label,candidateYforTest:K};return $&&Q?tc.fit(at):tc.nofit(at,nt,et)}(t(s,l,f),m,g,d).fold(tc.fit,(function(t,e,o){return i<o||r<e?tc.nofit(t,e,o):tc.nofit(n,r,i)}))},X(c,(function(t,n){var e=r(p,n);return t.fold(tc.fit,e)}),tc.nofit({x:s.x,y:s.y,width:l.width,height:l.height,maxHeight:l.height,maxWidth:l.width,direction:Qu(),classes:{on:[],off:[]},label:"none",candidateYforTest:s.y},-1,-1)).fold(o,o)},ec=function(t,n){var e,o,r;e=t,o=Math.floor(n),r=qi.max(e,o,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]),Ei(e,"max-height",r+"px")},oc=e((function(t,n){ec(t,n),Bi(t,{"overflow-x":"hidden","overflow-y":"auto"})})),rc=e((function(t,n){ec(t,n)})),ic=function(t,n,e){return void 0===t[n]?e:t[n]},uc=function(t,n,e,o){var r,i,u,a,c,s,l=nc(t,n,e,o);(function(t,n,e){var o,r;Ga(t,(o=e.origin,r=n,o.fold((function(){return Wa("absolute",w.some(r.x),w.some(r.y),w.none(),w.none())}),(function(t,n,e,o){return Ya("absolute",r,t,n,e,o)}),(function(t,n,e,o){return Ya("fixed",r,t,n,e,o)}))))})(n,l,o),r=n,i=l.classes,wi(r,i.off),xi(r,i.on),u=n,a=l,(0,o.maxHeightFunction)(u,a.maxHeight),c=n,s=l,(0,o.maxWidthFunction)(c,s.maxWidth)},ac=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],cc=function(t,n,e){var o=function(t){return Tt(e,t).getOr([])},r=function(t,n,e){var r=Z(ac,e);return{offset:Qi(t,n),classesOn:J(e,o),classesOff:J(r,o)}};return{southeast:function(){return r(-t,n,["top","alignLeft"])},southwest:function(){return r(t,n,["top","alignRight"])},south:function(){return r(-t/2,n,["top","alignCentre"])},northeast:function(){return r(-t,-n,["bottom","alignLeft"])},northwest:function(){return r(t,-n,["bottom","alignRight"])},north:function(){return r(-t/2,-n,["bottom","alignCentre"])},east:function(){return r(t,-n/2,["valignCentre","left"])},west:function(){return r(-t,-n/2,["valignCentre","right"])},innerNorthwest:function(){return r(-t,n,["top","alignRight"])},innerNortheast:function(){return r(t,n,["top","alignLeft"])},innerNorth:function(){return r(-t/2,n,["top","alignCentre"])},innerSouthwest:function(){return r(-t,-n,["bottom","alignRight"])},innerSoutheast:function(){return r(t,-n,["bottom","alignLeft"])},innerSouth:function(){return r(-t/2,-n,["bottom","alignCentre"])},innerWest:function(){return r(t,-n/2,["valignCentre","right"])},innerEast:function(){return r(-t,-n/2,["valignCentre","left"])}}},sc=function(){return cc(0,0,{})},lc=function(t,n){return function(e){return"rtl"===fc(e)?n:t}},fc=function(t){return"rtl"===Mi(t,"direction")?"rtl":"ltr"};(Mu=Au=Au||{}).TopToBottom="toptobottom",Mu.BottomToTop="bottomtotop";var dc,mc,gc,pc,hc="data-alloy-vertical-dir",vc=function(t){return Cu(t,(function(t){return rr(t)&&Vr(t,"data-alloy-vertical-dir")===Au.BottomToTop}))},bc=function(){return jn("layouts",[Bn("onLtr"),Bn("onRtl"),Pn("onBottomLtr"),Pn("onBottomRtl")])},yc=function(t,n,e,o,r,i,u){var a=u.map(vc).getOr(!1),c=n.layouts.map((function(n){return n.onLtr(t)})),s=n.layouts.map((function(n){return n.onRtl(t)})),l=a?n.layouts.bind((function(n){return n.onBottomLtr.map((function(n){return n(t)}))})).or(c).getOr(r):c.getOr(e),f=a?n.layouts.bind((function(n){return n.onBottomRtl.map((function(n){return n(t)}))})).or(s).getOr(i):s.getOr(o);return lc(l,f)(t)},xc=[Bn("hotspot"),Pn("bubble"),Un("overrides",{}),bc(),Yu("placement",(function(t,n,e){var o=n.hotspot,r=qa(e,o.element),i=yc(t.element,n,Oa(),_a(),ka(),Ca(),w.some(n.hotspot.element));return w.some({anchorBox:r,bubble:n.bubble.getOr(sc()),overrides:n.overrides,layouts:i,placer:w.none()})}))],wc=[Bn("x"),Bn("y"),Un("height",0),Un("width",0),Un("bubble",sc()),Un("overrides",{}),bc(),Yu("placement",(function(t,n,e){var o=Ka(e,n.x,n.y),r=pu(o.left,o.top,n.width,n.height),i=yc(t.element,n,wa(),Sa(),wa(),Sa(),w.none());return w.some({anchorBox:r,bubble:n.bubble,overrides:n.overrides,layouts:i,placer:w.none()})}))],Sc=At([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),kc=function(t){return t.fold(o,(function(t,n,e){return t.translate(-n,-e)}))},Cc=function(t){return t.fold(o,o)},Oc=function(t){return X(t,(function(t,n){return t.translate(n.left,n.top)}),Qi(0,0))},_c=function(t){var n=L(t,Cc);return Oc(n)},Tc=Sc.screen,Ec=Sc.absolute,Bc=function(t,n,e){var o,r,i=cr(t.element),u=cu(i),a=(o=t,r=fr(e.root).dom,w.from(r.frameElement).map(re).filter((function(t){var n=cr(t),e=cr(o.element);return Ve(n,e)})).map(tu).getOr(u));return Ec(a,u.left,u.top)},Ac=function(t,n,e,o){var r=t,i=n,u=e,a=o;t<0&&(r=0,u=e+t),n<0&&(i=0,a=o+n);var c=Tc(Qi(r,i));return w.some({point:c,width:u,height:a})},Mc=function(t,n,e,o,r){return t.map((function(t){var i,u,a,c=[n,t.point],s=(i=function(){return _c(c)},u=function(){return _c(c)},a=function(){return t=L(c,kc),Oc(t);var t},o.fold(i,u,a)),l={x:s.left,y:s.top,width:t.width,height:t.height},f=(e.showAbove?ka:Oa)(),d=(e.showAbove?Ca:_a)(),m=yc(r,e,f,d,f,d,w.none());return{anchorBox:l,bubble:e.bubble.getOr(sc()),overrides:e.overrides,layouts:m,placer:w.none()}}))},Dc=[Bn("node"),Bn("root"),Pn("bubble"),bc(),Un("overrides",{}),Un("showAbove",!1),Yu("placement",(function(t,n,e){var o=Bc(t,0,n);return n.node.filter(ki).bind((function(r){var i=r.dom.getBoundingClientRect(),u=Ac(i.left,i.top,i.width,i.height),a=n.node.getOr(t.element);return Mc(u,o,n,e,a)}))}))],Fc=function(t,n,e,o){return{start:t,soffset:n,finish:e,foffset:o}},Ic=At([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Rc=(Ic.before,Ic.on,Ic.after,function(t){return t.fold(o,o,o)}),Vc=At([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Pc={domRange:Vc.domRange,relative:Vc.relative,exact:Vc.exact,exactFromRange:function(t){return Vc.exact(t.start,t.soffset,t.finish,t.foffset)},getWin:function(t){var n=t.match({domRange:function(t){return re(t.startContainer)},relative:function(t,n){return Rc(t)},exact:function(t,n,e,o){return t}});return fr(n)},range:Fc},Hc=function(t,n,e){var o,r,i=t.document.createRange();return o=i,n.fold((function(t){o.setStartBefore(t.dom)}),(function(t,n){o.setStart(t.dom,n)}),(function(t){o.setStartAfter(t.dom)})),r=i,e.fold((function(t){r.setEndBefore(t.dom)}),(function(t,n){r.setEnd(t.dom,n)}),(function(t){r.setEndAfter(t.dom)})),i},zc=function(t,n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},Nc=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}},Lc=At([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),jc=function(t,n,e){return n(re(e.startContainer),e.startOffset,re(e.endContainer),e.endOffset)},Uc=(Lc.ltr,Lc.rtl,dc=ir,"text",{get:function(t){if(!dc(t))throw new Error("Can only get text value of a text node");return mc(t).getOr("")},getOption:mc=function(t){return dc(t)?w.from(t.dom.nodeValue):w.none()},set:function(t,n){if(!dc(t))throw new Error("Can only set raw text value of a text node");t.dom.nodeValue=n}}),Wc=function(t){return Uc.getOption(t)},Gc=["img","br"],Xc=function(t){return Wc(t).filter((function(t){return 0!==t.trim().length||-1<t.indexOf(" ")})).isSome()||P(Gc,er(t))},Yc=function(t,n){return e=n,r=void 0===(o=t)?document:o.dom,Re(r)?[]:L(r.querySelectorAll(e),re);var e,o,r},qc=function(t){if(0<t.rangeCount){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return w.some(Fc(re(n.startContainer),n.startOffset,re(e.endContainer),e.endOffset))}return w.none()},Kc=function(t){if(null===t.anchorNode||null===t.focusNode)return qc(t);var n=re(t.anchorNode),e=re(t.focusNode);return function(t,n,e,o){var r,i,u,a,c,s=(i=n,u=e,a=o,(c=cr(r=t).dom.createRange()).setStart(r.dom,i),c.setEnd(u.dom,a),c),l=Ve(t,e)&&n===o;return s.collapsed&&!l}(n,t.anchorOffset,e,t.focusOffset)?w.some(Fc(n,t.anchorOffset,e,t.focusOffset)):qc(t)},Jc=function(t,n){var o,r,i,u,a=function(t,n){var o,r,i,u=(o=t,n.match({domRange:function(t){return{ltr:e(t),rtl:w.none}},relative:function(t,n){return{ltr:Rt((function(){return Hc(o,t,n)})),rtl:Rt((function(){return w.some(Hc(o,n,t))}))}},exact:function(t,n,e,r){return{ltr:Rt((function(){return zc(o,t,n,e,r)})),rtl:Rt((function(){return w.some(zc(o,e,r,t,n))}))}}}));return(i=(r=u).ltr()).collapsed?r.rtl().filter((function(t){return!1===t.collapsed})).map((function(t){return Lc.rtl(re(t.endContainer),t.endOffset,re(t.startContainer),t.startOffset)})).getOrThunk((function(){return jc(0,Lc.ltr,i)})):jc(0,Lc.ltr,i)}(o=t,n).match({ltr:function(t,n,e,r){var i=o.document.createRange();return i.setStart(t.dom,n),i.setEnd(e.dom,r),i},rtl:function(t,n,e,r){var i=o.document.createRange();return i.setStart(e.dom,r),i.setEnd(t.dom,n),i}});return 0<(u=0<(i=(r=a).getClientRects()).length?i[0]:r.getBoundingClientRect()).width||0<u.height?w.some(u).map(Nc):w.none()},$c=function(t,n){return{element:t,offset:n}},Qc=function(t,n){var e=pr(t);if(0===e.length)return $c(t,n);if(n<e.length)return $c(e[n],0);var o,r=e[e.length-1],i=ir(r)?(o=r,Uc.get(o).length):pr(r).length;return $c(r,i)},Zc=function(t,n){return(ir(t)?$c:Qc)(t,n)},ts=function(t,n){return n.getSelection.getOrThunk((function(){return function(){return function(t){return n=t,w.from(n.getSelection()).filter((function(t){return 0<t.rangeCount})).bind(Kc);var n}(t)}}))().map((function(t){var n=Zc(t.start,t.soffset),e=Zc(t.finish,t.foffset);return Pc.range(n.element,n.offset,e.element,e.offset)}))},ns=[Pn("getSelection"),Bn("root"),Pn("bubble"),bc(),Un("overrides",{}),Un("showAbove",!1),Yu("placement",(function(t,n,e){var o=fr(n.root).dom,r=Bc(t,0,n),i=ts(o,n).bind((function(t){return Jc(o,Pc.exactFromRange(t)).orThunk((function(){var n=oe("\ufeff");return Cr(t.start,n),Jc(o,Pc.exact(n,0,n,1)).map((function(t){return Ar(n),t}))})).bind((function(t){return Ac(t.left,t.top,t.width,t.height)}))})),u=ts(o,n).bind((function(t){return rr(t.start)?w.some(t.start):mr(t.start)})).getOr(t.element);return Mc(i,r,n,e,u)}))],es=function(t){return t.x+t.width},os=function(t,n){return t.x-n.width},rs=function(t,n){return t.y-n.height+t.height},is=function(t){return t.y},us=function(t,n,e){return Ju(es(t),is(t),e.southeast(),Qu(),ua(t,{left:0,top:2}),"link-layout-se")},as=function(t,n,e){return Ju(os(t,n),is(t),e.southwest(),Zu(),ua(t,{right:1,top:2}),"link-layout-sw")},cs=function(t,n,e){return Ju(es(t),rs(t,n),e.northeast(),ta(),ua(t,{left:0,bottom:3}),"link-layout-ne")},ss=function(t,n,e){return Ju(os(t,n),rs(t,n),e.northwest(),na(),ua(t,{right:1,bottom:3}),"link-layout-nw")},ls=function(){return[us,as,cs,ss]},fs=function(){return[as,us,ss,cs]},ds=[Bn("item"),bc(),Un("overrides",{}),Yu("placement",(function(t,n,e){var o=qa(e,n.item.element),r=yc(t.element,n,ls(),fs(),ls(),fs(),w.none());return w.some({anchorBox:o,bubble:sc(),overrides:n.overrides,layouts:r,placer:w.none()})}))],ms=yn("anchor",{selection:ns,node:Dc,hotspot:xc,submenu:ds,makeshift:wc}),gs=function(n,e,o,r,i){!function(n,e,o,r,i,u){var a,c=ic(u,"maxHeightFunction",oc()),s=ic(u,"maxWidthFunction",t),l=n.anchorBox,f=n.origin,d={bounds:(a=f,i.fold((function(){return a.fold(bu,bu,pu)}),(function(t){return a.fold(t,t,(function(){var n=t(),e=Ka(a,n.x,n.y);return pu(e.left,e.top,n.width,n.height)}))}))),origin:f,preference:r,maxHeightFunction:c,maxWidthFunction:s};uc(l,e,o,d)}({anchorBox:o.anchorBox,origin:e},i.element,o.bubble,o.layouts,r,o.overrides)},ps=function(t,n,e,o,r,i){var u=i.map(hu);return hs(t,n,e,o,r,u)},hs=function(t,n,o,r,i,u){var a=hn("positioning anchor.info",ms,r);Ua((function(){Ei(i.element,"position","fixed");var o=Fi(i.element,"visibility");Ei(i.element,"visibility","hidden");var r,c,s,l,f=n.useFixed()?(l=document.documentElement,$a(0,0,l.clientWidth,l.clientHeight)):(c=tu((r=t).element),s=r.element.dom.getBoundingClientRect(),Ja(c.left,c.top,s.width,s.height)),d=a.placement,m=u.map(e).or(n.getBounds);d(t,a,f).each((function(n){n.placer.getOr(gs)(t,f,n,m,i)})),o.fold((function(){Ri(i.element,"visibility")}),(function(t){Ei(i.element,"visibility",t)})),Fi(i.element,"left").isNone()&&Fi(i.element,"top").isNone()&&Fi(i.element,"right").isNone()&&Fi(i.element,"bottom").isNone()&&Fi(i.element,"position").is("fixed")&&Ri(i.element,"position")}),i.element)},vs=Object.freeze({__proto__:null,position:function(t,n,e,o,r){ps(t,n,e,o,r,w.none())},positionWithin:ps,positionWithinBounds:hs,getMode:function(t,n,e){return n.useFixed()?"fixed":"absolute"}}),bs=[Un("useFixed",a),Pn("getBounds")],ys=Ia({fields:bs,name:"positioning",active:za,apis:vs}),xs=function(t){Vo(t,To());var n=t.components();j(n,xs)},ws=function(t){var n=t.components();j(n,ws),Vo(t,_o())},Ss=function(t,n){Tr(t.element,n.element)},ks=function(t,n){var e,o=t.components();j((e=t).components(),(function(t){return Ar(t.element)})),Br(e.element),e.syncComponents();var r=Z(o,n);j(r,(function(n){xs(n),t.getSystem().removeFromWorld(n)})),j(n,(function(n){n.getSystem().isConnected()?Ss(t,n):(t.getSystem().addToWorld(n),Ss(t,n),ki(t.element)&&ws(n)),t.syncComponents()}))},Cs=function(t,n){Os(t,n,Tr)},Os=function(t,n,e){t.getSystem().addToWorld(n),e(t.element,n.element),ki(t.element)&&ws(n),t.syncComponents()},_s=function(t){xs(t),Ar(t.element),t.getSystem().removeFromWorld(t)},Ts=function(t){var n=dr(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}));_s(t),n.each((function(t){t.syncComponents()}))},Es=function(t){var n=t.components();j(n,_s),Br(t.element),t.syncComponents()},Bs=function(t,n){As(t,n,Tr)},As=function(t,n,e){e(t,n.element);var o=pr(n.element);j(o,(function(t){n.getByDom(t).each(ws)}))},Ms=function(t){var n=pr(t.element);j(n,(function(n){t.getByDom(n).each(xs)})),Ar(t.element)},Ds=function(t,n,e,o){e.get().each((function(n){Es(t)}));var r=n.getAttachPoint(t);Cs(r,t);var i=t.getSystem().build(o);return Cs(t,i),e.set(i),i},Fs=function(t,n,e,o){var r=Ds(t,n,e,o);return n.onOpen(t,r),r},Is=function(t,n,e){e.get().each((function(o){Es(t),Ts(t),n.onClose(t,o),e.clear()}))},Rs=function(t,n,e){return e.isOpen()},Vs=function(t,n,e){var o,r,i,u=n.getAttachPoint(t);Ei(t.element,"position",ys.getMode(u)),o=t,r="visibility",i=n.cloakVisibilityAttr,Fi(o.element,r).fold((function(){zr(o.element,i)}),(function(t){Rr(o.element,i,t)})),Ei(o.element,r,"hidden")},Ps=function(t,n,e){var o,r,i,u;o=t.element,H(["top","left","right","bottom"],(function(t){return Fi(o,t).isSome()}))||Ri(t.element,"position"),r=t,i="visibility",u=n.cloakVisibilityAttr,Pr(r.element,u).fold((function(){return Ri(r.element,i)}),(function(t){return Ei(r.element,i,t)}))},Hs=Object.freeze({__proto__:null,cloak:Vs,decloak:Ps,open:Fs,openWhileCloaked:function(t,n,e,o,r){Vs(t,n),Fs(t,n,e,o),r(),Ps(t,n)},close:Is,isOpen:Rs,isPartOf:function(t,n,e,o){return Rs(0,0,e)&&e.get().exists((function(e){return n.isPartOf(t,e,o)}))},getState:function(t,n,e){return e.get()},setContent:function(t,n,e,o){return e.get().map((function(){return Ds(t,n,e,o)}))}}),zs=Object.freeze({__proto__:null,events:function(t,n){return jo([Go(yo(),(function(e,o){Is(e,t,n)}))])}}),Ns=[Uu("onOpen"),Uu("onClose"),Bn("isPartOf"),Bn("getAttachPoint"),Un("cloakVisibilityAttr","data-precloak-visibility")],Ls=Ia({fields:Ns,name:"sandboxing",active:zs,apis:Hs,state:Object.freeze({__proto__:null,init:function(){var t=Zn(w.none()),n=e("not-implemented");return ai({readState:n,isOpen:function(){return t.get().isSome()},clear:function(){t.set(w.none())},set:function(n){t.set(w.some(n))},get:function(){return t.get()}})}})}),js=e("dismiss.popups"),Us=e("reposition.popups"),Ws=e("mouse.released"),Gs=Zt([Un("isExtraPart",a),jn("fireEventInstead",[Un("event",Eo())])]),Xs=function(t){var n=hn("Dismissal",Gs,t),e={};return e[js()]={schema:Zt([Bn("target")]),onReceive:function(t,e){Ls.isOpen(t)&&(Ls.isPartOf(t,e.target)||n.isExtraPart(t,e.target)||n.fireEventInstead.fold((function(){return Ls.close(t)}),(function(n){return Vo(t,n.event)})))}},e},Ys=Zt([jn("fireEventInstead",[Un("event",Bo())]),Fn("doReposition")]),qs=function(t){var n=hn("Reposition",Ys,t),e={};return e[Us()]={onReceive:function(t){Ls.isOpen(t)&&n.fireEventInstead.fold((function(){return n.doReposition(t)}),(function(n){return Vo(t,n.event)}))}},e},Ks=function(t,n,e){n.store.manager.onLoad(t,n,e)},Js=function(t,n,e){n.store.manager.onUnload(t,n,e)},$s=Object.freeze({__proto__:null,onLoad:Ks,onUnload:Js,setValue:function(t,n,e,o){n.store.manager.setValue(t,n,e,o)},getValue:function(t,n,e){return n.store.manager.getValue(t,n,e)},getState:function(t,n,e){return e}}),Qs=Object.freeze({__proto__:null,events:function(t,n){var e=t.resetOnDom?[Qo((function(e,o){Ks(e,t,n)})),Zo((function(e,o){Js(e,t,n)}))]:[Ba(t,n,Ks)];return jo(e)}}),Zs=function(){var t=Zn(null);return ai({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})},tl=function(){var t=Zn({}),n=Zn({});return ai({readState:function(){return{mode:"dataset",dataByValue:t.get(),dataByText:n.get()}},lookup:function(e){return Tt(t.get(),e).orThunk((function(){return Tt(n.get(),e)}))},update:function(e){var o=t.get(),r=n.get(),i={},u={};j(e,(function(t){i[t.value]=t,Tt(t,"meta").each((function(n){Tt(n,"text").each((function(n){u[n]=t}))}))})),t.set(l(l({},o),i)),n.set(l(l({},r),u))},clear:function(){t.set({}),n.set({})}})},nl=Object.freeze({__proto__:null,memory:Zs,dataset:tl,manual:function(){return ai({readState:t})},init:function(t){return t.store.manager.state(t)}}),el=function(t,n,e,o){var r=n.store;e.update([o]),r.setValue(t,o),n.onSetValue(t,o)},ol=[Pn("initialValue"),Bn("getFallbackEntry"),Bn("getDataKey"),Bn("setValue"),Yu("manager",{setValue:el,getValue:function(t,n,e){var o=n.store,r=o.getDataKey(t);return e.lookup(r).fold((function(){return o.getFallbackEntry(r)}),(function(t){return t}))},onLoad:function(t,n,e){n.store.initialValue.each((function(o){el(t,n,e,o)}))},onUnload:function(t,n,e){e.clear()},state:tl})],rl=[Bn("getValue"),Un("setValue",t),Pn("initialValue"),Yu("manager",{setValue:function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},getValue:function(t,n,e){return n.store.getValue(t)},onLoad:function(t,n,e){n.store.initialValue.each((function(e){n.store.setValue(t,e)}))},onUnload:t,state:ui.init})],il=[Pn("initialValue"),Yu("manager",{setValue:function(t,n,e,o){e.set(o),n.onSetValue(t,o)},getValue:function(t,n,e){return e.get()},onLoad:function(t,n,e){n.store.initialValue.each((function(t){e.isNotSet()&&e.set(t)}))},onUnload:function(t,n,e){e.clear()},state:Zs})],ul=[Wn("store",{mode:"memory"},yn("mode",{memory:il,manual:rl,dataset:ol})),Uu("onSetValue"),Un("resetOnDom",!1)],al=Ia({fields:ul,name:"representing",active:Qs,apis:$s,extra:{setValueFrom:function(t,n){var e=al.getValue(n);al.setValue(t,e)}},state:nl}),cl=function(t,n){return $n(t,{},L(n,(function(n){return e=n.name(),o="Cannot configure "+n.name()+" for "+t,an(e,e,zt(),Qt((function(t){return ht("The field: "+e+" is forbidden. "+o)})));var e,o})).concat([Qn("dump",o)]))},sl=function(t){return t.dump},ll=function(t,n){return l(l({},t.dump),Da(n))},fl=cl,dl=ll,ml="placeholder",gl=At([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),pl=function(t){return Et(t,"uiType")},hl=function(t,n,r,i){return function(t,n,o,r){return pl(o)&&o.uiType===ml?(u=o,a=r,(i=t).exists((function(t){return t!==u.owner}))?gl.single(!0,e(u)):Tt(a,u.name).fold((function(){throw new Error("Unknown placeholder component: "+u.name+"\nKnown: ["+yt(a)+"]\nNamespace: "+i.getOr("none")+"\nSpec: "+JSON.stringify(u,null,2))}),(function(t){return t.replace()}))):gl.single(!1,e(o));var i,u,a}(t,0,r,i).fold((function(e,o){var u=pl(r)?o(n,r.config,r.validated):o(n),a=Tt(u,"components").getOr([]),c=J(a,(function(e){return hl(t,n,e,i)}));return[l(l({},u),{components:c})]}),(function(t,e){if(pl(r)){var i=e(n,r.config,r.validated);return r.validated.preprocess.getOr(o)(i)}return e(n)}))},vl=gl.single,bl=gl.multiple,yl=e(ml),xl=At([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),wl=Un("factory",{sketch:o}),Sl=Un("schema",[]),kl=Bn("name"),Cl=an("pname","pname",Nt((function(t){return"<alloy."+Wr(t.name)+">"})),xn()),Ol=Qn("schema",(function(){return[Pn("preprocess")]})),_l=Un("defaults",e({})),Tl=Un("overrides",e({})),El=tn([wl,Sl,kl,Cl,_l,Tl]),Bl=tn([wl,Sl,kl,_l,Tl]),Al=tn([wl,Sl,kl,Cl,_l,Tl]),Ml=tn([wl,Ol,kl,Bn("unit"),Cl,_l,Tl]),Dl=function(t){return t.fold(w.some,w.none,w.some,w.some)},Fl=function(t){var n=function(t){return t.name};return t.fold(n,n,n,n)},Il=function(t,n){return function(e){var o=hn("Converting part type",n,e);return t(o)}},Rl=Il(xl.required,El),Vl=Il(xl.external,Bl),Pl=Il(xl.optional,Al),Hl=Il(xl.group,Ml),zl=e("entirety"),Nl=Object.freeze({__proto__:null,required:Rl,external:Vl,optional:Pl,group:Hl,asNamedPart:Dl,name:Fl,asCommon:function(t){return t.fold(o,o,o,o)},original:zl}),Ll=function(t,n,e,o){return Ft(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))},jl=function(t,n){var e={};return j(n,(function(n){Dl(n).each((function(n){var o=Ul(t,n.pname);e[n.name]=function(e){var r=hn("Part: "+n.name+" in "+t,tn(n.schema),e);return l(l({},o),{config:e,validated:r})}}))})),e},Ul=function(t,n){return{uiType:yl(),owner:t,name:n}},Wl=function(t,n,e){return{uiType:yl(),owner:t,name:n,config:e,validated:{}}},Gl=function(t){return J(t,(function(t){return t.fold(w.none,w.some,w.none,w.none).map((function(t){return In(t.name,t.schema.concat([qu(zl())]))})).toArray()}))},Xl=function(t){return L(t,Fl)},Yl=function(t,n,o){return r=n,i={},u={},j(o,(function(t){t.fold((function(t){i[t.pname]=vl(!0,(function(n,e,o){return t.factory.sketch(Ll(n,t,e,o))}))}),(function(t){var n=r.parts[t.name];u[t.name]=e(t.factory.sketch(Ll(r,t,n[zl()]),n))}),(function(t){i[t.pname]=vl(!1,(function(n,e,o){return t.factory.sketch(Ll(n,t,e,o))}))}),(function(t){i[t.pname]=bl(!0,(function(n,e,o){var r=n[t.name];return L(r,(function(e){return t.factory.sketch(Ft(t.defaults(n,e,o),e,t.overrides(n,e)))}))}))}))})),{internals:e(i),externals:e(u)};var r,i,u},ql=function(t,n,o){return function(t,n,o,r){var i,u,a,c=St(r,(function(t,n){return r=t,i=!1,{name:e(o=n),required:function(){return r.fold((function(t,n){return t}),(function(t,n){return t}))},used:function(){return i},replace:function(){if(i)throw new Error("Trying to use the same placeholder more than once: "+o);return i=!0,r}};var o,r,i})),s=(i=t,u=n,a=c,J(o,(function(t){return hl(i,u,t,a)})));return wt(c,(function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(n.components,null,2))})),s}(w.some(t),n,n.components,o)},Kl=function(t,n,e){var o=n.partUids[e];return t.getSystem().getByUid(o).toOptional()},Jl=function(t,n,e){return Kl(t,n,e).getOrDie("Could not find part: "+e)},$l=function(t,n,o){var r={},i=n.partUids,u=t.getSystem();return j(o,(function(t){r[t]=e(u.getByUid(i[t]))})),r},Ql=function(t,n){var o=t.getSystem();return St(n.partUids,(function(t,n){return e(o.getByUid(t))}))},Zl=function(t){return yt(t.partUids)},tf=function(t,n,o){var r={},i=n.partUids,u=t.getSystem();return j(o,(function(t){r[t]=e(u.getByUid(i[t]).getOrDie())})),r},nf=function(t,n){var e=Xl(n);return Wt(L(e,(function(n){return{key:n,value:t+"-"+n}})))},ef=function(t){return an("partUids","partUids",Lt((function(n){return nf(n.uid,t)})),xn())},of=Object.freeze({__proto__:null,generate:jl,generateOne:Wl,schemas:Gl,names:Xl,substitutes:Yl,components:ql,defaultUids:nf,defaultUidsSchema:ef,getAllParts:Ql,getAllPartNames:Zl,getPart:Kl,getPartOrDie:Jl,getParts:$l,getPartsOrDie:tf}),rf=function(t,n,e,o,r){var i,u,a=(u=r,(0<(i=o).length?[In("parts",i)]:[]).concat([Bn("uid"),Un("dom",{}),Un("components",[]),qu("originalSpec"),Un("debug.sketcher",{})]).concat(u));return hn(t+" [SpecSchema]",Zt(a.concat(n)),e)},uf=function(t,n,e,o,r){var i=af(r),u=Gl(e),a=ef(e),c=rf(t,n,i,u,[a]),s=Yl(0,c,e);return o(c,ql(t,c,s.internals()),i,s.externals())},af=function(t){return Et(t,"uid")?t:l(l({},t),{uid:$r("uid")})},cf=Zt([Bn("name"),Bn("factory"),Bn("configFields"),Un("apis",{}),Un("extraApis",{})]),sf=Zt([Bn("name"),Bn("factory"),Bn("configFields"),Bn("partFields"),Un("apis",{}),Un("extraApis",{})]),lf=function(t){var n=hn("Sketcher for "+t.name,cf,t),e=St(n.apis,ii),o=St(n.extraApis,ei);return l(l({name:n.name,configFields:n.configFields,sketch:function(t){return e=n.name,o=n.configFields,r=n.factory,i=af(t),r(rf(e,o,i,[],[]),i);var e,o,r,i}},e),o)},ff=function(t){var n=hn("Sketcher for "+t.name,sf,t),e=jl(n.name,n.partFields),o=St(n.apis,ii),r=St(n.extraApis,ei);return l(l({name:n.name,partFields:n.partFields,configFields:n.configFields,sketch:function(t){return uf(n.name,n.configFields,n.partFields,n.factory,t)},parts:e},o),r)},df=function(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e);return n},mf=function(t,n){return t?w.some(n):w.none()},gf=function(t){return"input"===er(t)&&"radio"!==Vr(t,"type")||"textarea"===er(t)},pf=Object.freeze({__proto__:null,getCurrent:function(t,n,e){return n.find(t)}}),hf=[Bn("find")],vf=Ia({fields:hf,name:"composing",apis:pf}),bf=function(t,n,e,o){var r=Yc(t.element,"."+n.highlightClass);j(r,(function(e){H(o,(function(t){return t.element===e}))||(bi(e,n.highlightClass),t.getSystem().getByDom(e).each((function(e){n.onDehighlight(t,e),Vo(e,Ro())})))}))},yf=function(t,n,e,o){bf(t,n,0,[o]),xf(t,n,e,o)||(vi(o.element,n.highlightClass),n.onHighlight(t,o),Vo(o,Io()))},xf=function(t,n,e,o){return yi(o.element,n.highlightClass)},wf=function(t,n,e){return _u(t.element,"."+n.itemClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},Sf=function(t,n,e){var o=Yc(t.element,"."+n.itemClass);return(0<o.length?w.some(o[o.length-1]):w.none()).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},kf=function(t,n,e,o){var r=Yc(t.element,"."+n.itemClass);return q(r,(function(t){return yi(t,n.highlightClass)})).bind((function(n){var e=Qa(n,o,0,r.length-1);return t.getSystem().getByDom(r[e]).toOptional()}))},Cf=function(t,n,e){var o=Yc(t.element,"."+n.itemClass);return df(L(o,(function(n){return t.getSystem().getByDom(n).toOptional()})))},Of=Object.freeze({__proto__:null,dehighlightAll:function(t,n,e){return bf(t,n,0,[])},dehighlight:function(t,n,e,o){xf(t,n,e,o)&&(bi(o.element,n.highlightClass),n.onDehighlight(t,o),Vo(o,Ro()))},highlight:yf,highlightFirst:function(t,n,e){wf(t,n).each((function(o){yf(t,n,e,o)}))},highlightLast:function(t,n,e){Sf(t,n).each((function(o){yf(t,n,e,o)}))},highlightAt:function(t,n,e,o){(function(t,n,e,o){var r=Yc(t.element,"."+n.itemClass);return w.from(r[o]).fold((function(){return ct.error(new Error("No element found with index "+o))}),t.getSystem().getByDom)})(t,n,0,o).fold((function(t){throw t}),(function(o){yf(t,n,e,o)}))},highlightBy:function(t,n,e,o){var r=Cf(t,n);Y(r,o).each((function(o){yf(t,n,e,o)}))},isHighlighted:xf,getHighlighted:function(t,n,e){return _u(t.element,"."+n.highlightClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},getFirst:wf,getLast:Sf,getPrevious:function(t,n,e){return kf(t,n,0,-1)},getNext:function(t,n,e){return kf(t,n,0,1)},getCandidates:Cf}),_f=[Bn("highlightClass"),Bn("itemClass"),Uu("onHighlight"),Uu("onDehighlight")],Tf=Ia({fields:_f,name:"highlighting",apis:Of}),Ef=[8],Bf=[9],Af=[13],Mf=[27],Df=[32],Ff=[37],If=[38],Rf=[39],Vf=[40],Pf=function(t,n,e){var o=Q(t.slice(0,n)),r=Q(t.slice(n+1));return Y(o.concat(r),e)},Hf=function(t,n,e){var o=Q(t.slice(0,n));return Y(o,e)},zf=function(t,n,e){var o=t.slice(0,n),r=t.slice(n+1);return Y(r.concat(o),e)},Nf=function(t,n,e){var o=t.slice(n+1);return Y(o,e)},Lf=function(t){return function(n){var e=n.raw;return P(t,e.which)}},jf=function(t){return function(n){return $(t,(function(t){return t(n)}))}},Uf=function(t){return!0===t.raw.shiftKey},Wf=function(t){return!0===t.raw.ctrlKey},Gf=i(Uf),Xf=function(t,n){return{matches:t,classification:n}},Yf=function(t,n,e){n.exists((function(t){return e.exists((function(n){return Ve(n,t)}))}))||Po(t,Ao(),{prevFocus:n,newFocus:e})},qf=function(){var t=function(t){return ja(t.element)};return{get:t,set:function(n,e){var o=t(n);n.getSystem().triggerFocus(e,n.element);var r=t(n);Yf(n,o,r)}}},Kf=function(){var n=function(t){return Tf.getHighlighted(t).map((function(t){return t.element}))};return{get:n,set:function(e,o){var r=n(e);e.getSystem().getByDom(o).fold(t,(function(t){Tf.highlight(e,t)}));var i=n(e);Yf(e,r,i)}}};(pc=gc=gc||{}).OnFocusMode="onFocus",pc.OnEnterOrSpaceMode="onEnterOrSpace",pc.OnApiMode="onApi";var Jf=function(t,n,e,o,r){var i=function(t,n,e,o,r){var i,u;return i=e(t,n,o,r),u=n.event,Y(i,(function(t){return t.matches(u)})).map((function(t){return t.classification})).bind((function(e){return e(t,n,o,r)}))},u={schema:function(){return t.concat([Un("focusManager",qf()),Wn("focusInside","onFocus",dn((function(t){return P(["onFocus","onEnterOrSpace","onApi"],t)?ct.value(t):ct.error("Invalid value for focusInside")}))),Yu("handler",u),Yu("state",n),Yu("sendFocusIn",r)])},processKey:i,toEvents:function(t,n){var u=t.focusInside!==gc.OnFocusMode?w.none():r(t).map((function(e){return Go(lo(),(function(o,r){e(o,t,n),r.stop()}))})),a=[Go(no(),(function(o,u){i(o,u,e,t,n).fold((function(){var e,i,a;e=o,i=u,a=Lf(Df.concat(Af))(i.event),t.focusInside===gc.OnEnterOrSpaceMode&&a&&Le(e,i)&&r(t).each((function(o){o(e,t,n),i.stop()}))}),(function(t){u.stop()}))})),Go(eo(),(function(e,r){i(e,r,o,t,n).each((function(t){r.stop()}))}))];return jo(u.toArray().concat(a))}};return u},$f=function(t){var n=[Pn("onEscape"),Pn("onEnter"),Un("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Un("firstTabstop",0),Un("useTabstopAt",c),Pn("visibilitySelector")].concat([t]),o=function(t,n){var e=t.visibilitySelector.bind((function(t){return Tu(n,t)})).getOr(n);return 0<Ki(e)},i=function(t,n,e){var r,i,u;r=n,i=Yc(t.element,r.selector),u=W(i,(function(t){return o(r,t)})),w.from(u[r.firstTabstop]).each((function(e){n.focusManager.set(t,e)}))},u=function(t,n,e,r,i){return i(n,e,(function(t){return o(n=r,e=t)&&n.useTabstopAt(e);var n,e})).fold((function(){return r.cyclic?w.some(!0):w.none()}),(function(n){return r.focusManager.set(t,n),w.some(!0)}))},a=function(t,n,e,o){var i,a,c=Yc(t.element,e.selector);return i=t,(a=e).focusManager.get(i).bind((function(t){return Tu(t,a.selector)})).bind((function(n){return q(c,r(Ve,n)).bind((function(n){return u(t,c,n,e,o)}))}))},s=e([Xf(jf([Uf,Lf(Bf)]),(function(t,n,e){var o=e.cyclic?Pf:Hf;return a(t,0,e,o)})),Xf(Lf(Bf),(function(t,n,e){var o=e.cyclic?zf:Nf;return a(t,0,e,o)})),Xf(Lf(Mf),(function(t,n,e){return e.onEscape.bind((function(e){return e(t,n)}))})),Xf(jf([Gf,Lf(Af)]),(function(t,n,e){return e.onEnter.bind((function(e){return e(t,n)}))}))]),l=e([]);return Jf(n,ui.init,s,l,(function(){return w.some(i)}))},Qf=$f(Qn("cyclic",a)),Zf=$f(Qn("cyclic",c)),td=function(t,n,e){return gf(e)&&Lf(Df)(n.event)?w.none():(zo(t,e,po()),w.some(!0))},nd=function(t,n){return w.some(!0)},ed=[Un("execute",td),Un("useSpace",!1),Un("useEnter",!0),Un("useControlEnter",!1),Un("useDown",!1)],od=function(t,n,e){return e.execute(t,n,t.element)},rd=Jf(ed,ui.init,(function(t,n,e,o){var r=e.useSpace&&!gf(t.element)?Df:[],i=e.useEnter?Af:[],u=e.useDown?Vf:[],a=r.concat(i).concat(u);return[Xf(Lf(a),od)].concat(e.useControlEnter?[Xf(jf([Wf,Lf(Af)]),od)]:[])}),(function(t,n,e,o){return e.useSpace&&!gf(t.element)?[Xf(Lf(Df),nd)]:[]}),(function(){return w.none()})),id=function(){var t=Zn(w.none());return ai({readState:function(){return t.get().map((function(t){return{numRows:String(t.numRows),numColumns:String(t.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(n,e){t.set(w.some({numRows:n,numColumns:e}))},getNumRows:function(){return t.get().map((function(t){return t.numRows}))},getNumColumns:function(){return t.get().map((function(t){return t.numColumns}))}})},ud=Object.freeze({__proto__:null,flatgrid:id,init:function(t){return t.state(t)}}),ad=function(t){return function(n,e,o,r){var i=t(n.element);return fd(i,n,e,o,r)}},cd=function(t,n){var e=lc(t,n);return ad(e)},sd=function(t,n){var e=lc(n,t);return ad(e)},ld=function(t){return function(n,e,o,r){return fd(t,n,e,o,r)}},fd=function(t,n,e,o,r){return o.focusManager.get(n).bind((function(e){return t(n.element,e,o,r)})).map((function(t){return o.focusManager.set(n,t),!0}))},dd=ld,md=ld,gd=ld,pd=function(t){return!((n=t.dom).offsetWidth<=0&&n.offsetHeight<=0);var n},hd=function(t,n,e){var o,r=Yc(t,e),i=W(r,pd);return q(o=i,(function(t){return Ve(t,n)})).map((function(t){return{index:t,candidates:o}}))},vd=function(t,n){return q(t,(function(t){return Ve(n,t)}))},bd=function(t,n,e,o){return o(Math.floor(n/e),n%e).bind((function(n){var o=n.row*e+n.column;return 0<=o&&o<t.length?w.some(t[o]):w.none()}))},yd=function(t,n,e,o,r){return bd(t,n,o,(function(n,i){var u=n===e-1?t.length-n*o:o,a=Qa(i,r,0,u-1);return w.some({row:n,column:a})}))},xd=function(t,n,e,o,r){return bd(t,n,o,(function(n,i){var u=Qa(n,r,0,e-1),a=u===e-1?t.length-u*o:o,c=Za(i,0,a-1);return w.some({row:u,column:c})}))},wd=[Bn("selector"),Un("execute",td),Wu("onEscape"),Un("captureTab",!1),Ku()],Sd=function(t,n,e){_u(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))},kd=function(t){return function(n,e,o,r){return hd(n,e,o.selector).bind((function(n){return t(n.candidates,n.index,r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))}))}},Cd=function(t,n,e){return e.captureTab?w.some(!0):w.none()},Od=kd((function(t,n,e,o){return yd(t,n,e,o,-1)})),_d=kd((function(t,n,e,o){return yd(t,n,e,o,1)})),Td=kd((function(t,n,e,o){return xd(t,n,e,o,-1)})),Ed=kd((function(t,n,e,o){return xd(t,n,e,o,1)})),Bd=e([Xf(Lf(Ff),cd(Od,_d)),Xf(Lf(Rf),sd(Od,_d)),Xf(Lf(If),dd(Td)),Xf(Lf(Vf),md(Ed)),Xf(jf([Uf,Lf(Bf)]),Cd),Xf(jf([Gf,Lf(Bf)]),Cd),Xf(Lf(Mf),(function(t,n,e){return e.onEscape(t,n)})),Xf(Lf(Df.concat(Af)),(function(t,n,e,o){return r=t,(i=e).focusManager.get(r).bind((function(t){return Tu(t,i.selector)})).bind((function(o){return e.execute(t,n,o)}));var r,i}))]),Ad=e([Xf(Lf(Df),nd)]),Md=Jf(wd,id,Bd,Ad,(function(){return w.some(Sd)})),Dd=function(t,n,e,o){var r=function(t,n,e){var i,u=Qa(n,o,0,e.length-1);return u===t?w.none():(i=e[u],"button"===er(i)&&"disabled"===Vr(i,"disabled")?r(t,u,e):w.from(e[u]))};return hd(t,e,n).bind((function(t){var n=t.index,e=t.candidates;return r(n,n,e)}))},Fd=[Bn("selector"),Un("getInitial",w.none),Un("execute",td),Wu("onEscape"),Un("executeOnMove",!1),Un("allowVertical",!0)],Id=function(t,n,e){return o=t,(r=e).focusManager.get(o).bind((function(t){return Tu(t,r.selector)})).bind((function(o){return e.execute(t,n,o)}));var o,r},Rd=function(t,n,e){n.getInitial(t).orThunk((function(){return _u(t.element,n.selector)})).each((function(e){n.focusManager.set(t,e)}))},Vd=function(t,n,e){return Dd(t,e.selector,n,-1)},Pd=function(t,n,e){return Dd(t,e.selector,n,1)},Hd=function(t){return function(n,e,o,r){return t(n,e,o,r).bind((function(){return o.executeOnMove?Id(n,e,o):w.some(!0)}))}},zd=function(t,n,e){return e.onEscape(t,n)},Nd=e([Xf(Lf(Df),nd)]),Ld=Jf(Fd,ui.init,(function(t,n,e,o){var r=Ff.concat(e.allowVertical?If:[]),i=Rf.concat(e.allowVertical?Vf:[]);return[Xf(Lf(r),Hd(cd(Vd,Pd))),Xf(Lf(i),Hd(sd(Vd,Pd))),Xf(Lf(Af),Id),Xf(Lf(Df),Id),Xf(Lf(Mf),zd)]}),Nd,(function(){return w.some(Rd)})),jd=function(t,n,e){return w.from(t[n]).bind((function(t){return w.from(t[e]).map((function(t){return{rowIndex:n,columnIndex:e,cell:t}}))}))},Ud=function(t,n,e,o){var r=t[n].length,i=Qa(e,o,0,r-1);return jd(t,n,i)},Wd=function(t,n,e,o){var r=Qa(e,o,0,t.length-1),i=t[r].length,u=Za(n,0,i-1);return jd(t,r,u)},Gd=function(t,n,e,o){var r=t[n].length,i=Za(e+o,0,r-1);return jd(t,n,i)},Xd=function(t,n,e,o){var r=Za(e+o,0,t.length-1),i=t[r].length,u=Za(n,0,i-1);return jd(t,r,u)},Yd=[In("selectors",[Bn("row"),Bn("cell")]),Un("cycles",!0),Un("previousSelector",w.none),Un("execute",td)],qd=function(t,n,e){n.previousSelector(t).orThunk((function(){var e=n.selectors;return _u(t.element,e.cell)})).each((function(e){n.focusManager.set(t,e)}))},Kd=function(t,n){return function(e,o,r){var i=r.cycles?t:n;return Tu(o,r.selectors.row).bind((function(t){var n=Yc(t,r.selectors.cell);return vd(n,o).bind((function(n){var o=Yc(e,r.selectors.row);return vd(o,t).bind((function(t){var e,u=(e=r,L(o,(function(t){return Yc(t,e.selectors.cell)})));return i(u,t,n).map((function(t){return t.cell}))}))}))}))}},Jd=Kd((function(t,n,e){return Ud(t,n,e,-1)}),(function(t,n,e){return Gd(t,n,e,-1)})),$d=Kd((function(t,n,e){return Ud(t,n,e,1)}),(function(t,n,e){return Gd(t,n,e,1)})),Qd=Kd((function(t,n,e){return Wd(t,e,n,-1)}),(function(t,n,e){return Xd(t,e,n,-1)})),Zd=Kd((function(t,n,e){return Wd(t,e,n,1)}),(function(t,n,e){return Xd(t,e,n,1)})),tm=e([Xf(Lf(Ff),cd(Jd,$d)),Xf(Lf(Rf),sd(Jd,$d)),Xf(Lf(If),dd(Qd)),Xf(Lf(Vf),md(Zd)),Xf(Lf(Df.concat(Af)),(function(t,n,e){return ja(t.element).bind((function(o){return e.execute(t,n,o)}))}))]),nm=e([Xf(Lf(Df),nd)]),em=Jf(Yd,ui.init,tm,nm,(function(){return w.some(qd)})),om=[Bn("selector"),Un("execute",td),Un("moveOnTab",!1)],rm=function(t,n,e){return e.focusManager.get(t).bind((function(o){return e.execute(t,n,o)}))},im=function(t,n,e){_u(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))},um=function(t,n,e){return Dd(t,e.selector,n,-1)},am=function(t,n,e){return Dd(t,e.selector,n,1)},cm=e([Xf(Lf(If),gd(um)),Xf(Lf(Vf),gd(am)),Xf(jf([Uf,Lf(Bf)]),(function(t,n,e,o){return e.moveOnTab?gd(um)(t,n,e,o):w.none()})),Xf(jf([Gf,Lf(Bf)]),(function(t,n,e,o){return e.moveOnTab?gd(am)(t,n,e,o):w.none()})),Xf(Lf(Af),rm),Xf(Lf(Df),rm)]),sm=e([Xf(Lf(Df),nd)]),lm=Jf(om,ui.init,cm,sm,(function(){return w.some(im)})),fm=[Wu("onSpace"),Wu("onEnter"),Wu("onShiftEnter"),Wu("onLeft"),Wu("onRight"),Wu("onTab"),Wu("onShiftTab"),Wu("onUp"),Wu("onDown"),Wu("onEscape"),Un("stopSpaceKeyup",!1),Pn("focusIn")],dm=Jf(fm,ui.init,(function(t,n,e){return[Xf(Lf(Df),e.onSpace),Xf(jf([Gf,Lf(Af)]),e.onEnter),Xf(jf([Uf,Lf(Af)]),e.onShiftEnter),Xf(jf([Uf,Lf(Bf)]),e.onShiftTab),Xf(jf([Gf,Lf(Bf)]),e.onTab),Xf(Lf(If),e.onUp),Xf(Lf(Vf),e.onDown),Xf(Lf(Ff),e.onLeft),Xf(Lf(Rf),e.onRight),Xf(Lf(Df),e.onSpace),Xf(Lf(Mf),e.onEscape)]}),(function(t,n,e){return e.stopSpaceKeyup?[Xf(Lf(Df),nd)]:[]}),(function(t){return t.focusIn})),mm=Qf.schema(),gm=Zf.schema(),pm=Ld.schema(),hm=Md.schema(),vm=em.schema(),bm=rd.schema(),ym=lm.schema(),xm=dm.schema(),wm=Va({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:mm,cyclic:gm,flow:pm,flatgrid:hm,matrix:vm,execution:bm,menu:ym,special:xm}),name:"keying",active:{events:function(t,n){return t.handler.toEvents(t,n)}},apis:{focusIn:function(t,n,e){n.sendFocusIn(n).fold((function(){t.getSystem().triggerFocus(t.element,t.element)}),(function(o){o(t,n,e)}))},setGridSize:function(t,n,e,o,r){Bt(e,"setGridSize")?e.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:ud}),Sm=function(t,n,e,o){var r=t.getSystem().build(o);Os(t,r,e)},km=function(t,n,e,o){var r=Cm(t);Y(r,(function(t){return Ve(o.element,t.element)})).each(Ts)},Cm=function(t,n){return t.components()},Om=function(t,n,e,o,r){var i=Cm(t);return w.from(i[o]).map((function(n){return km(t,0,0,n),r.each((function(n){Sm(t,0,(function(t,n){var e,r;r=n,hr(e=t,o).fold((function(){Tr(e,r)}),(function(t){Cr(t,r)}))}),n)})),n}))},_m=Ia({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(t,n,e,o){Sm(t,0,Tr,o)},prepend:function(t,n,e,o){Sm(t,0,_r,o)},remove:km,replaceAt:Om,replaceBy:function(t,n,e,o,r){var i=Cm(t);return q(i,o).bind((function(n){return Om(t,0,0,n,r)}))},set:function(t,n,e,o){Ua((function(){var n=L(o,t.getSystem().build);ks(t,n)}),t.element)},contents:Cm})}),Tm=function(t,n){var o,r;return{key:t,value:{config:{},me:(o=t,r=jo(n),Ia({fields:[Bn("enabled")],name:o,active:{events:e(r)}})),configAsRaw:e({}),initialConfig:{},state:ui}}},Em=function(t,n){n.ignore||(Na(t.element),n.onFocus(t))},Bm=Object.freeze({__proto__:null,focus:Em,blur:function(t,n){n.ignore||t.element.dom.blur()},isFocused:function(t){return n=t.element,e=xr(n).dom,n.dom===e.activeElement;var n,e}}),Am=Object.freeze({__proto__:null,exhibit:function(t,n){var e=n.ignore?{}:{attributes:{tabindex:"-1"}};return si(e)},events:function(t){return jo([Go(lo(),(function(n,e){Em(n,t),e.stop()}))].concat(t.stopMousedown?[Go(qe(),(function(t,n){n.event.prevent()}))]:[]))}}),Mm=[Uu("onFocus"),Un("stopMousedown",!1),Un("ignore",!1)],Dm=Ia({fields:Mm,name:"focusing",active:Am,apis:Bm}),Fm=function(t,n,e){var o=n.aria;o.update(t,o,e.get())},Im=function(t,n,e){n.toggleClass.each((function(n){(e.get()?vi:bi)(t.element,n)}))},Rm=function(t,n,e){Hm(t,n,e,!e.get())},Vm=function(t,n,e){e.set(!0),Im(t,n,e),Fm(t,n,e)},Pm=function(t,n,e){e.set(!1),Im(t,n,e),Fm(t,n,e)},Hm=function(t,n,e,o){(o?Vm:Pm)(t,n,e)},zm=function(t,n,e){Hm(t,n,e,n.selected)},Nm=Object.freeze({__proto__:null,onLoad:zm,toggle:Rm,isOn:function(t,n,e){return e.get()},on:Vm,off:Pm,set:Hm}),Lm=Object.freeze({__proto__:null,exhibit:function(){return si({})},events:function(t,n){var e,o,r,i=(e=t,o=n,r=Rm,nr((function(t){r(t,e,o)}))),u=Ba(t,n,zm);return jo(K([t.toggleOnExecute?[i]:[],[u]]))}}),jm=function(t,n,e){Rr(t.element,"aria-expanded",e)},Um=[Un("selected",!1),Pn("toggleClass"),Un("toggleOnExecute",!0),Wn("aria",{mode:"none"},yn("mode",{pressed:[Un("syncWithExpanded",!1),Yu("update",(function(t,n,e){Rr(t.element,"aria-pressed",e),n.syncWithExpanded&&jm(t,0,e)}))],checked:[Yu("update",(function(t,n,e){Rr(t.element,"aria-checked",e)}))],expanded:[Yu("update",jm)],selected:[Yu("update",(function(t,n,e){Rr(t.element,"aria-selected",e)}))],none:[Yu("update",t)]}))],Wm=Ia({fields:Um,name:"toggling",active:Lm,apis:Nm,state:(!1,{init:function(){var t=Zn(false);return{get:function(){return t.get()},set:function(n){return t.set(n)},clear:function(){return t.set(false)},readState:function(){return t.get()}}}})}),Gm=function(){var t=function(t,n){n.stop(),Ho(t)};return[Go(io(),t),Go(vo(),t),Jo(We()),Jo(qe())]},Xm=function(t){return jo(K([t.map((function(t){return nr((function(n,e){t(n),e.stop()}))})).toArray(),Gm()]))},Ym="alloy.item-hover",qm="alloy.item-focus",Km=function(t){(ja(t.element).isNone()||Dm.isFocused(t))&&(Dm.isFocused(t)||Dm.focus(t),Po(t,Ym,{item:t}))},Jm=function(t){Po(t,qm,{item:t})},$m=e(Ym),Qm=e(qm),Zm=[Bn("data"),Bn("components"),Bn("dom"),Un("hasSubmenu",!1),Pn("toggling"),fl("itemBehaviours",[Wm,Dm,wm,al]),Un("ignoreFocus",!1),Un("domModification",{}),Yu("builder",(function(t){return{dom:t.dom,domModification:l(l({},t.domModification),{attributes:l(l(l({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:dl(t.itemBehaviours,[t.toggling.fold(Wm.revoke,(function(t){return Wm.config(l({aria:{mode:"checked"}},t))})),Dm.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){Jm(t)}}),wm.config({mode:"execution"}),al.config({store:{mode:"memory",initialValue:t.data}}),Tm("item-type-events",d(Gm(),[Go(Qe(),Km),Go(ho(),Dm.focus)]))]),components:t.components,eventOrder:t.eventOrder}})),Un("eventOrder",{})],tg=[Bn("dom"),Bn("components"),Yu("builder",(function(t){return{dom:t.dom,components:t.components,events:jo([(n=ho(),Go(n,(function(t,n){n.stop()})))])};var n}))],ng=e("item-widget"),eg=e([Rl({name:"widget",overrides:function(n){return{behaviours:Da([al.config({store:{mode:"manual",getValue:function(t){return n.data},setValue:t}})])}}})]),og=[Bn("uid"),Bn("data"),Bn("components"),Bn("dom"),Un("autofocus",!1),Un("ignoreFocus",!1),fl("widgetBehaviours",[al,Dm,wm]),Un("domModification",{}),ef(eg()),Yu("builder",(function(t){var n=Yl(ng(),t,eg()),e=ql(ng(),t,n.internals()),o=function(n){return Kl(n,t,"widget").map((function(t){return wm.focusIn(t),t}))},r=function(n,e){return gf(e.event.target)||t.autofocus&&e.setSource(n.element),w.none()};return{dom:t.dom,components:e,domModification:t.domModification,events:jo([nr((function(t,n){o(t).each((function(t){n.stop()}))})),Go(Qe(),Km),Go(ho(),(function(n,e){t.autofocus?o(n):Dm.focus(n)}))]),behaviours:dl(t.widgetBehaviours,[al.config({store:{mode:"memory",initialValue:t.data}}),Dm.config({ignore:t.ignoreFocus,onFocus:function(t){Jm(t)}}),wm.config({mode:"special",focusIn:t.autofocus?function(t){o(t)}:Pa(),onLeft:r,onRight:r,onEscape:function(n,e){return Dm.isFocused(n)||t.autofocus?(t.autofocus&&e.setSource(n.element),w.none()):(Dm.focus(n),w.some(!0))}})])}}))],rg=yn("type",{widget:og,item:Zm,separator:tg}),ig=e([Hl({factory:{sketch:function(t){var n=hn("menu.spec item",rg,t);return n.builder(n)}},name:"items",unit:"item",defaults:function(t,n){return n.hasOwnProperty("uid")?n:l(l({},n),{uid:$r("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),ug=e([Bn("value"),Bn("items"),Bn("dom"),Bn("components"),Un("eventOrder",{}),cl("menuBehaviours",[Tf,al,vf,wm]),Wn("movement",{mode:"menu",moveOnTab:!0},yn("mode",{grid:[Ku(),Yu("config",(function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}}))],matrix:[Yu("config",(function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}})),Bn("rowSelector")],menu:[Un("moveOnTab",!0),Yu("config",(function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}}))]})),An("markers",Hu()),Un("fakeFocus",!1),Un("focusManager",qf()),Uu("onHighlight")]),ag=e("alloy.menu-focus"),cg=ff({name:"Menu",configFields:ug(),partFields:ig(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:ll(t.menuBehaviours,[Tf.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),al.config({store:{mode:"memory",initialValue:t.value}}),vf.config({find:w.some}),wm.config(t.movement.config(t,t.movement))]),events:jo([Go(Qm(),(function(t,n){var e=n.event;t.getSystem().getByDom(e.target).each((function(e){Tf.highlight(t,e),n.stop(),Po(t,ag(),{menu:t,item:e})}))})),Go($m(),(function(t,n){var e=n.event.item;Tf.highlight(t,e)}))]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),sg=function(t,n,e,o){return Tt(e,o).bind((function(o){return Tt(t,o).bind((function(o){var r=sg(t,n,e,o);return w.some([o].concat(r))}))})).getOr([])},lg=function(t){return"prepared"===t.type?w.some(t.menu):w.none()},fg=function(){var t=Zn({}),n=Zn({}),e=Zn({}),o=Zn(w.none()),r=Zn({}),i=function(n,e,o){return u(n).bind((function(r){return i=n,Ot(t.get(),(function(t,n){return t===i})).bind((function(t){return e(t).map((function(t){return{triggeredMenu:r,triggeringItem:t,triggeringPath:o}}))}));var i}))},u=function(t){return a(t).bind(lg)},a=function(t){return Tt(n.get(),t)},c=function(n){return Tt(t.get(),n)};return{setMenuBuilt:function(t,e){var o;n.set(l(l({},n.get()),((o={})[t]={type:"prepared",menu:e},o)))},setContents:function(i,u,a,c){o.set(w.some(i)),t.set(a),n.set(u),r.set(c);var s=function(t,n){var e={};wt(t,(function(t,n){j(t,(function(t){e[t]=n}))}));var o=n,r=kt(n,(function(t,n){return{k:t,v:n}})),i=St(r,(function(t,n){return[n].concat(sg(e,o,r,n))}));return St(e,(function(t){return Tt(i,t).getOr([t])}))}(c,a);e.set(s)},expand:function(n){return Tt(t.get(),n).map((function(t){var o=Tt(e.get(),n).getOr([]);return[t].concat(o)}))},refresh:function(t){return Tt(e.get(),t)},collapse:function(t){return Tt(e.get(),t).bind((function(t){return 1<t.length?w.some(t.slice(1)):w.none()}))},lookupMenu:a,lookupItem:c,otherMenus:function(t){var n=r.get();return Z(yt(n),t)},getPrimary:function(){return o.get().bind(u)},getMenus:function(){return n.get()},clear:function(){t.set({}),n.set({}),e.set({}),o.set(w.none())},isClear:function(){return o.get().isNone()},getTriggeringPath:function(t,n){var r=W(c(t).toArray(),(function(t){return u(t).isSome()}));return Tt(e.get(),t).bind((function(t){var e=Q(r.concat(t));return function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e];if(!o.isSome())return w.none();n.push(o.getOrDie())}return w.some(n)}(J(e,(function(t,r){return i(t,n,e.slice(0,r+1)).fold((function(){return o.get().is(t)?[]:[w.none()]}),(function(t){return[w.some(t)]}))})))}))}}},dg=lg,mg=e("collapse-item"),gg=lf({name:"TieredMenu",configFields:[Xu("onExecute"),Xu("onEscape"),Gu("onOpenMenu"),Gu("onOpenSubmenu"),Uu("onRepositionMenu"),Uu("onCollapseMenu"),Un("highlightImmediately",!0),In("data",[Bn("primary"),Bn("menus"),Bn("expansions")]),Un("fakeFocus",!1),Uu("onHighlight"),Uu("onHover"),Nu(),Bn("dom"),Un("navigateOnHover",!0),Un("stayInDom",!1),cl("tmenuBehaviours",[wm,Tf,vf,_m]),Un("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)},repositionMenus:function(t,n){t.repositionMenus(n)}},factory:function(n,e){var o,r,i=Zn(w.none()),u=fg(),a=function(t){return al.getValue(t).value},s=function(t){return St(n.data.menus,(function(t,n){return J(t.items,(function(t){return"separator"===t.type?[]:[t.data.value]}))}))},f=function(t,n){Tf.highlight(t,n),Tf.getHighlighted(n).orThunk((function(){return Tf.getFirst(n)})).each((function(n){zo(t,n.element,ho())}))},d=function(t,n){return df(L(n,(function(n){return t.lookupMenu(n).bind((function(t){return"prepared"===t.type?w.some(t.menu):w.none()}))})))},m=function(t,e,o){var r=d(e,e.otherMenus(o));j(r,(function(e){wi(e.element,[n.markers.backgroundMenu]),n.stayInDom||_m.remove(t,e)}))},g=function(t,e){var o,r=(o=t,i.get().getOrThunk((function(){var t={},e=Yc(o.element,"."+n.markers.item),r=W(e,(function(t){return"true"===Vr(t,"aria-haspopup")}));return j(r,(function(n){o.getSystem().getByDom(n).each((function(n){var e=a(n);t[e]=n}))})),i.set(w.some(t)),t})));wt(r,(function(t,n){var o=P(e,n);Rr(t.element,"aria-expanded",o)}))},p=function(t,e,o){return w.from(o[0]).bind((function(r){return e.lookupMenu(r).bind((function(r){if("notbuilt"===r.type)return w.none();var i=r.menu,u=d(e,o.slice(1));return j(u,(function(t){vi(t.element,n.markers.backgroundMenu)})),ki(i.element)||_m.append(t,Xi(i)),wi(i.element,[n.markers.backgroundMenu]),f(t,i),m(t,e,o),w.some(i)}))}))};(r=o=o||{})[r.HighlightSubmenu=0]="HighlightSubmenu",r[r.HighlightParent=1]="HighlightParent";var h=function(t,e,r){void 0===r&&(r=o.HighlightSubmenu);var i=a(e);return u.expand(i).bind((function(i){return g(t,i),w.from(i[0]).bind((function(a){return u.lookupMenu(a).bind((function(c){var s=function(t,n,e){if("notbuilt"!==e.type)return e.menu;var o=t.getSystem().build(e.nbMenu());return u.setMenuBuilt(n,o),o}(t,a,c);return ki(s.element)||_m.append(t,Xi(s)),n.onOpenSubmenu(t,e,s,Q(i)),r===o.HighlightSubmenu?(Tf.highlightFirst(s),p(t,u,i)):(Tf.dehighlightAll(s),w.some(e))}))}))}))},v=function(t,e){var o=a(e);return u.collapse(o).bind((function(o){return g(t,o),p(t,u,o).map((function(o){return n.onCollapseMenu(t,e,o),o}))}))},b=function(t){return function(e,o){return Tu(o.getSource(),"."+n.markers.item).bind((function(n){return e.getSystem().getByDom(n).toOptional().bind((function(n){return t(e,n).map(c)}))}))}},y=jo([Go(ag(),(function(t,n){var e=n.event.item;u.lookupItem(a(e)).each((function(){var e=n.event.menu;Tf.highlight(t,e);var o=a(n.event.item);u.refresh(o).each((function(n){return m(t,u,n)}))}))})),nr((function(e,r){var i=r.event.target;e.getSystem().getByDom(i).each((function(r){0===a(r).indexOf("collapse-item")&&v(e,r),h(e,r,o.HighlightSubmenu).fold((function(){n.onExecute(e,r)}),t)}))})),Qo((function(t,e){(function(t){var e,o,r,i=(e=t,o=n.data.primary,r=n.data.menus,St(r,(function(t,r){var i=function(){return cg.sketch(l(l({},t),{value:r,markers:n.markers,fakeFocus:n.fakeFocus,onHighlight:n.onHighlight,focusManager:(n.fakeFocus?Kf:qf)()}))};return r===o?{type:"prepared",menu:e.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))),a=s();return u.setContents(n.data.primary,i,n.data.expansions,a),u.getPrimary()})(t).each((function(e){_m.append(t,Xi(e)),n.onOpenMenu(t,e),n.highlightImmediately&&f(t,e)}))}))].concat(n.navigateOnHover?[Go($m(),(function(t,e){var r,i,c=e.event.item;r=t,i=a(c),u.refresh(i).bind((function(t){return g(r,t),p(r,u,t)})),h(t,c,o.HighlightParent),n.onHover(t,c)}))]:[])),x=function(t){return Tf.getHighlighted(t).bind(Tf.getHighlighted)},S={collapseMenu:function(t){x(t).each((function(n){v(t,n)}))},highlightPrimary:function(t){u.getPrimary().each((function(n){f(t,n)}))},repositionMenus:function(t){u.getPrimary().bind((function(n){return x(t).bind((function(t){var n=a(t),e=_t(u.getMenus()),o=df(L(e,dg));return u.getTriggeringPath(n,(function(t){return n=t,it(o,(function(t){if(!t.getSystem().isConnected())return w.none();var e=Tf.getCandidates(t);return Y(e,(function(t){return a(t)===n}))}));var n}))})).map((function(t){return{primary:n,triggeringPath:t}}))})).fold((function(){var e;e=t,w.from(e.components()[0]).filter((function(t){return"menu"===Vr(t.element,"role")})).each((function(e){n.onRepositionMenu(t,e,[])}))}),(function(e){var o=e.primary,r=e.triggeringPath;n.onRepositionMenu(t,o,r)}))}};return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:ll(n.tmenuBehaviours,[wm.config({mode:"special",onRight:b((function(t,n){return gf(n.element)?w.none():h(t,n,o.HighlightSubmenu)})),onLeft:b((function(t,n){return gf(n.element)?w.none():v(t,n)})),onEscape:b((function(t,e){return v(t,e).orThunk((function(){return n.onEscape(t,e).map((function(){return t}))}))})),focusIn:function(t,n){u.getPrimary().each((function(n){zo(t,n.element,ho())}))}}),Tf.config({highlightClass:n.markers.selectedMenu,itemClass:n.markers.menu}),vf.config({find:function(t){return Tf.getHighlighted(t)}}),_m.config({})]),eventOrder:n.eventOrder,apis:S,events:y}},extraApis:{tieredData:function(t,n,e){return{primary:t,menus:n,expansions:e}},singleData:function(t,n){return{primary:t,menus:Ut(t,n),expansions:{}}},collapseItem:function(t){return{value:Wr(mg()),meta:{text:t}}}}}),pg=lf({name:"InlineView",configFields:[Bn("lazySink"),Uu("onShow"),Uu("onHide"),Ln("onEscape"),cl("inlineBehaviours",[Ls,al,Ha]),jn("fireDismissalEventInstead",[Un("event",Eo())]),jn("fireRepositionEventInstead",[Un("event",Bo())]),Un("getRelated",w.none),Un("isExtraPart",a),Un("eventOrder",w.none)],factory:function(t,n){var e=function(t,n,e,r){o(t,n,e,(function(){return r.map(hu)}))},o=function(n,e,o,r){var i=t.lazySink(n).getOrDie();Ls.openWhileCloaked(n,o,(function(){return ys.positionWithinBounds(i,e,n,r())})),al.setValue(n,w.some({mode:"position",anchor:e,getBounds:r}))},r=function(n,e,o,r){var i,u,a,c,s,f,d,m,g=(i=t,u=n,a=e,s=r,f=function(){return i.lazySink(u)},d="horizontal"===(c=o).type?{layouts:{onLtr:Oa,onRtl:_a}}:{},m=function(t){return 2===t.length?d:{}},gg.sketch({dom:{tag:"div"},data:c.data,markers:c.menu.markers,highlightImmediately:c.menu.highlightImmediately,onEscape:function(){return Ls.close(u),i.onEscape.map((function(t){return t(u)})),w.some(!0)},onExecute:function(){return w.some(!0)},onOpenMenu:function(t,n){ys.positionWithinBounds(f().getOrDie(),a,n,s())},onOpenSubmenu:function(t,n,e,o){var r=f().getOrDie();ys.position(r,l({anchor:"submenu",item:n},m(o)),e)},onRepositionMenu:function(t,n,e){var o=f().getOrDie();ys.positionWithinBounds(o,a,n,s()),j(e,(function(t){var n=m(t.triggeringPath);ys.position(o,l({anchor:"submenu",item:t.triggeringItem},n),t.triggeredMenu)}))}}));Ls.open(n,g),al.setValue(n,w.some({mode:"menu",menu:g}))},i=function(n){Ls.isOpen(n)&&al.getValue(n).each((function(e){switch(e.mode){case"menu":Ls.getState(n).each((function(t){gg.repositionMenus(t)}));break;case"position":var o=t.lazySink(n).getOrDie();ys.positionWithinBounds(o,e.anchor,n,e.getBounds())}}))},u={setContent:function(t,n){Ls.setContent(t,n)},showAt:function(t,n,o){e(t,n,o,w.none())},showWithin:e,showWithinBounds:o,showMenuAt:function(t,n,e){r(t,n,e,(function(){return w.none()}))},showMenuWithinBounds:r,hide:function(t){Ls.isOpen(t)&&(al.setValue(t,w.none()),Ls.close(t))},getContent:function(t){return Ls.getState(t)},reposition:i,isOpen:Ls.isOpen};return{uid:t.uid,dom:t.dom,behaviours:ll(t.inlineBehaviours,[Ls.config({isPartOf:function(n,e,o){return Bu(e,o)||(r=n,i=o,t.getRelated(r).exists((function(t){return Bu(t,i)})));var r,i},getAttachPoint:function(n){return t.lazySink(n).getOrDie()},onOpen:function(n){t.onShow(n)},onClose:function(n){t.onHide(n)}}),al.config({store:{mode:"memory",initialValue:w.none()}}),Ha.config({channels:l(l({},Xs(l({isExtraPart:n.isExtraPart},t.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),qs(l(l({},t.fireRepositionEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})),{doReposition:i})))})]),eventOrder:t.eventOrder,apis:u}},apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showWithinBounds:function(t,n,e,o,r){t.showWithinBounds(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},showMenuWithinBounds:function(t,n,e,o,r){t.showMenuWithinBounds(n,e,o,r)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)},reposition:function(t,n){t.reposition(n)}}}),hg=function(t){return t.x},vg=function(t,n){return t.x+t.width/2-n.width/2},bg=function(t,n){return t.x+t.width-n.width},yg=function(t){return t.y},xg=function(t,n){return t.y+t.height-n.height},wg=function(t,n,e){return Ju(bg(t,n),xg(t,n),e.innerSoutheast(),na(),ua(t,{right:0,bottom:3}),"layout-inner-se")},Sg=function(t,n,e){return Ju(hg(t),xg(t,n),e.innerSouthwest(),ta(),ua(t,{left:1,bottom:3}),"layout-inner-sw")},kg=function(t,n,e){return Ju(bg(t,n),yg(t),e.innerNortheast(),Zu(),ua(t,{right:0,top:2}),"layout-inner-ne")},Cg=function(t,n,e){return Ju(hg(t),yg(t),e.innerNorthwest(),Qu(),ua(t,{left:1,top:2}),"layout-inner-nw")},Og=function(t,n,e){return Ju(vg(t,n),yg(t),e.innerNorth(),ea(),ua(t,{top:2}),"layout-inner-n")},_g=function(t,n,e){return Ju(vg(t,n),xg(t,n),e.innerSouth(),oa(),ua(t,{bottom:3}),"layout-inner-s")},Tg=tinymce.util.Tools.resolve("tinymce.util.Delay"),Eg=lf({name:"Button",factory:function(t){var n=Xm(t.action),e=t.dom.tag,o=function(n){return Tt(t.dom,"attributes").bind((function(t){return Tt(t,n)}))};return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:dl(t.buttonBehaviours,[Dm.config({}),wm.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==e)return{role:o("role").getOr("button")};var t=o("type").getOr("button"),n=o("role").map((function(t){return{role:t}})).getOr({});return l({type:t},n)}()},eventOrder:t.eventOrder}},configFields:[Un("uid",void 0),Bn("dom"),Un("components",[]),fl("buttonBehaviours",[Dm,wm]),Pn("action"),Pn("role"),Un("eventOrder",{})]}),Bg=function(t){var n=void 0!==t.uid&&Bt(t,"uid")?t.uid:$r("memento");return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).toOptional()},asSpec:function(){return l(l({},t),{uid:n})}}},Ag=function(t){return w.from(t()["temporary-placeholder"]).getOr("!not found!")},Mg=function(t,n){return w.from(n()[t.toLowerCase()]).getOrThunk((function(){return Ag(n)}))},Dg={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},Fg=lf({name:"Notification",factory:function(t){var n,e,o=Bg({dom:{tag:"p",innerHtml:t.translationProvider(t.text)},behaviours:Da([_m.config({})])}),r=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},i=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},u=Bg({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(0)]},i(0)],behaviours:Da([_m.config({})])}),a={updateProgress:function(t,n){t.getSystem().isConnected()&&u.getOpt(t).each((function(t){_m.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(n)]},i(n)])}))},updateText:function(t,n){var e;t.getSystem().isConnected()&&(e=o.get(t),_m.set(e,[ji(n)]))}},c=K([t.icon.toArray(),t.level.toArray(),t.level.bind((function(t){return w.from(Dg[t])})).toArray()]),s=Bg(Eg.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:Mg("close",t.iconProvider),attributes:{"aria-label":t.translationProvider("Close")}}}],action:function(n){t.onAction(n)}})),l=[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:(n=c,e=t.iconProvider,it(n,(function(t){return w.from(e()[t.toLowerCase()])})).getOrThunk((function(){return Ag(e)})))}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[o.asSpec()],behaviours:Da([_m.config({})])}];return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map((function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]})).getOr(["tox-notification","tox-notification--in"])},behaviours:Da([Dm.config({}),Tm("notification-events",[Go(Ze(),(function(t){s.getOpt(t).each(Dm.focus)}))])]),components:l.concat(t.progress?[u.asSpec()]:[]).concat(t.closeButton?[s.asSpec()]:[]),apis:a}},configFields:[Pn("level"),Bn("progress"),Bn("icon"),Bn("onAction"),Bn("text"),Bn("iconProvider"),Bn("translationProvider"),qn("closeButton",!0)],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}});var Ig,Rg,Vg=function(t,n){var e=null;return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},throttle:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];null!==e&&clearTimeout(e),e=setTimeout((function(){t.apply(null,o),e=null}),n)}}},Pg=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),Hg=function(t,n,e,o,r){var i=Pg(t,(function(n){return o=n,(e=t).isBlock(o)||P(["BR","IMG","HR","INPUT"],o.nodeName)||"false"===e.getContentEditable(o);var e,o}));return w.from(i.backwards(n,e,o,r))},zg=function(t,n){return Ng(re(t.selection.getNode())).getOrThunk((function(){var e=ne('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc());return Tr(e,re(n.extractContents())),n.insertNode(e.dom),dr(e).each((function(t){return t.dom.normalize()})),function(t,n){var e=function(t){for(var o=pr(t),r=o.length-1;0<=r;r--){var i=o[r];if(n(i))return w.some(i);var u=e(i);if(u.isSome())return u}return w.none()};return e(t)}(e,Xc).map((function(n){var e;t.selection.setCursorLocation(n.dom,"img"===er(e=n)?1:Wc(e).fold((function(){return pr(e).length}),(function(t){return t.length})))})),e}))},Ng=function(t){return Tu(t,"[data-mce-autocompleter]")},Lg=function(t){return t.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},jg=function(t){return""!==t&&-1!=="  \f\n\r\t\v".indexOf(t)},Ug=function(t,n){return t.substring(n.length)},Wg=function(t,n,e,o){return void 0===o&&(o=0),Ng(re(n.startContainer)).fold((function(){return function(t,n,e,o){if(void 0===o&&(o=0),!(r=n).collapsed||3!==r.startContainer.nodeType)return w.none();var r,i=t.getParent(n.startContainer,t.isBlock)||t.getRoot();return Hg(t,n.startContainer,n.startOffset,(function(t,n,o){return function(t,n,e){for(var o=n-1;0<=o;o--){var r=t.charAt(o);if(jg(r))return w.none();if(r===e)break}return w.some(o)}(o,n,e).getOr(n)}),i).bind((function(t){var r=n.cloneRange();if(r.setStart(t.container,t.offset),r.setEnd(n.endContainer,n.endOffset),r.collapsed)return w.none();var i=Lg(r);return 0!==i.lastIndexOf(e)||Ug(i,e).length<o?w.none():w.some({text:Ug(i,e),range:r,triggerChar:e})}))}(t,n,e,o)}),(function(n){var o=t.createRng();o.selectNode(n.dom);var r=Lg(o);return w.some({range:o,text:Ug(r,e),triggerChar:e})}))},Gg=tinymce.util.Tools.resolve("tinymce.util.Promise"),Xg=function(t,n){return{container:t,offset:n}},Yg=function(t){if(3===t.nodeType)return Xg(t,t.data.length);var n=t.childNodes;return 0<n.length?Yg(n[n.length-1]):Xg(t,n.length)},qg=function(t,n){var e=t.childNodes;return 0<e.length&&n<e.length?qg(e[n],0):0<e.length&&1===t.nodeType&&e.length===n?Yg(e[e.length-1]):Xg(t,n)},Kg=function(t,n,e,o){void 0===o&&(o={});var r=n(),i=t.selection.getRng().startContainer.nodeValue,u=W(r.lookupByChar(e.triggerChar),(function(n){return e.text.length>=n.minChars&&n.matches.getOrThunk((function(){return function(t){return function(n){var e,o,r=qg(n.startContainer,n.startOffset);return!Hg(e=t,(o=r).container,o.offset,(function(t,n){return 0===n?-1:n}),e.getRoot()).filter((function(t){var n=t.container.data.charAt(t.offset-1);return!jg(n)})).isSome()}}(t.dom)}))(e.range,i,e.text)}));if(0===u.length)return w.none();var a=Gg.all(L(u,(function(t){return t.fetch(e.text,t.maxResults,o).then((function(n){return{matchText:e.text,items:n,columns:t.columns,onAction:t.onAction,highlightOn:t.highlightOn}}))})));return w.some({lookupData:a,context:e})},Jg=tn([Mn("type"),Nn("text")]),$g=tn([Un("type","autocompleteitem"),Un("active",!1),Un("disabled",!1),Un("meta",{}),Mn("value"),Nn("text"),Nn("icon")]),Qg=tn([Mn("type"),Mn("ch"),Gn("minChars",1),Un("columns",1),Gn("maxResults",10),Ln("matches"),Fn("fetch"),Fn("onAction"),Jn("highlightOn",[],kn)]),Zg=[qn("disabled",!1),Nn("tooltip"),Nn("icon"),Nn("text"),Kn("onSetup",(function(){return t}))],tp=tn([Mn("type"),Fn("onAction")].concat(Zg)),np=function(t){return gn("toolbarbutton",tp,t)},ep=[qn("active",!1)].concat(Zg),op=tn(ep.concat([Mn("type"),Fn("onAction")])),rp=function(t){return gn("ToggleButton",op,t)},ip=[Kn("predicate",a),Yn("scope","node",["node","editor"]),Yn("position","selection",["node","selection","line"])],up=Zg.concat([Un("type","contextformbutton"),Un("primary",!1),Fn("onAction"),Qn("original",o)]),ap=ep.concat([Un("type","contextformbutton"),Un("primary",!1),Fn("onAction"),Qn("original",o)]),cp=Zg.concat([Un("type","contextformbutton")]),sp=ep.concat([Un("type","contextformtogglebutton")]),lp=yn("type",{contextformbutton:up,contextformtogglebutton:ap}),fp=tn([Un("type","contextform"),Kn("initValue",(function(){return""})),Nn("label"),Vn("commands",lp),Hn("launch",yn("type",{contextformbutton:cp,contextformtogglebutton:sp}))].concat(ip)),dp=tn([Un("type","contexttoolbar"),Mn("items")].concat(ip));(Rg=Ig=Ig||{})[Rg.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",Rg[Rg.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var mp,gp,pp=Ig,hp="tox-menu-nav__js",vp="tox-collection__item",bp="tox-swatch",yp={normal:hp,color:bp},xp="tox-collection__item--enabled",wp="tox-collection__item-label",Sp="tox-collection__item-caret",kp="tox-collection__item--active",Cp="tox-collection__item-container",Op="tox-collection__item-container--row",_p=function(t){return Tt(yp,t).getOr(hp)},Tp=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:"color"===t?"tox-swatches":"tox-menu",tieredMenu:"tox-tiered-menu"}},Ep=function(t){var n=Tp(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:_p(t)}},Bp=[cg.parts.items({})],Ap=function(t,n,e){var o=Tp(e);return{dom:{tag:"div",classes:K([[o.tieredMenu]])},markers:Ep(e)}},Mp=function(t,n){return function(e){var o=N(e,n);return L(o,(function(n){return{dom:t,components:n}}))}},Dp=function(t,n){var e=[],o=[];return j(t,(function(t,r){n(t,r)?(0<o.length&&e.push(o),o=[],Et(t.dom,"innerHtml")&&o.push(t)):o.push(t)})),0<o.length&&e.push(o),L(e,(function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}}))},Fp=function(t,n,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===t?["tox-collection--list"]:["tox-collection--grid"])},components:[cg.parts.items({preprocess:function(e){return"auto"!==t&&1<t?Mp({tag:"div",classes:["tox-collection__group"]},t)(e):Dp(e,(function(t,e){return"separator"===n[e].type}))}})]}},Ip=function(t){return H(t,(function(t){return"icon"in t&&void 0!==t.icon}))},Rp=function(t){return console.error(vn(t)),console.log(t),w.none()},Vp=function(t,n,e,o,r){var i,u=(i=e,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[cg.parts.items({preprocess:function(t){return Dp(t,(function(t,n){return"separator"===i[n].type}))}})]});return{value:t,dom:u.dom,components:u.components,items:e}},Pp=function(t,n,e,r,i){var u,a,c,s,l,f;return"color"===i?{value:t,dom:(u=r,c={dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[cg.parts.items({preprocess:"auto"!==u?Mp({tag:"div",classes:["tox-swatches__row"]},u):o})]}]}).dom,components:c.components,items:e}:"normal"===i&&"auto"===r?{value:t,dom:(c=Fp(r,e)).dom,components:c.components,items:e}:"normal"===i&&1===r?{value:t,dom:(c=Fp(1,e)).dom,components:c.components,items:e}:"normal"===i?{value:t,dom:(c=Fp(r,e)).dom,components:c.components,items:e}:"listpreview"!==i||"auto"===r?{value:t,dom:(s=n,l=r,f=Tp(i),{tag:"div",classes:K([[f.menu,"tox-menu-"+l+"-column"],s?[f.hasIcons]:[]])}),components:Bp,items:e}:{value:t,dom:(a=r,c={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[cg.parts.items({preprocess:Mp({tag:"div",classes:["tox-collection__group"]},a)})]}).dom,components:c.components,items:e}},Hp=[Mn("type"),Mn("src"),Nn("alt"),Jn("classes",[],kn)],zp=tn(Hp),Np=[Mn("type"),Mn("text"),Nn("name"),Jn("classes",["tox-collection__item-label"],kn)],Lp=tn(Np),jp=fn((function(){return bn("type",{cardimage:zp,cardtext:Lp,cardcontainer:Up})})),Up=tn([Mn("type"),Xn("direction","horizontal"),Xn("align","left"),Xn("valign","middle"),Vn("items",jp)]),Wp=[qn("disabled",!1),Nn("text"),Nn("shortcut"),an("value","value",Nt((function(){return Wr("menuitem-value")})),xn()),Un("meta",{})],Gp=tn([Mn("type"),Nn("label"),Vn("items",jp),Kn("onSetup",(function(){return t})),Kn("onAction",t)].concat(Wp)),Xp=tn([Mn("type"),qn("active",!1),Nn("icon")].concat(Wp)),Yp=tn([Mn("type"),Dn("fancytype",["inserttable","colorswatch"]),Kn("onAction",t)]),qp=tn([Mn("type"),Kn("onSetup",(function(){return t})),Kn("onAction",t),Nn("icon")].concat(Wp)),Kp=tn([Mn("type"),Fn("getSubmenuItems"),Kn("onSetup",(function(){return t})),Nn("icon")].concat(Wp)),Jp=tn([Mn("type"),Nn("icon"),qn("active",!1),Kn("onSetup",(function(){return t})),Fn("onAction")].concat(Wp)),$p=function(t,n,e){var o=Yc(t.element,"."+e);if(0<o.length){var r=q(o,(function(t){var e=t.dom.getBoundingClientRect().top,r=o[0].dom.getBoundingClientRect().top;return Math.abs(e-r)>n})).getOr(o.length);return w.some({numColumns:r,numRows:Math.ceil(o.length/r)})}return w.none()},Qp=function(t){return function(t,n){return Da([Tm(t,n)])}(Wr("unnamed-events"),t)},Zp=Wr("tooltip.exclusive"),th=Wr("tooltip.show"),nh=Wr("tooltip.hide"),eh=function(t,n,e){t.getSystem().broadcastOn([Zp],{})},oh=Object.freeze({__proto__:null,hideAllExclusive:eh,setComponents:function(t,n,e,o){e.getTooltip().each((function(t){t.getSystem().isConnected()&&_m.set(t,o)}))}}),rh=Object.freeze({__proto__:null,events:function(t,n){var e=function(e){n.getTooltip().each((function(o){Ts(o),t.onHide(e,o),n.clearTooltip()})),n.clearTimer()};return jo(K([[Go(th,(function(e){n.resetTimer((function(){var o,r,i;o=e,n.isShowing()||(eh(o),r=t.lazySink(o).getOrDie(),i=o.getSystem().build({dom:t.tooltipDom,components:t.tooltipComponents,events:jo("normal"===t.mode?[Go(Qe(),(function(t){Vo(o,th)})),Go(Je(),(function(t){Vo(o,nh)}))]:[]),behaviours:Da([_m.config({})])}),n.setTooltip(i),Cs(r,i),t.onShow(o,i),ys.position(r,t.anchor(o),i))}),t.delay)})),Go(nh,(function(o){n.resetTimer((function(){e(o)}),t.delay)})),Go(go(),(function(t,n){n.universal||P(n.channels,Zp)&&e(t)})),Zo((function(t){e(t)}))],"normal"===t.mode?[Go(Ze(),(function(t){Vo(t,th)})),Go(fo(),(function(t){Vo(t,nh)})),Go(Qe(),(function(t){Vo(t,th)})),Go(Je(),(function(t){Vo(t,nh)}))]:[Go(Io(),(function(t,n){Vo(t,th)})),Go(Ro(),(function(t){Vo(t,nh)}))]]))}}),ih=[Bn("lazySink"),Bn("tooltipDom"),Un("exclusive",!0),Un("tooltipComponents",[]),Un("delay",300),Yn("mode","normal",["normal","follow-highlight"]),Un("anchor",(function(t){return{anchor:"hotspot",hotspot:t,layouts:{onLtr:e([ba,va,ma,pa,ga,ha]),onRtl:e([ba,va,ma,pa,ga,ha])}}})),Uu("onHide"),Uu("onShow")],uh=Ia({fields:ih,name:"tooltipping",active:rh,state:Object.freeze({__proto__:null,init:function(){var t=Zn(w.none()),n=Zn(w.none()),o=function(){t.get().each((function(t){clearTimeout(t)}))},r=e("not-implemented");return ai({getTooltip:function(){return n.get()},isShowing:function(){return n.get().isSome()},setTooltip:function(t){n.set(w.some(t))},clearTooltip:function(){n.set(w.none())},clearTimer:o,resetTimer:function(n,e){o(),t.set(w.some(setTimeout((function(){n()}),e)))},readState:r})}}),apis:oh}),ah=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),ch=tinymce.util.Tools.resolve("tinymce.util.I18n"),sh=["input","button","textarea","select"],lh=function(t,n,e){(n.disabled()?hh:vh)(t,n)},fh=function(t,n){return!0===n.useNative&&P(sh,er(t.element))},dh=function(t){Rr(t.element,"disabled","disabled")},mh=function(t){zr(t.element,"disabled")},gh=function(t){Rr(t.element,"aria-disabled","true")},ph=function(t){Rr(t.element,"aria-disabled","false")},hh=function(t,n,e){n.disableClass.each((function(n){vi(t.element,n)})),(fh(t,n)?dh:gh)(t),n.onDisabled(t)},vh=function(t,n,e){n.disableClass.each((function(n){bi(t.element,n)})),(fh(t,n)?mh:ph)(t),n.onEnabled(t)},bh=function(t,n){return fh(t,n)?Hr(t.element,"disabled"):"true"===Vr(t.element,"aria-disabled")},yh=Object.freeze({__proto__:null,enable:vh,disable:hh,isDisabled:bh,onLoad:lh,set:function(t,n,e,o){(o?hh:vh)(t,n)}}),xh=Object.freeze({__proto__:null,exhibit:function(t,n){return si({classes:n.disabled()?n.disableClass.toArray():[]})},events:function(t,n){return jo([Uo(po(),(function(n,e){return bh(n,t)})),Ba(t,n,lh)])}}),wh=[Kn("disabled",a),Un("useNative",!0),Pn("disableClass"),Uu("onDisabled"),Uu("onEnabled")],Sh=Ia({fields:wh,name:"disabling",active:xh,apis:yh}),kh=tinymce.util.Tools.resolve("tinymce.EditorManager"),Ch=function(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))},Oh=function(t){return t.getParam("width",ah.DOM.getStyle(t.getElement(),"width"))},_h=function(t){return w.from(t.getParam("min_width")).filter(M)},Th=function(t){return w.from(t.getParam("min_height")).filter(M)},Eh=function(t){return w.from(t.getParam("max_width")).filter(M)},Bh=function(t){return w.from(t.getParam("max_height")).filter(M)},Ah=function(t){return!1!==t.getParam("menubar",!0,"boolean")},Mh=function(t){var n=t.getParam("toolbar",!0),e=!0===n,o=C(n),r=_(n)&&0<n.length;return!Fh(t)&&(r||o||e)},Dh=function(t){var n=z(9,(function(n){return t.getParam("toolbar"+(n+1),!1,"string")})),e=W(n,(function(t){return"string"==typeof t}));return 0<e.length?w.some(e):w.none()},Fh=function(t){return Dh(t).fold((function(){return 0<t.getParam("toolbar",[],"string[]").length}),c)};(gp=mp=mp||{}).default="wrap",gp.floating="floating",gp.sliding="sliding",gp.scrolling="scrolling";var Ih,Rh,Vh=function(t){return t.getParam("toolbar_mode","","string")};(Rh=Ih=Ih||{}).auto="auto",Rh.top="top",Rh.bottom="bottom";var Ph,Hh,zh,Nh=function(t){return t.getParam("toolbar_location",Ih.auto,"string")},Lh=function(t){return Nh(t)===Ih.bottom},jh=function(t){var n=t.getParam("fixed_toolbar_container","","string");return 0<n.length&&t.inline?_u(Ci(),n):w.none()},Uh=function(t){return t.inline&&jh(t).isSome()},Wh=function(t){return jh(t).getOrThunk((function(){return wr(xr(re(t.getElement())))}))},Gh=function(t){return t.inline&&!Ah(t)&&!Mh(t)&&!Fh(t)},Xh=function(t){return(t.getParam("toolbar_sticky",!1,"boolean")||t.inline)&&!Uh(t)&&!Gh(t)},Yh="silver.readonly",qh=tn([An("readonly",Cn)]),Kh=function(t,n){var e=t.outerContainer.element;n&&(t.mothership.broadcastOn([js()],{target:e}),t.uiMothership.broadcastOn([js()],{target:e})),t.mothership.broadcastOn([Yh],{readonly:n}),t.uiMothership.broadcastOn([Yh],{readonly:n})},Jh=function(t,n){t.on("init",(function(){t.mode.isReadOnly()&&Kh(n,!0)})),t.on("SwitchMode",(function(){return Kh(n,t.mode.isReadOnly())})),t.getParam("readonly",!1,"boolean")&&t.setMode("readonly")},$h=function(){var t;return Ha.config({channels:((t={})[Yh]={schema:qh,onReceive:function(t,n){Sh.set(t,n.readonly)}},t)})},Qh=function(t){return Sh.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})},Zh=function(t){return Sh.config({disabled:t})},tv=function(t){return Sh.config({disabled:t,disableClass:"tox-tbtn--disabled"})},nv=function(t){return Sh.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},ev=function(t,n){var e=t.getApi(n);return function(t){t(e)}},ov=function(t,n){return Qo((function(e){ev(t,e)((function(e){var o=t.onSetup(e);A(o)&&n.set(o)}))}))},rv=function(t,n){return Zo((function(e){return ev(t,e)(n.get())}))},iv=((Ph={})[po()]=["disabling","alloy.base.behaviour","toggling","item-events"],Ph),uv=function(t){return J(t,(function(t){return t.toArray()}))},av=function(n,e,o,r){var i,u,a=Zn(t);return{type:"item",dom:e.dom,components:uv(e.optComponents),data:n.data,eventOrder:iv,hasSubmenu:n.triggersSubmenu,itemBehaviours:Da([Tm("item-events",[(i=n,u=o,nr((function(t,n){ev(i,t)(i.onAction),i.triggersSubmenu||u!==pp.CLOSE_ON_EXECUTE||(t.getSystem().isConnected()&&Vo(t,yo()),n.stop())}))),ov(n,a),rv(n,a)]),Qh((function(){return n.disabled||r.isDisabled()})),$h(),_m.config({})].concat(n.itemBehaviours))}},cv=function(t){return{value:t.value,meta:l({text:t.text.getOr("")},t.meta)}},sv=tinymce.util.Tools.resolve("tinymce.Env"),lv=function(t){return{dom:{tag:"div",classes:["tox-collection__item-icon"],innerHtml:t}}},fv=function(t){return{dom:{tag:"div",classes:[wp]},components:[ji(ch.translate(t))]}},dv=function(t,n){return{dom:{tag:"div",classes:n,innerHtml:t}}},mv=function(t,n){return{dom:{tag:"div",classes:[wp]},components:[{dom:{tag:t.tag,styles:t.styles},components:[ji(ch.translate(n))]}]}},gv=function(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:(n=t,e=sv.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},o=n.split("+"),r=L(o,(function(t){var n=t.toLowerCase().trim();return Et(e,n)?e[n]:t})),sv.mac?r.join(""):r.join("+"))}};var n,e,o,r},pv=function(t){return{dom:{tag:"div",classes:["tox-collection__item-checkmark"],innerHtml:Mg("checkmark",t)}}},hv=function(t,n){var e=n.map((function(t){return{attributes:{title:ch.translate(t)}}})).getOr({});return l({tag:"div",classes:[hp,vp].concat(t?["tox-collection__item-icon-rtl"]:[])},e)},vv=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],bv=["list-bull-circle","list-bull-default","list-bull-square"],yv=function(t,n,e,o){void 0===o&&(o=w.none());var i,u,a,c,s,f,m,g,p,h,v,b=ch.isRtl()&&t.iconContent.exists((function(t){return P(bv,t)})),y=t.iconContent.map((function(t){return ch.isRtl()&&P(vv,t)?t+"-rtl":t})).map((function(t){return e=t,r=n.icons,i=o,w.from(r()[e.toLowerCase()]).or(i).getOrThunk((function(){return Ag(r)}));var e,r,i})),x=w.from(t.meta).fold((function(){return fv}),(function(t){return Et(t,"style")?r(mv,t.style):fv}));return"color"===t.presets?(m=t.ariaLabel,g=t.value,p=n,{dom:(h=y.getOr(""),v={tag:"div",attributes:m.map((function(t){return{title:p.translate(t)}})).getOr({}),classes:["tox-swatch"]},l(l({},v),"custom"===g?{tag:"button",classes:d(v.classes,["tox-swatches__picker-btn"]),innerHtml:h}:"remove"===g?{classes:d(v.classes,["tox-swatch--remove"]),innerHtml:h}:{attributes:l(l({},v.attributes),{"data-mce-color":g}),styles:{"background-color":g}})),optComponents:[]}):(i=t,u=x,a=b,c=e?y.or(w.some("")).map(lv):w.none(),s=i.checkMark,f=i.htmlContent.fold((function(){return i.textContent.map(u)}),(function(t){return w.some(dv(t,[wp]))})),{dom:hv(a,i.ariaLabel),optComponents:[c,f,i.shortcutContent.map(gv),s,i.caret]})},xv=function(t,n){return Tt(t,"tooltipWorker").map((function(t){return[uh.config({lazySink:n.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{anchor:"submenu",item:t,overrides:{maxHeightFunction:rc}}},mode:"follow-highlight",onShow:function(n,e){t((function(t){uh.setComponents(n,[Ui({element:re(t)})])}))}})]})).getOr([])},wv=function(t,n){var e,o=(e=ch.translate(t),ah.DOM.encode(e));if(0<n.length){var r=new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");return o.replace(r,(function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"}))}return o},Sv=function(t,n){return L(t,(function(t){switch(t.type){case"cardcontainer":return i=Sv((r=t).items,n),u="vertical"===r.direction?"tox-collection__item-container--column":Op,a="left"===r.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right",{dom:{tag:"div",classes:[Cp,u,a,function(){switch(r.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}}()]},components:i};case"cardimage":return o=t.src,{dom:{tag:"img",classes:t.classes,attributes:{src:o,alt:t.alt.getOr("")}}};case"cardtext":var e=t.name.exists((function(t){return P(n.cardText.highlightOn,t)}))?w.from(n.cardText.matchText).getOr(""):"";return dv(wv(t.text,e),t.classes)}var o,r,i,u,a}))},kv=jl(ng(),eg()),Cv=function(t){return{value:t}},Ov=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,_v=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Tv=function(t){return Ov.test(t)||_v.test(t)},Ev=function(t){var n=t.toString(16);return 1===n.length?"0"+n:n},Bv=function(t){var n=Ev(t.red)+Ev(t.green)+Ev(t.blue);return Cv(n)},Av=Math.min,Mv=Math.max,Dv=Math.round,Fv=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,Iv=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,Rv=function(t,n,e,o){return{red:t,green:n,blue:e,alpha:o}},Vv=function(t){var n=parseInt(t,10);return n.toString()===t&&0<=n&&n<=255},Pv=function(t){var n,e,o,r=(t.hue||0)%360,i=t.saturation/100,u=t.value/100;i=Mv(0,Av(i,1)),u=Mv(0,Av(u,1));if(0===i)return n=e=o=Dv(255*u),Rv(n,e,o,1);var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),l=u-c;switch(Math.floor(a)){case 0:n=c,e=s,o=0;break;case 1:n=s,e=c,o=0;break;case 2:n=0,e=c,o=s;break;case 3:n=0,e=s,o=c;break;case 4:n=s,e=0,o=c;break;case 5:n=c,e=0,o=s;break;default:n=e=o=0}return n=Dv(255*(n+l)),e=Dv(255*(e+l)),o=Dv(255*(o+l)),Rv(n,e,o,1)},Hv=function(t){var n=function(t){var n={value:t.value.replace(Ov,(function(t,n,e,o){return n+n+e+e+o+o}))},e=_v.exec(n.value);return null===e?["FFFFFF","FF","FF","FF"]:e}(t),e=parseInt(n[1],16),o=parseInt(n[2],16),r=parseInt(n[3],16);return Rv(e,o,r,1)},zv=function(t,n,e,o){var r=parseInt(t,10),i=parseInt(n,10),u=parseInt(e,10),a=parseFloat(o);return Rv(r,i,u,a)},Nv=function(t){return"rgba("+t.red+","+t.green+","+t.blue+","+t.alpha+")"},Lv=Rv(255,0,0,1),jv=function(t,n){return t.fire("ResizeContent",n)},Uv=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),Wv="tinymce-custom-colors",Gv="choiceitem",Xv=[{type:Gv,text:"Light Green",value:"#BFEDD2"},{type:Gv,text:"Light Yellow",value:"#FBEEB8"},{type:Gv,text:"Light Red",value:"#F8CAC6"},{type:Gv,text:"Light Purple",value:"#ECCAFA"},{type:Gv,text:"Light Blue",value:"#C2E0F4"},{type:Gv,text:"Green",value:"#2DC26B"},{type:Gv,text:"Yellow",value:"#F1C40F"},{type:Gv,text:"Red",value:"#E03E2D"},{type:Gv,text:"Purple",value:"#B96AD9"},{type:Gv,text:"Blue",value:"#3598DB"},{type:Gv,text:"Dark Turquoise",value:"#169179"},{type:Gv,text:"Orange",value:"#E67E23"},{type:Gv,text:"Dark Red",value:"#BA372A"},{type:Gv,text:"Dark Purple",value:"#843FA1"},{type:Gv,text:"Dark Blue",value:"#236FA1"},{type:Gv,text:"Light Gray",value:"#ECF0F1"},{type:Gv,text:"Medium Gray",value:"#CED4D9"},{type:Gv,text:"Gray",value:"#95A5A6"},{type:Gv,text:"Dark Gray",value:"#7E8C8D"},{type:Gv,text:"Navy Blue",value:"#34495E"},{type:Gv,text:"Black",value:"#000000"},{type:Gv,text:"White",value:"#ffffff"}],Yv=function(t){void 0===t&&(t=10);var n,e=Uv.getItem(Wv),o=C(e)?JSON.parse(e):[],r=t-(n=o).length<0?n.slice(0,t):n,i=function(t){r.splice(t,1)};return{add:function(n){var e;(-1===(e=V(r,n))?w.none():w.some(e)).each(i),r.unshift(n),r.length>t&&r.pop(),Uv.setItem(Wv,JSON.stringify(r))},state:function(){return r.slice(0)}}}(10),qv=function(t){return!1!==t.getParam("custom_colors")},Kv=function(t){var n=t.getParam("color_map");return void 0!==n?function(t){var n=[],e=document.createElement("canvas");e.height=1,e.width=1;for(var o=e.getContext("2d"),r=function(t,n){var e=n/255;return("0"+Math.round(t*e+255*(1-e)).toString(16)).slice(-2).toUpperCase()},i=0;i<t.length;i+=2)n.push({text:t[i+1],value:function(t){if(/^[0-9A-Fa-f]{6}$/.test(t))return"#"+t.toUpperCase();o.clearRect(0,0,e.width,e.height),o.fillStyle="#FFFFFF",o.fillStyle=t,o.fillRect(0,0,1,1);var n=o.getImageData(0,0,1,1).data,i=n[0],u=n[1],a=n[2],c=n[3];return"#"+r(i,c)+r(u,c)+r(a,c)}(t[i]),type:"choiceitem"});return n}(n):Xv},Jv=function(t){Yv.add(t)},$v=function(t){var n,e;return e=(n=Kv(t).length,Math.max(5,Math.ceil(Math.sqrt(n)))),t.getParam("color_cols",e,"number")},Qv=function(t,n,e,o){"custom"===e?rb(t)((function(e){e.each((function(e){Jv(e),t.execCommand("mceApplyTextcolor",n,e),o(e)}))}),"#000000"):"remove"===e?(o(""),t.execCommand("mceRemoveTextcolor",n)):(o(e),t.execCommand("mceApplyTextcolor",n,e))},Zv=function(t,n){return t.concat(L(Yv.state(),(function(t){return{type:Gv,text:t,value:t}})).concat((e={type:"choiceitem",text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},n?[e,{type:"choiceitem",text:"Custom color",icon:"color-picker",value:"custom"}]:[e])));var e},tb=function(t,n){return function(e){e(Zv(t,n))}},nb=function(t,n,e){var o,r;o="forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",r=e,t.setIconFill(o,r),t.setIconStroke(o,r)},eb=function(n,e,o,r,i){n.ui.registry.addSplitButton(e,{tooltip:r,presets:"color",icon:"forecolor"===e?"text-color":"highlight-bg-color",select:function(t){var e,r,i;return w.from((r=o,(e=n).dom.getParents(e.selection.getStart(),(function(t){var n;(n=t.style["forecolor"===r?"color":"background-color"])&&(i=i||n)})),i)).bind((function(n){return function(t){if("transparent"===t)return w.some(Rv(0,0,0,0));var n=Fv.exec(t);if(null!==n)return w.some(zv(n[1],n[2],n[3],"1"));var e=Iv.exec(t);return null!==e?w.some(zv(e[1],e[2],e[3],e[4])):w.none()}(n).map((function(n){var e=Bv(n).value;return le(t.toLowerCase(),e)}))})).getOr(!1)},columns:$v(n),fetch:tb(Kv(n),qv(n)),onAction:function(e){null!==i.get()&&Qv(n,o,i.get(),t)},onItemAction:function(t,r){Qv(n,o,r,(function(t){var o;i.set(t),o={name:e,color:t},n.fire("TextColorChange",o)}))},onSetup:function(t){null!==i.get()&&nb(t,e,i.get());var o=function(n){n.name===e&&nb(t,n.name,n.color)};return n.on("TextColorChange",o),function(){n.off("TextColorChange",o)}}})},ob=function(n,e,o,r){n.ui.registry.addNestedMenuItem(e,{text:r,icon:"forecolor"===e?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(e){Qv(n,o,e.value,t)}}]}})},rb=function(n){return function(e,o){var r,i={colorpicker:o},u=(r=e,function(t){var n=t.getData();r(w.from(n.colorpicker)),t.close()});n.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:i,onAction:function(t,n){"hex-valid"===n.name&&(n.value?t.enable("ok"):t.disable("ok"))},onSubmit:u,onClose:t,onCancel:function(){e(w.none())}})}},ib=function(t,n,e,o,r,i,u,a){var c=Ip(n),s=ub(n,e,o,"color"!==r?"normal":"color",i,u,a);return Pp(t,c,s,o,r)},ub=function(n,e,o,r,i,u,a){return df(L(n,(function(c){return"choiceitem"===c.type?gn("choicemenuitem",Xp,c).fold(Rp,(function(s){return w.some(function(n,e,o,r,i,u,a,c){void 0===c&&(c=!0);var s=yv({presets:o,textContent:e?n.text:w.none(),htmlContent:w.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:e?n.shortcut:w.none(),checkMark:e?w.some(pv(a.icons)):w.none(),caret:w.none(),value:n.value},a,c);return Ft(av({data:cv(n),disabled:n.disabled,getApi:function(t){return{setActive:function(n){Wm.set(t,n)},isActive:function(){return Wm.isOn(t)},isDisabled:function(){return Sh.isDisabled(t)},setDisabled:function(n){return Sh.set(t,n)}}},onAction:function(t){return r(n.value)},onSetup:function(n){return n.setActive(i),t},triggersSubmenu:!1,itemBehaviours:[]},s,u,a),{toggling:{toggleClass:xp,toggleOnExecute:!1,selected:n.active}})}(s,1===o,r,e,u(c.value),i,a,Ip(n)))})):w.none()})))},ab=function(t,n){var e=Ep(n);return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group")}},cb=Wr("cell-over"),sb=Wr("cell-execute"),lb={inserttable:function(t){var n=Wr("size-label"),e=function(t,n,e){for(var o=[],r=0;r<n;r++){for(var i=[],u=0;u<e;u++)i.push(function(t,n,e){var o,r=function(e){return Po(e,sb,{row:t,col:n})},i=function(t,n){n.stop(),r(t)};return Gi({dom:{tag:"div",attributes:((o={role:"button"})["aria-labelledby"]=e,o)},behaviours:Da([Tm("insert-table-picker-cell",[Go(Qe(),Dm.focus),Go(po(),r),Go(io(),i),Go(vo(),i)]),Wm.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),Dm.config({onFocus:function(e){return Po(e,cb,{row:t,col:n})}})])})}(r,u,t));o.push(i)}return o}(n,10,10),o=Bg({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:n}},components:[ji("0x0")],behaviours:Da([_m.config({})])});return{type:"widget",data:{value:Wr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[kv.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:J(e,(function(t){return L(t,Xi)})).concat(o.asSpec()),behaviours:Da([Tm("insert-table-picker",[Ko(cb,(function(t,n,r){var i=r.event.row,u=r.event.col;!function(t,n,e,o,r){for(var i=0;i<10;i++)for(var u=0;u<10;u++)Wm.set(t[i][u],i<=n&&u<=e)}(e,i,u),_m.set(o.get(t),[ji(u+1+"x"+(i+1))])})),Ko(sb,(function(n,e,o){t.onAction({numRows:o.event.row+1,numColumns:o.event.col+1}),Vo(n,yo())}))]),wm.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(t,n){var e=Zv(n.colorinput.getColors(),n.colorinput.hasCustomColors()),o=n.colorinput.getColorCols(),r=ib(Wr("menu-value"),e,(function(n){t.onAction({value:n})}),o,"color",pp.CLOSE_ON_EXECUTE,a,n.shared.providers),i=l(l({},r),{markers:Ep("color"),movement:ab(o,"color")});return{type:"widget",data:{value:Wr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[kv.widget(cg.sketch(i))]}}},fb=function(t){var n=t.text.fold((function(){return{}}),(function(t){return{innerHtml:t}}));return{type:"separator",dom:l({tag:"div",classes:[vp,"tox-collection__group-heading"]},n),components:[]}};(zh=Hh=Hh||{})[zh.ContentFocus=0]="ContentFocus",zh[zh.UiFocus=1]="UiFocus";var db,mb,gb,pb=function(n,e,o,r,i){var u=o.shared.providers,a=function(t){return i?l(l({},t),{shortcut:w.none(),icon:t.text.isSome()?w.none():t.icon}):t};switch(n.type){case"menuitem":return gn("menuitem",qp,n).fold(Rp,(function(t){return w.some(function(t,n,e,o){void 0===o&&(o=!0);var r=yv({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:w.none(),ariaLabel:t.text,caret:w.none(),checkMark:w.none(),shortcutContent:t.shortcut},e,o);return av({data:cv(t),getApi:function(t){return{isDisabled:function(){return Sh.isDisabled(t)},setDisabled:function(n){return Sh.set(t,n)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e)}(a(t),e,u,r))}));case"nestedmenuitem":return gn("nestedmenuitem",Kp,n).fold(Rp,(function(n){return w.some(function(n,e,o,r,i){void 0===r&&(r=!0),void 0===i&&(i=!1);var u,a,c=i?(a=o.icons,{dom:{tag:"div",classes:[Sp],innerHtml:Mg("chevron-down",a)}}):(u=o.icons,{dom:{tag:"div",classes:[Sp],innerHtml:Mg("chevron-right",u)}}),s=yv({presets:"normal",iconContent:n.icon,textContent:n.text,htmlContent:w.none(),ariaLabel:n.text,caret:w.some(c),checkMark:w.none(),shortcutContent:n.shortcut},o,r);return av({data:cv(n),getApi:function(t){return{isDisabled:function(){return Sh.isDisabled(t)},setDisabled:function(n){return Sh.set(t,n)}}},disabled:n.disabled,onAction:t,onSetup:n.onSetup,triggersSubmenu:!0,itemBehaviours:[]},s,e,o)}(a(n),e,u,r,i))}));case"togglemenuitem":return gn("togglemenuitem",Jp,n).fold(Rp,(function(t){return w.some(function(t,n,e,o){void 0===o&&(o=!0);var r=yv({iconContent:t.icon,textContent:t.text,htmlContent:w.none(),ariaLabel:t.text,checkMark:w.some(pv(e.icons)),caret:w.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,o);return Ft(av({data:cv(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){Wm.set(t,n)},isActive:function(){return Wm.isOn(t)},isDisabled:function(){return Sh.isDisabled(t)},setDisabled:function(n){return Sh.set(t,n)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e),{toggling:{toggleClass:xp,toggleOnExecute:!1,selected:t.active}})}(a(t),e,u,r))}));case"separator":return gn("separatormenuitem",Jg,n).fold(Rp,(function(t){return w.some(fb(t))}));case"fancymenuitem":return gn("fancymenuitem",Yp,n).fold(Rp,(function(t){return function(t,n){return e=lb,o=t.fancytype,(Object.prototype.hasOwnProperty.call(e,o)?w.some(e[o]):w.none()).map((function(e){return e(t,n)}));var e,o}(a(t),o)}));default:return console.error("Unknown item in general menu",n),w.none()}},hb=function(n,o,r,i,u,a,c){var s=1===i,f=!s||Ip(n);return df(L(n,(function(n){switch(n.type){case"separator":return gn("Autocompleter.Separator",Jg,n).fold(Rp,(function(t){return w.some(fb(t))}));case"cardmenuitem":return gn("cardmenuitem",Gp,n).fold(Rp,(function(t){return w.some(function(t,n,e,o){var r={dom:hv(!1,t.label),optComponents:[w.some({dom:{tag:"div",classes:[Cp,Op]},components:Sv(t.items,o)})]};return av({data:cv(l({text:w.none()},t)),disabled:t.disabled,getApi:function(t){return{isDisabled:function(){return Sh.isDisabled(t)},setDisabled:function(n){Sh.set(t,n),j(Yc(t.element,"*"),(function(e){t.getSystem().getByDom(e).each((function(t){t.hasConfigured(Sh)&&Sh.set(t,n)}))}))}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:w.from(o.itemBehaviours).getOr([])},r,n,e.providers)}(l(l({},t),{onAction:function(n){t.onAction(n),r(t.value,t.meta)}}),u,a,{itemBehaviours:xv(t.meta,a),cardText:{matchText:o,highlightOn:c}}))}));case"autocompleteitem":default:return gn("Autocompleter.Item",$g,n).fold(Rp,(function(n){return w.some(function(n,o,r,i,u,a,c,s){void 0===s&&(s=!0);var l=yv({presets:i,textContent:w.none(),htmlContent:r?n.text.map((function(t){return wv(t,o)})):w.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:w.none(),checkMark:w.none(),caret:w.none(),value:n.value},c.providers,s,n.icon);return av({data:cv(n),disabled:n.disabled,getApi:e({}),onAction:function(t){return u(n.value,n.meta)},onSetup:e(t),triggersSubmenu:!1,itemBehaviours:xv(n.meta,c)},l,a,c.providers)}(n,o,s,"normal",r,u,a,f))}))}})))},vb=function(t,n,e,o,r){var i=Ip(n),u=df(L(n,(function(t){var n=function(t){return pb(t,e,o,r?!t.hasOwnProperty("text"):i,r)};return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?n(l(l({},t),{disabled:!0})):n(t)})));return(r?Vp:Pp)(t,i,u,1,"normal")},bb=function(t){return gg.singleData(t.value,t)},yb=function(t,n){var e=Zn(w.none()),o=Zn(!1),r=Gi(pg.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:Da([Tm("dismissAutocompleter",[Go(Eo(),(function(){return a()}))])]),lazySink:n.getSink})),i=function(){return e.get().isSome()},u=function(){i()&&pg.hide(r)},a=function(){var n;i()&&(n=e.get().map((function(t){return t.element})),Ng(n.getOr(re(t.selection.getNode()))).each(Mr),u(),e.set(w.none()),o.set(!1))},c=Rt((function(){return function(t){var n,e,o=t.ui.registry.getAll().popups,r=St(o,(function(t){return gn("Autocompleter",Qg,t).fold((function(t){throw new Error(vn(t))}),(function(t){return t}))})),i=(n=Ct(r,(function(t){return t.ch})),e={},j(n,(function(t){e[t]={}})),yt(e)),u=_t(r);return{dataset:r,triggerChars:i,lookupByChar:function(t){return W(u,(function(n){return n.ch===t}))}}}(t)})),s=function(l){var f;f=l,e.get().map((function(n){return Wg(t.dom,t.selection.getRng(),n.triggerChar).bind((function(n){return Kg(t,c,n,f)}))})).getOrThunk((function(){return function(t,n){var e,o,r=n(),i=t.selection.getRng();return e=t.dom,o=i,it(r.triggerChars,(function(t){return Wg(e,o,t)})).bind((function(e){return Kg(t,n,e)}))}(t,c)})).fold(a,(function(c){var l,f;l=c.context,i()||(f=zg(t,l.range),e.set(w.some({triggerChar:l.triggerChar,element:f,matchLength:l.text.length})),o.set(!1)),c.lookupData.then((function(i){e.get().map((function(e){var l,f,d,m,g=c.context;e.triggerChar===g.triggerChar&&(f=g.triggerChar,m=it(d=i,(function(t){return w.from(t.columns)})).getOr(1),0<(l=J(d,(function(e){var r=e.items;return hb(r,e.matchText,(function(n,r){var i=t.selection.getRng();Wg(t.dom,i,f).fold((function(){return console.error("Lost context. Cursor probably moved")}),(function(t){var i=t.range,c={hide:function(){a()},reload:function(t){u(),s(t)}};o.set(!0),e.onAction(c,i,n,r),o.set(!1)}))}),m,pp.BUBBLE_TO_SANDBOX,n,e.highlightOn)}))).length?function(n,e,o,i){n.matchLength=e.text.length;var u,a,c,s,l,f,d,m=it(o,(function(t){return w.from(t.columns)})).getOr(1);pg.showAt(r,{anchor:"node",root:re(t.getBody()),node:w.from(n.element)},cg.sketch((u=Pp("autocompleter-value",!0,i,m,"normal"),a=m,s="normal",l=((c=Hh.ContentFocus)===Hh.ContentFocus?Kf:qf)(),f=ab(a,s),d=Ep(s),{dom:u.dom,components:u.components,items:u.items,value:u.value,markers:{selectedItem:d.selectedItem,item:d.item},movement:f,fakeFocus:c===Hh.ContentFocus,focusManager:l,menuBehaviours:Qp("auto"!==a?[]:[Qo((function(t,n){$p(t,4,d.item).each((function(n){var e=n.numColumns,o=n.numRows;wm.setGridSize(t,o,e)}))}))])}))),pg.getContent(r).each(Tf.highlightFirst)}(e,g,i,l):(10<=g.text.length-e.matchLength?a:u)())}))}))}))},l={onKeypress:Vg((function(t){27!==t.which&&s()}),50),cancelIfNecessary:a,isMenuOpen:function(){return pg.isOpen(r)},isActive:i,isProcessingAction:o.get,getView:function(){return pg.getContent(r)}};!1===t.hasPlugin("rtc")&&function(t,n){n.on("keypress compositionend",t.onKeypress.throttle),n.on("remove",t.onKeypress.cancel);var e=function(t,n){Po(t,no(),{raw:n})};n.on("keydown",(function(n){var o=function(){return t.getView().bind(Tf.getHighlighted)};8===n.which&&t.onKeypress.throttle(n),t.isActive()&&(27===n.which&&t.cancelIfNecessary(),t.isMenuOpen()?13===n.which?(o().each(Ho),n.preventDefault()):40===n.which?(o().fold((function(){t.getView().each(Tf.highlightFirst)}),(function(t){e(t,n)})),n.preventDefault(),n.stopImmediatePropagation()):37!==n.which&&38!==n.which&&39!==n.which||o().each((function(t){e(t,n),n.preventDefault(),n.stopImmediatePropagation()})):13!==n.which&&38!==n.which&&40!==n.which||t.cancelIfNecessary())})),n.on("NodeChange",(function(n){t.isActive()&&!t.isProcessingAction()&&Ng(re(n.element)).isNone()&&t.cancelIfNecessary()}))}(l,t)},xb=c,wb=function(t,n,e){return uu(t,n,xb,e,!1)},Sb=function(t,n,e){return uu(t,n,xb,e,!0)},kb=iu,Cb=function(t,n,e){return Tu(t,n,e).isSome()},Ob=function(t,n){var e=null;return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},schedule:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];e=setTimeout((function(){t.apply(null,o),e=null}),n)}}},_b=function(t){var n=t.raw;return void 0===n.touches||1!==n.touches.length?w.none():w.some(n.touches[0])},Tb=function(){return Fe().browser.isFirefox()},Eb=Zt([Fn("triggerEvent"),Un("stopBackspace",!0)]),Bb=function(t,n){var e,o,r,i,u=hn("Getting GUI events settings",Eb,n),a=function(t){var n=Zn(w.none()),e=Zn(!1),o=Ob((function(n){t.triggerEvent(bo(),n),e.set(!0)}),400),r=Wt([{key:We(),value:function(t){return _b(t).each((function(r){o.cancel();var i={x:r.clientX,y:r.clientY,target:t.target};o.schedule(t),e.set(!1),n.set(w.some(i))})),w.none()}},{key:Ge(),value:function(t){return o.cancel(),_b(t).each((function(t){n.get().each((function(e){var o,r,i,u;o=t,r=e,i=Math.abs(o.clientX-r.x),u=Math.abs(o.clientY-r.y),(5<i||5<u)&&n.set(w.none())}))})),w.none()}},{key:Xe(),value:function(r){return o.cancel(),n.get().filter((function(t){return Ve(t.target,r.target)})).map((function(n){return e.get()?(r.prevent(),!1):t.triggerEvent(vo(),r)}))}}]);return{fireIfReady:function(t,n){return Tt(r,n).bind((function(n){return n(t)}))}}}(u),c=L(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(n){return wb(t,n,(function(t){a.fireIfReady(t,n).each((function(n){n&&t.kill()})),u.triggerEvent(n,t)&&t.kill()}))})),s=Zn(w.none()),l=wb(t,"paste",(function(t){a.fireIfReady(t,"paste").each((function(n){n&&t.kill()})),u.triggerEvent("paste",t)&&t.kill(),s.set(w.some(setTimeout((function(){u.triggerEvent(mo(),t)}),0)))})),f=wb(t,"keydown",(function(t){var n;u.triggerEvent("keydown",t)?t.kill():!0!==u.stopBackspace||(n=t).raw.which!==Ef[0]||P(["input","textarea"],er(n.target))||Cb(n.target,'[contenteditable="true"]')||t.prevent()})),d=(e=t,o=function(t){u.triggerEvent("focusin",t)&&t.kill()},Tb()?Sb(e,"focus",o):wb(e,"focusin",o)),m=Zn(w.none()),g=(r=t,i=function(t){u.triggerEvent("focusout",t)&&t.kill(),m.set(w.some(setTimeout((function(){u.triggerEvent(fo(),t)}),0)))},Tb()?Sb(r,"blur",i):wb(r,"focusout",i));return{unbind:function(){j(c,(function(t){t.unbind()})),f.unbind(),d.unbind(),g.unbind(),l.unbind(),s.get().each(clearTimeout),m.get().each(clearTimeout)}}},Ab=function(t,n){var e=Tt(t,"target").getOr(n);return Zn(e)},Mb=At([{stopped:[]},{resume:["element"]},{complete:[]}]),Db=function(t,n,e,o,r,i){var u,a,c,s,l=t(n,o),f=(u=e,a=r,c=Zn(!1),s=Zn(!1),{stop:function(){c.set(!0)},cut:function(){s.set(!0)},isStopped:c.get,isCut:s.get,event:u,setSource:a.set,getSource:a.get});return l.fold((function(){return i.logEventNoHandlers(n,o),Mb.complete()}),(function(t){var e=t.descHandler;return li(e)(f),f.isStopped()?(i.logEventStopped(n,t.element,e.purpose),Mb.stopped()):f.isCut()?(i.logEventCut(n,t.element,e.purpose),Mb.complete()):dr(t.element).fold((function(){return i.logNoParent(n,t.element,e.purpose),Mb.complete()}),(function(o){return i.logEventResponse(n,t.element,e.purpose),Mb.resume(o)}))}))},Fb=function(t,n,e,o,r,i){return Db(t,n,e,o,r,i).fold(c,(function(o){return Fb(t,n,e,o,r,i)}),a)},Ib=function(n,e,o){var r,i,c=(r=e,i=Zn(!1),{stop:function(){i.set(!0)},cut:t,isStopped:i.get,isCut:a,event:r,setSource:u("Cannot set source of a broadcasted event"),getSource:u("Cannot get source of a broadcasted event")});return j(n,(function(t){var n=t.descHandler;li(n)(c)})),c.isStopped()},Rb=function(t,n,e,o,r){var i=Ab(e,o);return Fb(t,n,e,o,i,r)},Vb=function(){var t=function(){var t={};return{registerId:function(n,e,o){wt(o,(function(o,i){var u,a,c=void 0!==t[i]?t[i]:{};c[e]=(u=o,a=n,{cHandler:r.apply(void 0,[u.handler].concat(a)),purpose:u.purpose}),t[i]=c}))},unregisterId:function(n){wt(t,(function(t,e){t.hasOwnProperty(n)&&delete t[n]}))},filterByType:function(n){return Tt(t,n).map((function(t){return Ct(t,(function(t,n){return{id:n,descHandler:t}}))})).getOr([])},find:function(n,e,o){var r=Tt(t,e);return Ne(o,(function(t){return n=r,Jr(e=t).fold((function(){return w.none()}),(function(t){return n.bind((function(n){return Tt(n,t)})).map((function(t){return{element:e,descHandler:t}}))}));var n,e}),n)}}}(),n={},e=function(e){Jr(e.element).each((function(e){delete n[e],t.unregisterId(e)}))};return{find:function(n,e,o){return t.find(n,e,o)},filter:function(n){return t.filterByType(n)},register:function(o){var r=function(t){var n=t.element;return Jr(n).fold((function(){return n=t.element,e=Wr(Yr+"uid-"),Kr(n,e),e;var n,e}),(function(t){return t}))}(o);Bt(n,r)&&function(t,o){var r=n[o];if(r!==t)throw new Error('The tagId "'+o+'" is already used by: '+Nr(r.element)+"\nCannot use it for: "+Nr(t.element)+"\nThe conflicting element is"+(ki(r.element)?" ":" not ")+"already in the DOM");e(t)}(o,r);var i=[o];t.registerId(i,r,o.events),n[r]=o},unregister:e,getById:function(t){return Tt(n,t)}}},Pb=lf({name:"Container",factory:function(t){var n=t.dom,e=n.attributes,o=f(n,["attributes"]);return{uid:t.uid,dom:l({tag:"div",attributes:l({role:"presentation"},e)},o),components:t.components,behaviours:sl(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[Un("components",[]),cl("containerBehaviours",[]),Un("events",{}),Un("domModification",{}),Un("eventOrder",{})]}),Hb=function(n){var o=function(t){return dr(n.element).fold(c,(function(n){return Ve(t,n)}))},r=Vb(),i=function(t,n){return r.find(o,t,n)},u=Bb(n.element,{triggerEvent:function(t,n){return Iu(t,n.target,(function(e){return r=e,Rb(i,t,o=n,o.target,r);var o,r}))}}),a={debugInfo:e("real"),triggerEvent:function(t,n,e){Iu(t,n,(function(o){return Rb(i,t,e,n,o)}))},triggerFocus:function(n,e){Jr(n).fold((function(){Na(n)}),(function(o){Iu(lo(),n,(function(o){var r,u,a,c,s,l;return r=i,u=lo(),s=o,l=Ab(a={originator:e,kill:t,prevent:t,target:n},c=n),Db(r,u,a,c,l,s),!1}))}))},triggerEscape:function(t,n){a.triggerEvent("keydown",t.element,n.event)},getByUid:function(t){return v(t)},getByDom:function(t){return b(t)},build:Gi,addToGui:function(t){f(t)},removeFromGui:function(t){d(t)},addToWorld:function(t){s(t)},removeFromWorld:function(t){l(t)},broadcast:function(t){g(t)},broadcastOn:function(t,n){p(t,n)},broadcastEvent:function(t,n){h(t,n)},isConnected:c},s=function(t){t.connect(a),ir(t.element)||(r.register(t),j(t.components(),s),a.triggerEvent(wo(),t.element,{target:t.element}))},l=function(t){ir(t.element)||(j(t.components(),l),r.unregister(t)),t.disconnect()},f=function(t){Cs(n,t)},d=function(t){Ts(t)},m=function(t){var n=r.filter(go());j(n,(function(n){var e=n.descHandler;li(e)(t)}))},g=function(t){m({universal:!0,data:t})},p=function(t,n){m({universal:!1,channels:t,data:n})},h=function(t,n){var e=r.filter(t);return Ib(e,n)},v=function(t){return r.getById(t).fold((function(){return ct.error(new Error('Could not find component with uid: "'+t+'" in system.'))}),ct.value)},b=function(t){var n=Jr(t).getOr("not found");return v(n)};return s(n),{root:n,element:n.element,destroy:function(){u.unbind(),Ar(n.element)},add:f,remove:d,getByUid:v,getByDom:b,addToWorld:s,removeFromWorld:l,broadcast:g,broadcastOn:p,broadcastEvent:h}},zb=e([Un("prefix","form-field"),cl("fieldBehaviours",[vf,al])]),Nb=e([Pl({schema:[Bn("dom")],name:"label"}),Pl({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Bn("text")],name:"aria-descriptor"}),Rl({factory:{sketch:function(t){var n=function(t,n){return e=n,o={},wt(t,(function(t,n){P(e,n)||(o[n]=t)})),o;var e,o}(t,["factory"]);return t.factory.sketch(n)}},schema:[Bn("factory")],name:"field"})]),Lb=ff({name:"FormField",configFields:zb(),partFields:Nb(),factory:function(t,n,e,o){var r=ll(t.fieldBehaviours,[vf.config({find:function(n){return Kl(n,t,"field")}}),al.config({store:{mode:"manual",getValue:function(t){return vf.getCurrent(t).bind(al.getValue)},setValue:function(t,n){vf.getCurrent(t).each((function(t){al.setValue(t,n)}))}}})]),i=jo([Qo((function(n,e){var o=$l(n,t,["label","field","aria-descriptor"]);o.field().each((function(n){var e=Wr(t.prefix);o.label().each((function(t){Rr(t.element,"for",e),Rr(n.element,"id",e)})),o["aria-descriptor"]().each((function(e){var o=Wr(t.prefix);Rr(e.element,"id",o),Rr(n.element,"aria-describedby",o)}))}))}))]),u={getField:function(n){return Kl(n,t,"field")},getLabel:function(n){return Kl(n,t,"label")}};return{uid:t.uid,dom:t.dom,components:n,behaviours:r,events:i,apis:u}},apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),jb=Object.freeze({__proto__:null,exhibit:function(t,n){return si({attributes:Wt([{key:n.tabAttr,value:"true"}])})}}),Ub=[Un("tabAttr","data-alloy-tabstop")],Wb=Ia({fields:Ub,name:"tabstopping",active:jb}),Gb=tinymce.util.Tools.resolve("tinymce.html.Entities"),Xb=function(t,n,e,o){var r=Yb(t,n,e,o);return Lb.sketch(r)},Yb=function(t,n,e,o){return{dom:qb(e),components:t.toArray().concat([n]),fieldBehaviours:Da(o)}},qb=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},Kb=function(t,n){return Lb.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},Jb=Wr("form-component-change"),$b=Wr("form-close"),Qb=Wr("form-cancel"),Zb=Wr("form-action"),ty=Wr("form-submit"),ny=Wr("form-block"),ey=Wr("form-unblock"),oy=Wr("form-tabchange"),ry=Wr("form-resize"),iy=e([Pn("data"),Un("inputAttributes",{}),Un("inputStyles",{}),Un("tag","input"),Un("inputClasses",[]),Uu("onSetValue"),Un("styles",{}),Un("eventOrder",{}),cl("inputBehaviours",[al,Dm]),Un("selectOnFocus",!0)]),uy=function(n){return Da([Dm.config({onFocus:n.selectOnFocus?function(t){var n=t.element,e=Pi(n);n.dom.setSelectionRange(0,e.length)}:t})])},ay=function(t){return{tag:t.tag,attributes:l({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},cy=lf({name:"Input",configFields:iy(),factory:function(t,n){return{uid:t.uid,dom:ay(t),components:[],behaviours:l(l({},uy(e=t)),ll(e.inputBehaviours,[al.config({store:l(l({mode:"manual"},e.data.map((function(t){return{initialValue:t}})).getOr({})),{getValue:function(t){return Pi(t.element)},setValue:function(t,n){Pi(t.element)!==n&&Hi(t.element,n)}}),onSetValue:e.onSetValue})])),eventOrder:t.eventOrder};var e}}),sy={},ly={exports:sy};db=void 0,mb=sy,gb=ly,function(t){"object"==typeof mb&&void 0!==gb?gb.exports=t():"function"==typeof db&&db.amd?db([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=t()}((function(){return function t(n,e,o){function r(u,a){if(!e[u]){if(!n[u]){var c=!1;if(!a&&c)return c(u,!0);if(i)return i(u,!0);var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s}var l=e[u]={exports:{}};n[u][0].call(l.exports,(function(t){return r(n[u][1][t]||t)}),l,l.exports,t,n,e,o)}return e[u].exports}for(var i=!1,u=0;u<o.length;u++)r(o[u]);return r}({1:[function(t,n,e){var o,r,i=n.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(t){if(o===setTimeout)return setTimeout(t,0);if((o===u||!o)&&setTimeout)return o=setTimeout,setTimeout(t,0);try{return o(t,0)}catch(n){try{return o.call(null,t,0)}catch(n){return o.call(this,t,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:u}catch(t){o=u}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var s,l=[],f=!1,d=-1;function m(){f&&s&&(f=!1,s.length?l=s.concat(l):d=-1,l.length&&g())}function g(){if(!f){var t=c(m);f=!0;for(var n=l.length;n;){for(s=l,l=[];++d<n;)s&&s[d].run();d=-1,n=l.length}s=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(n){try{return r.call(null,t)}catch(n){return r.call(this,t)}}}(t)}}function p(t,n){this.fun=t,this.array=n}function h(){}i.nextTick=function(t){var n=new Array(arguments.length-1);if(1<arguments.length)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];l.push(new p(t,n)),1!==l.length||f||c(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(t,n,e){(function(t){function e(){}function o(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(t,this)}function r(t,n){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,o._immediateFn((function(){var e,o=1===t._state?n.onFulfilled:n.onRejected;if(null!==o){try{e=o(t._value)}catch(t){return void u(n.promise,t)}i(n.promise,e)}else(1===t._state?i:u)(n.promise,t._value)}))):t._deferreds.push(n)}function i(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if(n instanceof o)return t._state=3,t._value=n,void a(t);if("function"==typeof e)return void s((r=e,i=n,function(){r.apply(i,arguments)}),t)}t._state=1,t._value=n,a(t)}catch(n){u(t,n)}var r,i}function u(t,n){t._state=2,t._value=n,a(t)}function a(t){2===t._state&&0===t._deferreds.length&&o._immediateFn((function(){t._handled||o._unhandledRejectionFn(t._value)}));for(var n=0,e=t._deferreds.length;n<e;n++)r(t,t._deferreds[n]);t._deferreds=null}function c(t,n,e){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.promise=e}function s(t,n){var e=!1;try{t((function(t){e||(e=!0,i(n,t))}),(function(t){e||(e=!0,u(n,t))}))}catch(t){if(e)return;e=!0,u(n,t)}}var l;l=setTimeout,o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,n){var o=new this.constructor(e);return r(this,new c(t,n,o)),o},o.all=function(t){var n=Array.prototype.slice.call(t);return new o((function(t,e){if(0===n.length)return t([]);for(var o=n.length,r=0;r<n.length;r++)!function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a)return void a.call(u,(function(t){r(i,t)}),e)}n[i]=u,0==--o&&t(n)}catch(t){e(t)}}(r,n[r])}))},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o((function(n){n(t)}))},o.reject=function(t){return new o((function(n,e){e(t)}))},o.race=function(t){return new o((function(n,e){for(var o=0,r=t.length;o<r;o++)t[o].then(n,e)}))},o._immediateFn="function"==typeof t?function(n){t(n)}:function(t){l(t,0)},o._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},o._setImmediateFn=function(t){o._immediateFn=t},o._setUnhandledRejectionFn=function(t){o._unhandledRejectionFn=t},void 0!==n&&n.exports?n.exports=o:this.Promise||(this.Promise=o)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(t,n,e){(function(n,o){var r=t("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(t,n){this._id=t,this._clearFn=n}e.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var n=t._idleTimeout;0<=n&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),n))},e.setImmediate="function"==typeof n?n:function(t){var n=c++,o=!(arguments.length<2)&&u.call(arguments,1);return a[n]=!0,r((function(){a[n]&&(o?t.apply(null,o):t.call(null),e.clearImmediate(n))})),n},e.clearImmediate="function"==typeof o?o:function(t){delete a[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,n,e){var o=t("promise-polyfill"),r="undefined"!=typeof window?window:Function("return this;")();n.exports={boltExport:r.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)}));var fy,dy,my=ly.exports.boltExport,gy=function(t){var n=w.none(),e=[],o=function(t){r()?i(t):e.push(t)},r=function(){return n.isSome()},i=function(t){n.each((function(n){setTimeout((function(){t(n)}),0)}))};return t((function(t){r()||(n=w.some(t),function(t){j(t,i)}(e),e=[])})),{get:o,map:function(t){return gy((function(n){o((function(e){n(t(e))}))}))},isReady:r}},py={nu:gy,pure:function(t){return gy((function(n){n(t)}))}},hy=function(t){setTimeout((function(){throw t}),0)},vy=function(t){var n=function(n){t().then(n,hy)};return{map:function(n){return vy((function(){return t().then(n)}))},bind:function(n){return vy((function(){return t().then((function(t){return n(t).toPromise()}))}))},anonBind:function(n){return vy((function(){return t().then((function(){return n.toPromise()}))}))},toLazy:function(){return py.nu(n)},toCached:function(){var n=null;return vy((function(){return null===n&&(n=t()),n}))},toPromise:t,get:n}},by=function(t){return vy((function(){return new my(t)}))},yy=function(t){return vy((function(){return my.resolve(t)}))},xy=["input","textarea"],wy=function(t){var n=er(t);return P(xy,n)},Sy=function(t,n){var e=n.getRoot(t).getOr(t.element);bi(e,n.invalidClass),n.notify.each((function(n){wy(t.element)&&Rr(t.element,"aria-invalid",!1),n.getContainer(t).each((function(t){Fr(t,n.validHtml)})),n.onValid(t)}))},ky=function(t,n,e,o){var r=n.getRoot(t).getOr(t.element);vi(r,n.invalidClass),n.notify.each((function(n){wy(t.element)&&Rr(t.element,"aria-invalid",!0),n.getContainer(t).each((function(t){Fr(t,o)})),n.onInvalid(t,o)}))},Cy=function(t,n,e){return n.validator.fold((function(){return yy(ct.value(!0))}),(function(n){return n.validate(t)}))},Oy=function(t,n,e){return n.notify.each((function(n){n.onValidate(t)})),Cy(t,n).map((function(e){return t.getSystem().isConnected()?e.fold((function(e){return ky(t,n,0,e),ct.error(e)}),(function(e){return Sy(t,n),ct.value(e)})):ct.error("No longer in system")}))},_y=Object.freeze({__proto__:null,markValid:Sy,markInvalid:ky,query:Cy,run:Oy,isInvalid:function(t,n){var e=n.getRoot(t).getOr(t.element);return yi(e,n.invalidClass)}}),Ty=Object.freeze({__proto__:null,events:function(n,e){return n.validator.map((function(e){return jo([Go(e.onEvent,(function(t){Oy(t,n).get(o)}))].concat(e.validateOnLoad?[Qo((function(e){Oy(e,n).get(t)}))]:[]))})).getOr({})}}),Ey=[Bn("invalidClass"),Un("getRoot",w.none),jn("notify",[Un("aria","alert"),Un("getContainer",w.none),Un("validHtml",""),Uu("onValid"),Uu("onInvalid"),Uu("onValidate")]),jn("validator",[Bn("validate"),Un("onEvent","input"),Un("validateOnLoad",!0)])],By=Ia({fields:Ey,name:"invalidating",active:Ty,apis:_y,extra:{validation:function(t){return function(n){var e=al.getValue(n);return yy(t(e))}}}}),Ay=Object.freeze({__proto__:null,getCoupled:function(t,n,e,o){return e.getOrCreate(t,n,o)}}),My=[An("others",mn(ct.value,xn()))],Dy=Ia({fields:My,name:"coupling",apis:Ay,state:Object.freeze({__proto__:null,init:function(){var t={},n=e({});return ai({readState:n,getOrCreate:function(n,e,o){var r=yt(e.others);if(r)return Tt(t,o).getOrThunk((function(){var r=Tt(e.others,o).getOrDie("No information found for coupled component: "+o)(n),i=n.getSystem().build(r);return t[o]=i}));throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(r,null,2))}})}})}),Fy=e("sink"),Iy=e(Pl({name:Fy(),overrides:e({dom:{tag:"div"},behaviours:Da([ys.config({useFixed:c})]),events:jo([Jo(no()),Jo(qe()),Jo(io())])})}));(dy=fy=fy||{})[dy.HighlightFirst=0]="HighlightFirst",dy[dy.HighlightNone=1]="HighlightNone";var Ry,Vy,Py,Hy,zy,Ny,Ly=function(t,n){var e=t.getHotspot(n).getOr(n),o=t.getAnchorOverrides();return t.layouts.fold((function(){return{anchor:"hotspot",hotspot:e,overrides:o}}),(function(t){return{anchor:"hotspot",hotspot:e,overrides:o,layouts:t}}))},jy=function(t,n,e,o,r,i,u){var a,c,s,f,d,m,g,p,h,v,b=Ly(t,e);return(c=b,f=o,d=r,m=u,g=n,p=s=e,h=(0,(a=t).fetch)(p).map(g),v=Gy(s,a),h.map((function(t){return t.bind((function(t){return w.from(gg.sketch(l(l({},d.menu()),{uid:$r(""),data:t,highlightImmediately:m===fy.HighlightFirst,onOpenMenu:function(t,n){var e=v().getOrDie();ys.position(e,c,n),Ls.decloak(f)},onOpenSubmenu:function(t,n,e){var o=v().getOrDie();ys.position(o,{anchor:"submenu",item:n},e),Ls.decloak(f)},onRepositionMenu:function(t,n,e){var o=v().getOrDie();ys.position(o,c,n),j(e,(function(t){ys.position(o,{anchor:"submenu",item:t.triggeringItem},t.triggeredMenu)}))},onEscape:function(){return Dm.focus(s),Ls.close(f),w.some(!0)}})))}))}))).map((function(t){return t.fold((function(){Ls.isOpen(o)&&Ls.close(o)}),(function(t){Ls.cloak(o),Ls.open(o,t),i(o)})),o}))},Uy=function(t,n,e,o,r,i,u){return Ls.close(o),yy(o)},Wy=function(t,n,e,o,r,i){var u=Dy.getCoupled(e,"sandbox");return(Ls.isOpen(u)?Uy:jy)(t,n,e,u,o,r,i)},Gy=function(t,n){return t.getSystem().getByUid(n.uid+"-"+Fy()).map((function(t){return function(){return ct.value(t)}})).getOrThunk((function(){return n.lazySink.fold((function(){return function(){return ct.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(n){return function(){return n(t)}}))}))},Xy=function(t){Ls.getState(t).each((function(t){gg.repositionMenus(t)}))},Yy=function(t,n,e){var o=Eu(),r=Gy(n,t);return{dom:{tag:"div",classes:t.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:dl(t.sandboxBehaviours,[al.config({store:{mode:"memory",initialValue:n}}),Ls.config({onOpen:function(r,i){var u=Ly(t,n);o.link(n.element),t.matchWidth&&function(t,n,e){var o,r,i=vf.getCurrent(n).getOr(n),u=ou(t.element);e?Ei(i.element,"min-width",u+"px"):(o=i.element,r=u,eu.set(o,r))}(u.hotspot,i,t.useMinWidth),t.onOpen(u,r,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(r,i)},onClose:function(t,r){o.unlink(n.element),void 0!==e&&void 0!==e.onClose&&e.onClose(t,r)},isPartOf:function(t,e,o){return Bu(e,o)||Bu(n,o)},getAttachPoint:function(){return r().getOrDie()}}),vf.config({find:function(t){return Ls.getState(t).bind((function(t){return vf.getCurrent(t)}))}}),Ha.config({channels:l(l({},Xs({isExtraPart:a})),qs({doReposition:Xy}))})])}},qy=function(t){var n=Dy.getCoupled(t,"sandbox");Xy(n)},Ky=function(){return[Un("sandboxClasses",[]),fl("sandboxBehaviours",[vf,Ha,Ls,al])]},Jy=e([Bn("dom"),Bn("fetch"),Uu("onOpen"),Wu("onExecute"),Un("getHotspot",w.some),Un("getAnchorOverrides",e({})),bc(),cl("dropdownBehaviours",[Wm,Dy,wm,Dm]),Bn("toggleClass"),Un("eventOrder",{}),Pn("lazySink"),Un("matchWidth",!1),Un("useMinWidth",!1),Pn("role")].concat(Ky())),$y=e([Vl({schema:[Nu()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),Iy()]),Qy=ff({name:"Dropdown",configFields:Jy(),partFields:$y(),factory:function(n,e,o,r){var i,u=function(t){Ls.getState(t).each((function(t){gg.highlightPrimary(t)}))},a={expand:function(e){Wm.isOn(e)||Wy(n,(function(t){return t}),e,r,t,fy.HighlightNone).get(t)},open:function(e){Wm.isOn(e)||Wy(n,(function(t){return t}),e,r,t,fy.HighlightFirst).get(t)},isOpen:Wm.isOn,close:function(e){Wm.isOn(e)&&Wy(n,(function(t){return t}),e,r,t,fy.HighlightFirst).get(t)},repositionMenus:function(t){Wm.isOn(t)&&qy(t)}},c=function(t,n){return Ho(t),w.some(!0)};return{uid:n.uid,dom:n.dom,components:e,behaviours:ll(n.dropdownBehaviours,[Wm.config({toggleClass:n.toggleClass,aria:{mode:"expanded"}}),Dy.config({others:{sandbox:function(t){return Yy(n,t,{onOpen:function(){return Wm.on(t)},onClose:function(){return Wm.off(t)}})}}}),wm.config({mode:"special",onSpace:c,onEnter:c,onDown:function(t,n){var e;return Qy.isOpen(t)?(e=Dy.getCoupled(t,"sandbox"),u(e)):Qy.open(t),w.some(!0)},onEscape:function(t,n){return Qy.isOpen(t)?(Qy.close(t),w.some(!0)):w.none()}}),Dm.config({})]),events:Xm(w.some((function(e){Wy(n,(function(t){return t}),e,r,u,fy.HighlightFirst).get(t)}))),eventOrder:l(l({},n.eventOrder),((i={})[po()]=["disabling","toggling","alloy.base.behaviour"],i)),apis:a,domModification:{attributes:l(l({"aria-haspopup":"true"},n.role.fold((function(){return{}}),(function(t){return{role:t}}))),"button"===n.dom.tag?{type:("type",Tt(n.dom,"attributes").bind((function(t){return Tt(t,"type")})).getOr("button"))}:{})}}},apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)},repositionMenus:function(t,n){return t.repositionMenus(n)}}}),Zy=Ia({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return jo([Uo(ao(),c)])},exhibit:function(){return si({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),tx=Wr("color-input-change"),nx=Wr("color-swatch-change"),ex=Wr("color-picker-cancel"),ox=function(t,n,e){return{hue:t,saturation:n,value:e}},rx=Wr("rgb-hex-update"),ix=Wr("slider-update"),ux=Wr("palette-update"),ax=Pl({schema:[Bn("dom")],name:"label"}),cx=function(t){return Pl({name:t+"-edge",overrides:function(n){return n.model.manager.edgeActions[t].fold((function(){return{}}),(function(t){return{events:jo([Xo(We(),(function(n,e,o){return t(n,o)}),[n]),Xo(qe(),(function(n,e,o){return t(n,o)}),[n]),Xo(Ke(),(function(n,e,o){o.mouseIsDown.get()&&t(n,o)}),[n])])}}))}})},sx=cx("top-left"),lx=cx("top"),fx=cx("top-right"),dx=cx("right"),mx=cx("bottom-right"),gx=cx("bottom"),px=cx("bottom-left"),hx=[ax,cx("left"),dx,lx,gx,sx,fx,px,mx,Rl({name:"thumb",defaults:e({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:jo([qo(We(),t,"spectrum"),qo(Ge(),t,"spectrum"),qo(Xe(),t,"spectrum"),qo(qe(),t,"spectrum"),qo(Ke(),t,"spectrum"),qo($e(),t,"spectrum")])}}}),Rl({schema:[Qn("mouseIsDown",(function(){return Zn(!1)}))],name:"spectrum",overrides:function(t){var n=t.model.manager,e=function(e,o){return n.getValueFromEvent(o).map((function(o){return n.setValueFrom(e,t,o)}))};return{behaviours:Da([wm.config({mode:"special",onLeft:function(e){return n.onLeft(e,t)},onRight:function(e){return n.onRight(e,t)},onUp:function(e){return n.onUp(e,t)},onDown:function(e){return n.onDown(e,t)}}),Dm.config({})]),events:jo([Go(We(),e),Go(Ge(),e),Go(qe(),e),Go(Ke(),(function(n,o){t.mouseIsDown.get()&&e(n,o)}))])}}})],vx=e("slider.change.value"),bx=function(t){var n=t.event.raw;return-1===n.type.indexOf("touch")?void 0!==n.clientX?w.some(n).map((function(t){return Qi(t.clientX,t.clientY)})):w.none():void 0!==n.touches&&1===n.touches.length?w.some(n.touches[0]).map((function(t){return Qi(t.clientX,t.clientY)})):w.none()},yx=function(t){return t.model.minX},xx=function(t){return t.model.minY},wx=function(t){return t.model.minX-1},Sx=function(t){return t.model.minY-1},kx=function(t){return t.model.maxX},Cx=function(t){return t.model.maxY},Ox=function(t){return t.model.maxX+1},_x=function(t){return t.model.maxY+1},Tx=function(t,n,e){return n(t)-e(t)},Ex=function(t){return Tx(t,kx,yx)},Bx=function(t){return Tx(t,Cx,xx)},Ax=function(t){return Ex(t)/2},Mx=function(t){return Bx(t)/2},Dx=function(t){return t.stepSize},Fx=function(t){return t.snapToGrid},Ix=function(t){return t.snapStart},Rx=function(t){return t.rounded},Vx=function(t,n){return void 0!==t[n+"-edge"]},Px=function(t){return Vx(t,"left")},Hx=function(t){return Vx(t,"right")},zx=function(t){return Vx(t,"top")},Nx=function(t){return Vx(t,"bottom")},Lx=function(t){return t.model.value.get()},jx=function(t){return{x:t}},Ux=function(t){return{y:t}},Wx=function(t,n){return{x:t,y:n}},Gx=function(t,n){Po(t,vx(),{value:n})},Xx=function(t,n,e,o){return t<n?t:e<t?e:t===n?n-1:Math.max(n,t-o)},Yx=function(t,n,e,o){return e<t?t:t<n?n:t===e?e+1:Math.min(e,t+o)},qx=function(t,n,e){return Math.max(n,Math.min(e,t))},Kx=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,l=t.hasMaxEdge,f=t.minBound,d=t.maxBound,m=t.screenRange,g=s?n-1:n,p=l?e+1:e;if(r<f)return g;if(d<r)return p;var h,v,b,y,x,w,S,k=(x=r,w=f,S=d,Math.min(S,Math.max(x,w))-w),C=qx(k/m*o+n,g,p);return u&&n<=C&&C<=e?(h=C,v=n,b=e,y=i,a.fold((function(){var t=h-v,n=Math.round(t/y)*y;return qx(v+n,v-1,b+1)}),(function(t){var n=(h-t)%y,e=Math.round(n/y),o=Math.floor((h-t)/y),r=Math.floor((b-t)/y),i=t+Math.min(r,o+e)*y;return Math.max(t,i)}))):c?Math.round(C):C},Jx=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,l=t.centerMaxEdge;return r<n?i?0:s:e<r?u?a:l:(r-n)/o*c},$x="left",Qx=function(t){return t.element.dom.getBoundingClientRect()},Zx=function(t,n){return t[n]},tw=function(t){var n=Qx(t);return Zx(n,$x)},nw=function(t){var n=Qx(t);return Zx(n,"right")},ew=function(t){var n=Qx(t);return Zx(n,"top")},ow=function(t){var n=Qx(t);return Zx(n,"bottom")},rw=function(t){var n=Qx(t);return Zx(n,"width")},iw=function(t){var n=Qx(t);return Zx(n,"height")},uw=function(t,n,e){return(t+n)/2-e},aw=function(t,n){var e=Qx(t),o=Qx(n),r=Zx(e,$x),i=Zx(e,"right"),u=Zx(o,$x);return uw(r,i,u)},cw=function(t,n){var e=Qx(t),o=Qx(n),r=Zx(e,"top"),i=Zx(e,"bottom"),u=Zx(o,"top");return uw(r,i,u)},sw=function(t,n){Po(t,vx(),{value:n})},lw=function(t){return{x:t}},fw=function(t,n,e){var o={min:yx(n),max:kx(n),range:Ex(n),value:e,step:Dx(n),snap:Fx(n),snapStart:Ix(n),rounded:Rx(n),hasMinEdge:Px(n),hasMaxEdge:Hx(n),minBound:tw(t),maxBound:nw(t),screenRange:rw(t)};return Kx(o)},dw=function(t){return function(n,e){return o=n,i=(0<t?Yx:Xx)(Lx(r=e).x,yx(r),kx(r),Dx(r)),sw(o,lw(i)),w.some(i).map(c);var o,r,i}},mw=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g,p=(a=i,c=e,s=o,l=r,f=rw(u=n),d=s.bind((function(t){return w.some(aw(t,u))})).getOr(0),m=l.bind((function(t){return w.some(aw(t,u))})).getOr(f),g={min:yx(a),max:kx(a),range:Ex(a),value:c,hasMinEdge:Px(a),hasMaxEdge:Hx(a),minBound:tw(u),minOffset:0,maxBound:nw(u),maxOffset:f,centerMinEdge:d,centerMaxEdge:m},Jx(g));return tw(n)-tw(t)+p},gw=dw(-1),pw=dw(1),hw=w.none,vw=w.none,bw={"top-left":w.none(),top:w.none(),"top-right":w.none(),right:w.some((function(t,n){Gx(t,jx(Ox(n)))})),"bottom-right":w.none(),bottom:w.none(),"bottom-left":w.none(),left:w.some((function(t,n){Gx(t,jx(wx(n)))}))},yw=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=fw(t,n,e),r=lw(o);return sw(t,r),o},setToMin:function(t,n){var e=yx(n);sw(t,lw(e))},setToMax:function(t,n){var e=kx(n);sw(t,lw(e))},findValueOfOffset:fw,getValueFromEvent:function(t){return bx(t).map((function(t){return t.left}))},findPositionOfValue:mw,setPositionFromValue:function(t,n,e,o){var r=Lx(e),i=mw(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=ou(n.element)/2;Ei(n.element,"left",i-u+"px")},onLeft:gw,onRight:pw,onUp:hw,onDown:vw,edgeActions:bw}),xw=function(t,n){Po(t,vx(),{value:n})},ww=function(t){return{y:t}},Sw=function(t,n,e){var o={min:xx(n),max:Cx(n),range:Bx(n),value:e,step:Dx(n),snap:Fx(n),snapStart:Ix(n),rounded:Rx(n),hasMinEdge:zx(n),hasMaxEdge:Nx(n),minBound:ew(t),maxBound:ow(t),screenRange:iw(t)};return Kx(o)},kw=function(t){return function(n,e){return o=n,i=(0<t?Yx:Xx)(Lx(r=e).y,xx(r),Cx(r),Dx(r)),xw(o,ww(i)),w.some(i).map(c);var o,r,i}},Cw=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g,p=(a=i,c=e,s=o,l=r,f=iw(u=n),d=s.bind((function(t){return w.some(cw(t,u))})).getOr(0),m=l.bind((function(t){return w.some(cw(t,u))})).getOr(f),g={min:xx(a),max:Cx(a),range:Bx(a),value:c,hasMinEdge:zx(a),hasMaxEdge:Nx(a),minBound:ew(u),minOffset:0,maxBound:ow(u),maxOffset:f,centerMinEdge:d,centerMaxEdge:m},Jx(g));return ew(n)-ew(t)+p},Ow=w.none,_w=w.none,Tw=kw(-1),Ew=kw(1),Bw={"top-left":w.none(),top:w.some((function(t,n){Gx(t,Ux(Sx(n)))})),"top-right":w.none(),right:w.none(),"bottom-right":w.none(),bottom:w.some((function(t,n){Gx(t,Ux(_x(n)))})),"bottom-left":w.none(),left:w.none()},Aw=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=Sw(t,n,e),r=ww(o);return xw(t,r),o},setToMin:function(t,n){var e=xx(n);xw(t,ww(e))},setToMax:function(t,n){var e=Cx(n);xw(t,ww(e))},findValueOfOffset:Sw,getValueFromEvent:function(t){return bx(t).map((function(t){return t.top}))},findPositionOfValue:Cw,setPositionFromValue:function(t,n,e,o){var r=Lx(e),i=Cw(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),u=Ki(n.element)/2;Ei(n.element,"top",i-u+"px")},onLeft:Ow,onRight:_w,onUp:Tw,onDown:Ew,edgeActions:Bw}),Mw=function(t,n){Po(t,vx(),{value:n})},Dw=function(t,n){return{x:t,y:n}},Fw=function(t,n){return function(e,o){return i=e,u=o,a=0<t?Yx:Xx,s=(r=n)?Lx(u).x:a(Lx(u).x,yx(u),kx(u),Dx(u)),l=r?a(Lx(u).y,xx(u),Cx(u),Dx(u)):Lx(u).y,Mw(i,Dw(s,l)),w.some(s).map(c);var r,i,u,a,s,l}},Iw=bx,Rw=Fw(-1,!1),Vw=Fw(1,!1),Pw=Fw(-1,!0),Hw=Fw(1,!0),zw={"top-left":w.some((function(t,n){Gx(t,Wx(wx(n),Sx(n)))})),top:w.some((function(t,n){Gx(t,Wx(Ax(n),Sx(n)))})),"top-right":w.some((function(t,n){Gx(t,Wx(Ox(n),Sx(n)))})),right:w.some((function(t,n){Gx(t,Wx(Ox(n),Mx(n)))})),"bottom-right":w.some((function(t,n){Gx(t,Wx(Ox(n),_x(n)))})),bottom:w.some((function(t,n){Gx(t,Wx(Ax(n),_x(n)))})),"bottom-left":w.some((function(t,n){Gx(t,Wx(wx(n),_x(n)))})),left:w.some((function(t,n){Gx(t,Wx(wx(n),Mx(n)))}))},Nw=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=fw(t,n,e.left),r=Sw(t,n,e.top),i=Dw(o,r);return Mw(t,i),i},setToMin:function(t,n){var e=yx(n),o=xx(n);Mw(t,Dw(e,o))},setToMax:function(t,n){var e=kx(n),o=Cx(n);Mw(t,Dw(e,o))},getValueFromEvent:Iw,setPositionFromValue:function(t,n,e,o){var r=Lx(e),i=mw(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=Cw(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),a=ou(n.element)/2,c=Ki(n.element)/2;Ei(n.element,"left",i-a+"px"),Ei(n.element,"top",u-c+"px")},onLeft:Rw,onRight:Vw,onUp:Pw,onDown:Hw,edgeActions:zw}),Lw=ff({name:"Slider",configFields:[Un("stepSize",1),Un("onChange",t),Un("onChoose",t),Un("onInit",t),Un("onDragStart",t),Un("onDragEnd",t),Un("snapToGrid",!1),Un("rounded",!0),Pn("snapStart"),An("model",yn("mode",{x:[Un("minX",0),Un("maxX",100),Qn("value",(function(t){return Zn(t.mode.minX)})),Bn("getInitialValue"),Yu("manager",yw)],y:[Un("minY",0),Un("maxY",100),Qn("value",(function(t){return Zn(t.mode.minY)})),Bn("getInitialValue"),Yu("manager",Aw)],xy:[Un("minX",0),Un("maxX",100),Un("minY",0),Un("maxY",100),Qn("value",(function(t){return Zn({x:t.mode.minX,y:t.mode.minY})})),Bn("getInitialValue"),Yu("manager",Nw)]})),cl("sliderBehaviours",[wm,al]),Qn("mouseIsDown",(function(){return Zn(!1)}))],partFields:hx,factory:function(t,n,e,o){var r,i=function(n){return Jl(n,t,"thumb")},u=function(n){return Jl(n,t,"spectrum")},a=function(n){return Kl(n,t,"left-edge")},s=function(n){return Kl(n,t,"right-edge")},l=function(n){return Kl(n,t,"top-edge")},f=function(n){return Kl(n,t,"bottom-edge")},d=t.model,m=d.manager,g=function(n,e){m.setPositionFromValue(n,e,t,{getLeftEdge:a,getRightEdge:s,getTopEdge:l,getBottomEdge:f,getSpectrum:u})},p=function(n,e){d.value.set(e);var o=i(n);return g(n,o),t.onChange(n,o,e),w.some(!0)},h=function(n){var e=t.mouseIsDown.get();t.mouseIsDown.set(!1),e&&Kl(n,t,"thumb").each((function(e){var o=d.value.get();t.onChoose(n,e,o)}))},v=function(n,e){e.stop(),t.mouseIsDown.set(!0),t.onDragStart(n,i(n))},b=function(n,e){e.stop(),t.onDragEnd(n,i(n)),h(n)};return{uid:t.uid,dom:t.dom,components:n,behaviours:ll(t.sliderBehaviours,[wm.config({mode:"special",focusIn:function(n){return Kl(n,t,"spectrum").map(wm.focusIn).map(c)}}),al.config({store:{mode:"manual",getValue:function(t){return d.value.get()}}}),Ha.config({channels:((r={})[Ws()]={onReceive:h},r)})]),events:jo([Go(vx(),(function(t,n){p(t,n.event.value)})),Qo((function(n,e){var o=d.getInitialValue();d.value.set(o);var r=i(n);g(n,r);var a=u(n);t.onInit(n,r,a,d.value.get())})),Go(We(),v),Go(Xe(),b),Go(qe(),v),Go($e(),b)]),apis:{resetToMin:function(n){m.setToMin(n,t)},resetToMax:function(n){m.setToMax(n,t)},changeValue:p,refresh:g},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),jw=[cl("formBehaviours",[al])],Uw=function(t){return"<alloy.field."+t+">"},Ww=function(t,n){return{uid:t.uid,dom:t.dom,components:n,behaviours:ll(t.formBehaviours,[al.config({store:{mode:"manual",getValue:function(n){var e=Ql(n,t);return St(e,(function(t,n){return t().bind((function(t){var e,o;return e=vf.getCurrent(t),o=new Error("Cannot find a current component to extract the value from for form part '"+n+"': "+Nr(t.element)),e.fold((function(){return ct.error(o)}),ct.value)})).map(al.getValue)}))},setValue:function(n,e){wt(e,(function(e,o){Kl(n,t,o).each((function(t){vf.getCurrent(t).each((function(t){al.setValue(t,e)}))}))}))}}})]),apis:{getField:function(n,e){return Kl(n,t,e).bind(vf.getCurrent)}}}},Gw={getField:ii((function(t,n,e){return t.getField(n,e)})),sketch:function(t){var n,e=(n=[],{field:function(t,e){return n.push(t),Wl("form",Uw(t),e)},record:function(){return n}}),o=t(e),r=e.record(),i=L(r,(function(t){return Rl({name:t,pname:Uw(t)})}));return uf("form",jw,i,Ww,o)}},Xw=Wr("valid-input"),Yw=Wr("invalid-input"),qw=Wr("validating-input"),Kw="colorcustom.rgb.",Jw=function(n,e,o,r){var i=function(o,r,i,u,a){var c,s,f=n(Kw+"range"),d=[Lb.parts.label({dom:{tag:"label",innerHtml:i,attributes:{"aria-label":u}}}),Lb.parts.field({data:a,factory:cy,inputAttributes:l({type:"text"},"hex"===r?{"aria-live":"polite"}:{}),inputClasses:[e("textfield")],inputBehaviours:Da([(c=r,s=o,By.config({invalidClass:e("invalid"),notify:{onValidate:function(t){Po(t,qw,{type:c})},onValid:function(t){Po(t,Xw,{type:c,value:al.getValue(t)})},onInvalid:function(t){Po(t,Yw,{type:c,value:al.getValue(t)})}},validator:{validate:function(t){var e=al.getValue(t),o=s(e)?ct.value(!0):ct.error(n("aria.input.invalid"));return yy(o)},validateOnLoad:!1}})),Wb.config({})]),onSetValue:function(n){By.isInvalid(n)&&By.run(n).get(t)}})],m="hex"!==r?[Lb.parts["aria-descriptor"]({text:f})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:d.concat(m)}},u=function(t,n){var e=n.red,o=n.green,r=n.blue;al.setValue(t,{red:e,green:o,blue:r})},a=Bg({dom:{tag:"div",classes:[e("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),c=function(t,n){a.getOpt(t).each((function(t){Ei(t.element,"background-color","#"+n.value)}))};return lf({factory:function(){var t={red:Zn(w.some(255)),green:Zn(w.some(255)),blue:Zn(w.some(255)),hex:Zn(w.some("ffffff"))},s=function(n){return t[n].get()},l=function(n,e){t[n].set(e)},f=function(t){var n=t.red,e=t.green,o=t.blue;l("red",w.some(n)),l("green",w.some(e)),l("blue",w.some(o))},d=function(t,n){var e=n.event;"hex"!==e.type?l(e.type,w.none()):r(t)},m=function(t,n){var e=n.event;"hex"===e.type?function(t,n){o(t);var e=Cv(n);l("hex",w.some(n));var r=Hv(e);u(t,r),f(r),Po(t,rx,{hex:e}),c(t,e)}(t,e.value):function(t,n,e){var o=parseInt(e,10);l(n,w.some(o)),s("red").bind((function(t){return s("green").bind((function(n){return s("blue").map((function(e){return Rv(t,n,e,1)}))}))})).each((function(n){var e,o,r=(e=t,o=Bv(n),Gw.getField(e,"hex").each((function(t){Dm.isFocused(t)||al.setValue(e,{hex:o.value})})),o);c(t,r)}))}(t,e.type,e.value)},g=function(t){return{label:n(Kw+t+".label"),description:n(Kw+t+".description")}},p=g("red"),h=g("green"),v=g("blue"),b=g("hex");return Ft(Gw.sketch((function(t){return{dom:{tag:"form",classes:[e("rgb-form")],attributes:{"aria-label":n("aria.color.picker")}},components:[t.field("red",Lb.sketch(i(Vv,"red",p.label,p.description,255))),t.field("green",Lb.sketch(i(Vv,"green",h.label,h.description,255))),t.field("blue",Lb.sketch(i(Vv,"blue",v.label,v.description,255))),t.field("hex",Lb.sketch(i(Tv,"hex",b.label,b.description,"ffffff"))),a.asSpec()],formBehaviours:Da([By.config({invalidClass:e("form-invalid")}),Tm("rgb-form-events",[Go(Xw,m),Go(Yw,d),Go(qw,d)])])}})),{apis:{updateHex:function(t,n){var e,o;al.setValue(t,{hex:n.value}),e=t,o=Hv(n),u(e,o),f(o),c(t,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}})},$w=function(n,o){return lf({name:"ColourPicker",configFields:[Bn("dom"),Un("onValidHex",t),Un("onInvalidHex",t)],factory:function(t){var r,i,u,a,c,s=Jw(n,o,t.onValidHex,t.onInvalidHex),l=function(t,n){var o=Lw.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[n("sv-palette-spectrum")]}}),r=Lw.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette-thumb")],innerHtml:"<div class="+n("sv-palette-inner-thumb")+' role="presentation"></div>'}}),i=function(t,n){var e,o,r=t.width,i=t.height,u=t.getContext("2d");null!==u&&(u.fillStyle=n,u.fillRect(0,0,r,i),(e=u.createLinearGradient(0,0,r,0)).addColorStop(0,"rgba(255,255,255,1)"),e.addColorStop(1,"rgba(255,255,255,0)"),u.fillStyle=e,u.fillRect(0,0,r,i),(o=u.createLinearGradient(0,0,0,i)).addColorStop(0,"rgba(0,0,0,0)"),o.addColorStop(1,"rgba(0,0,0,1)"),u.fillStyle=o,u.fillRect(0,0,r,i))};return lf({factory:function(t){var u=e({x:0,y:0}),a=Da([vf.config({find:w.some}),Dm.config({})]);return Lw.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette")]},model:{mode:"xy",getInitialValue:u},rounded:!1,components:[o,r],onChange:function(t,n,e){Po(t,ux,{value:e})},onInit:function(t,n,e,o){i(e.element.dom,Nv(Lv))},sliderBehaviours:a})},name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(t,n,e){var o,r;o=e,r=n.components()[0].element.dom,i(r,Nv(o))}},extraApis:{}})}(0,o),f={paletteRgba:Zn(Lv)},d=Bg(l.sketch({})),m=Bg(s.sketch({})),g=function(t,n){m.getOpt(t).each((function(t){s.updateHex(t,n)}))},p=function(t,n,e){j(e,(function(e){e(t,n)}))};return{uid:t.uid,dom:t.dom,components:[d.asSpec(),(u=o,a=Lw.parts.spectrum({dom:{tag:"div",classes:[u("hue-slider-spectrum")],attributes:{role:"presentation"}}}),c=Lw.parts.thumb({dom:{tag:"div",classes:[u("hue-slider-thumb")],attributes:{role:"presentation"}}}),Lw.sketch({dom:{tag:"div",classes:[u("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:e({y:0})},components:[a,c],sliderBehaviours:Da([Dm.config({})]),onChange:function(t,n,e){Po(t,ix,{value:e})}})),m.asSpec()],behaviours:Da([Tm("colour-picker-events",[Go(ux,(i=[g],function(t,n){var e,o,r,u,a,c,s,l,d,m=n.event.value,g=(u=r=0,a=(e=f.paletteRgba.get()).red/255,c=e.green/255,s=e.blue/255,(l=Math.min(a,Math.min(c,s)))===(d=Math.max(a,Math.max(c,s)))?ox(0,0,100*(u=l)):(r=60*((r=a===l?3:s===l?1:5)-(a===l?c-s:s===l?a-c:s-a)/(d-l)),o=(d-l)/d,u=d,ox(Math.round(r),Math.round(100*o),Math.round(100*u)))),h=ox(g.hue,m.x,100-m.y),v=Pv(h),b=Bv(v);p(t,b,i)})),Go(ix,(r=[function(t,n){d.getOpt(t).each((function(t){var e=Hv(n);f.paletteRgba.set(e),l.setRgba(t,e)}))},g],function(t,n){var e,o,i,u=(e=n.event.value.y,o=ox((100-e)/100*360,100,100),i=Pv(o),Bv(i));p(t,u,r)}))]),vf.config({find:function(t){return m.getOpt(t)}}),wm.config({mode:"acyclic"})])}}})},Qw=function(){return vf.config({find:w.some})},Zw=function(t){return vf.config({find:t.getOpt})},tS=function(t){return vf.config({find:function(n){return hr(n.element,t).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))}})},nS={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},eS=function(t){return nS[t]},oS=tinymce.util.Tools.resolve("tinymce.Resource"),rS=tinymce.util.Tools.resolve("tinymce.util.Tools"),iS=tn([Un("preprocess",o),Un("postprocess",o)]),uS=function(t,n,e){return al.config(Ft({store:{mode:"manual",getValue:n,setValue:e}},t.map((function(t){return{store:{initialValue:t}}})).getOr({})))},aS=function(t,n){var e=hn("RepresentingConfigs.memento processors",iS,n);return al.config({store:{mode:"manual",getValue:function(n){var o=t.get(n),r=al.getValue(o);return e.postprocess(r)},setValue:function(n,o){var r=e.preprocess(o),i=t.get(n);al.setValue(i,r)}}})},cS=uS,sS=function(t){return function(t,n,e){return uS(t,(function(t){return n(t.element)}),(function(t,n){return e(t.element,n)}))}(t,Dr,Fr)},lS=function(t){return al.config({store:{mode:"memory",initialValue:t}})},fS=Wr("alloy-fake-before-tabstop"),dS=Wr("alloy-fake-after-tabstop"),mS=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:Da([Dm.config({ignore:!0}),Wb.config({})])}},gS=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[mS([fS]),t,mS([dS])],behaviours:Da([tS(1)])}},pS=function(t,n){Po(t,no(),{raw:{which:9,shiftKey:n}})},hS=function(t,n){var e=n.element;yi(e,fS)?pS(t,!0):yi(e,dS)&&pS(t,!1)},vS=function(t){return Cb(t,["."+fS,"."+dS].join(","),a)},bS=!(Fe().browser.isIE()||Fe().browser.isEdge()),yS=function(t,n){return SS(document.createElement("canvas"),t,n)},xS=function(t){var n=yS(t.width,t.height);return wS(n).drawImage(t,0,0),n},wS=function(t){return t.getContext("2d")},SS=function(t,n,e){return t.width=n,t.height=e,t},kS=function(t){return t.naturalWidth||t.width},CS=function(t){return t.naturalHeight||t.height},OS=window.Promise?window.Promise:(Ry=function(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],Ny(t,Hy(TS,this),Hy(ES,this))},Vy=window,Py=Ry.immediateFn||"function"==typeof Vy.setImmediate&&Vy.setImmediate||function(t){return setTimeout(t,1)},Hy=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t.apply(n,e)}},zy=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Ny=function(t,n,e){var o=!1;try{t((function(t){o||(o=!0,n(t))}),(function(t){o||(o=!0,e(t))}))}catch(t){if(o)return;o=!0,e(t)}},Ry.prototype.catch=function(t){return this.then(null,t)},Ry.prototype.then=function(t,n){var e=this;return new Ry((function(o,r){_S.call(e,new AS(t,n,o,r))}))},Ry.all=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=Array.prototype.slice.call(1===t.length&&zy(t[0])?t[0]:t);return new Ry((function(t,n){if(0===e.length)return t([]);for(var o=e.length,r=function(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a)return void a.call(u,(function(t){r(i,t)}),n)}e[i]=u,0==--o&&t(e)}catch(t){n(t)}},i=0;i<e.length;i++)r(i,e[i])}))},Ry.resolve=function(t){return t&&"object"==typeof t&&t.constructor===Ry?t:new Ry((function(n){n(t)}))},Ry.reject=function(t){return new Ry((function(n,e){e(t)}))},Ry.race=function(t){return new Ry((function(n,e){for(var o=0,r=t;o<r.length;o++)r[o].then(n,e)}))},Ry);function _S(t){var n=this;null!==this._state?Py((function(){var e,o=n._state?t.onFulfilled:t.onRejected;if(null!==o){try{e=o(n._value)}catch(n){return void t.reject(n)}t.resolve(e)}else(n._state?t.resolve:t.reject)(n._value)})):this._deferreds.push(t)}function TS(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void Ny(Hy(n,t),Hy(TS,this),Hy(ES,this))}this._state=!0,this._value=t,BS.call(this)}catch(t){ES.call(this,t)}}function ES(t){this._state=!1,this._value=t,BS.call(this)}function BS(){for(var t=0,n=this._deferreds;t<n.length;t++){var e=n[t];_S.call(this,e)}this._deferreds=[]}function AS(t,n,e,o){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.resolve=e,this.reject=o}var MS,DS,FS,IS,RS=function(t,n,e){return n=n||"image/png",A(HTMLCanvasElement.prototype.toBlob)?new OS((function(o,r){t.toBlob((function(t){t?o(t):r()}),n,e)})):function(t){return new OS((function(n,e){(function(t){var n=t.split(","),e=/data:([^;]+)/.exec(n[0]);if(!e)return w.none();for(var o=e[1],r=n[1],i=atob(r),u=i.length,a=Math.ceil(u/1024),c=new Array(a),s=0;s<a;++s){for(var l=1024*s,f=Math.min(1024+l,u),d=new Array(f-l),m=l,g=0;m<f;++g,++m)d[g]=i[m].charCodeAt(0);c[s]=new Uint8Array(d)}return w.some(new Blob(c,{type:o}))})(t).fold((function(){e("uri is not base64: "+t)}),n)}))}(t.toDataURL(n,e))},VS=function(t){URL.revokeObjectURL(t.src)},PS=function(t,n,o){var r=n.type,i=e(r),u=e(o),a=function(n,e){return t.then((function(t){return r=e,o=(o=n)||"image/png",t.toDataURL(o,r);var o,r}))};return{getType:i,toBlob:function(){return OS.resolve(n)},toDataURL:u,toBase64:function(){return o.split(",")[1]},toAdjustedBlob:function(n,e){return t.then((function(t){return RS(t,n,e)}))},toAdjustedDataURL:a,toAdjustedBase64:function(t,n){return a(t,n).then((function(t){return t.split(",")[1]}))},toCanvas:function(){return t.then(xS)}}},HS=function(t,n){return RS(t,n).then((function(n){return PS(OS.resolve(t),n,t.toDataURL())}))},zS=function(t){return n=t,new OS((function(t){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(n)})).then((function(n){return PS(function(t){return n=t,new OS((function(t,e){var o=URL.createObjectURL(n),r=new Image,i=function(){r.removeEventListener("load",u),r.removeEventListener("error",a)},u=function(){i(),t(r)},a=function(){i(),e("Unable to load data of type "+n.type+": "+o)};r.addEventListener("load",u),r.addEventListener("error",a),r.src=o,r.complete&&setTimeout(u,0)})).then((function(t){VS(t);var n=yS(kS(t),CS(t));return wS(n).drawImage(t,0,0),n}));var n}(t),t,n)}));var n},NS=function(t,n,e){var o="string"==typeof t?parseFloat(t):t;return e<o?o=e:o<n&&(o=n),o},LS=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],jS=function(t,n){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=n[u+5*i];for(u=0;u<5;u++){for(var a=e=0;a<5;a++)e+=t[u+5*a]*o[a];r[u+5*i]=e}}return r},US=function(t,n){return t.toCanvas().then((function(e){return WS(e,t.getType(),n)}))},WS=function(t,n,e){var o=wS(t),r=function(t,n){for(var e,o,r,i,u=t.data,a=n[0],c=n[1],s=n[2],l=n[3],f=n[4],d=n[5],m=n[6],g=n[7],p=n[8],h=n[9],v=n[10],b=n[11],y=n[12],x=n[13],w=n[14],S=n[15],k=n[16],C=n[17],O=n[18],_=n[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*l+f,u[T+1]=e*d+o*m+r*g+i*p+h,u[T+2]=e*v+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_;return t}(o.getImageData(0,0,t.width,t.height),e);return o.putImageData(r,0,0),HS(t,n)},GS=function(t){return function(n,e){return US(n,t([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],e))}},XS=(MS=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1],function(t){return US(t,MS)}),YS=GS((function(t,n){return n=NS(255*n,-255,255),jS(t,[1,0,0,0,n,0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])})),qS=GS((function(t,n){var e;return n=NS(n,-1,1),e=(n*=100)<0?127+n/100*127:127*(e=0==(e=n%1)?LS[n]:LS[Math.floor(n)]*(1-e)+LS[Math.floor(n)+1]*e)+127,jS(t,[e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])})),KS=(DS=[0,-1,0,-1,5,-1,0,-1,0],function(t){return e=DS,(n=t).toCanvas().then((function(t){return function(t,n,e){var o=wS(t),r=function(t,n,e){for(var o=function(t,n,e){return e<t?t=e:t<n&&(t=n),t},r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=t.data,a=n.data,c=t.width,s=t.height,l=0;l<s;l++)for(var f=0;f<c;f++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(f+h-i,0,c-1),b=4*(o(l+p-i,0,s-1)*c+v),y=e[p*r+h];d+=u[b]*y,m+=u[1+b]*y,g+=u[2+b]*y}var x=4*(l*c+f);a[x]=o(d,0,255),a[1+x]=o(m,0,255),a[2+x]=o(g,0,255)}return n}(o.getImageData(0,0,t.width,t.height),r=o.getImageData(0,0,t.width,t.height),e);return o.putImageData(r,0,0),HS(t,n)}(t,n.getType(),e)}));var n,e}),JS=(FS=function(t,n){return 255*Math.pow(t/255,1-n)},function(t,n){return t.toCanvas().then((function(e){return function(t,n,e){for(var o=wS(t),r=new Array(256),i=0;i<r.length;i++)r[i]=FS(i,e);var u=function(t,n){for(var e=t.data,o=0;o<e.length;o+=4)e[o]=n[e[o]],e[o+1]=n[e[o+1]],e[o+2]=n[e[o+2]];return t}(o.getImageData(0,0,t.width,t.height),r);return o.putImageData(u,0,0),HS(t,n)}(e,t.getType(),n)}))}),$S=function(t,n,e){var o=kS(t),r=CS(t),i=n/o,u=e/r,a=!1;(i<.5||2<i)&&(i=i<.5?.5:2,a=!0),(u<.5||2<u)&&(u=u<.5?.5:2,a=!0);var c=QS(t,i,u);return a?c.then((function(t){return $S(t,n,e)})):c},QS=function(t,n,e){return new OS((function(o){var r=kS(t),i=CS(t),u=Math.floor(r*n),a=Math.floor(i*e),c=yS(u,a);wS(c).drawImage(t,0,0,r,i,0,0,u,a),o(c)}))},ZS=function(t){return XS(t)},tk=function(t){return KS(t)},nk=function(t,n){return JS(t,n)},ek=function(t,n){return YS(t,n)},ok=function(t,n){return qS(t,n)},rk=function(t,n){return o=n,(e=t).toCanvas().then((function(t){return function(t,n,e){var o=yS(t.width,t.height),r=wS(o);return"v"===e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),HS(o,n)}(t,e.getType(),o)}));var e,o},ik=function(t,n,e,o,r){return u=n,a=e,c=o,s=r,(i=t).toCanvas().then((function(t){return function(t,n,e,o,r,i){var u=yS(r,i);return wS(u).drawImage(t,-e,-o),HS(u,n)}(t,i.getType(),u,a,c,s)}));var i,u,a,c,s},uk=function(t,n){return o=n,(e=t).toCanvas().then((function(t){return function(t,n,e){var o=yS(t.width,t.height),r=wS(o),i=0,u=0;return 90!==(e=e<0?360+e:e)&&270!==e||SS(o,o.height,o.width),90!==e&&180!==e||(i=o.width),270!==e&&180!==e||(u=o.height),r.translate(i,u),r.rotate(e*Math.PI/180),r.drawImage(t,0,0),HS(o,n)}(t,e.getType(),o)}));var e,o},ak=function(t,n){return l({dom:{tag:"span",innerHtml:t,classes:["tox-icon","tox-tbtn__icon-wrap"]}},n)},ck=function(t,n){return ak(Mg(t,n),{})},sk=function(t,n){return ak(Mg(t,n),{behaviours:Da([_m.config({})])})},lk=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:Da([_m.config({})])}},fk=Wr("toolbar.button.execute"),dk=((IS={})[po()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],IS),mk=Wr("update-menu-text"),gk=Wr("update-menu-icon"),pk=function(n,e,o){var i=Zn(t),u=n.text.map((function(t){return Bg(lk(t,e,o.providers))})),a=n.icon.map((function(t){return Bg(sk(t,o.providers.icons))})),c=function(t,n){var e=al.getValue(t);return Dm.focus(e),Po(e,"keydown",{raw:n.event.raw}),Qy.close(e),w.some(!0)},s=n.role.fold((function(){return{}}),(function(t){return{role:t}})),f=n.tooltip.fold((function(){return{}}),(function(t){var n=o.providers.translate(t);return{title:n,"aria-label":n}}));return Bg(Qy.sketch(l(l(l({},n.uid?{uid:n.uid}:{}),s),{dom:{tag:"button",classes:[e,e+"--select"].concat(L(n.classes,(function(t){return e+"--"+t}))),attributes:l({},f)},components:uv([a.map((function(t){return t.asSpec()})),u.map((function(t){return t.asSpec()})),w.some({dom:{tag:"div",classes:[e+"__select-chevron"],innerHtml:Mg("chevron-down",o.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:Da(d(n.dropdownBehaviours,[Zh((function(){return n.disabled||o.providers.isDisabled()})),$h(),Zy.config({}),_m.config({}),Tm("dropdown-events",[ov(n,i),rv(n,i)]),Tm("menubutton-update-display-text",[Go(mk,(function(t,n){u.bind((function(n){return n.getOpt(t)})).each((function(t){_m.set(t,[ji(o.providers.translate(n.event.text))])}))})),Go(gk,(function(t,n){a.bind((function(n){return n.getOpt(t)})).each((function(t){_m.set(t,[sk(n.event.icon,o.providers.icons)])}))}))])])),eventOrder:Ft(dk,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:Da([wm.config({mode:"special",onLeft:c,onRight:c})]),lazySink:o.getSink,toggleClass:e+"--active",parts:{menu:Ap(0,n.columns,n.presets)},fetch:function(t){return by(r(n.fetch,t))}}))).asSpec()},hk=function(t){return"separator"===t.type},vk={type:"separator"},bk=function(t,n){var e=function(t,n){var e=X(t,(function(t,e){return C(e)?""===e?t:"|"===e?0<t.length&&!hk(t[t.length-1])?t.concat([vk]):t:Et(n,e.toLowerCase())?t.concat([n[e.toLowerCase()]]):t:t.concat([e])}),[]);return 0<e.length&&hk(e[e.length-1])&&e.pop(),e}(C(t)?t.split(" "):t,n);return G(e,(function(t,e){var o=function(t,n){return Et(t,"getSubmenuItems")?(o=n,r=(e=t).getSubmenuItems(),i=bk(r,o),{item:e,menus:Ft(i.menus,Ut(e.value,i.items)),expansions:Ft(i.expansions,Ut(e.value,e.value))}):{item:t,menus:{},expansions:{}};var e,o,r,i}(function(t){if(hk(t))return t;var n=Tt(t,"value").getOrThunk((function(){return Wr("generated-menu-item")}));return Ft({value:n},t)}(e),n);return{menus:Ft(t.menus,o.menus),items:[o.item].concat(t.items),expansions:Ft(t.expansions,o.expansions)}}),{menus:{},expansions:{},items:[]})},yk=function(t,n,e,o){var r=Wr("primary-menu"),i=bk(t,e.shared.providers.menuItems());if(0===i.items.length)return w.none();var u=vb(r,i.items,n,e,o),a=St(i.menus,(function(t,o){return vb(o,t,n,e,!1)})),c=Ft(a,Ut(r,u));return w.from(gg.tieredData(r,c,i.expansions))},xk=function(t){return{isDisabled:function(){return Sh.isDisabled(t)},setDisabled:function(n){return Sh.set(t,n)},setActive:function(n){var e=t.element;n?(vi(e,"tox-tbtn--enabled"),Rr(e,"aria-pressed",!0)):(bi(e,"tox-tbtn--enabled"),zr(e,"aria-pressed"))},isActive:function(){return yi(t.element,"tox-tbtn--enabled")}}},wk=function(t,n,e,o){return pk({text:t.text,icon:t.icon,tooltip:t.tooltip,role:o,fetch:function(n,o){t.fetch((function(t){o(yk(t,pp.CLOSE_ON_EXECUTE,e,!1))}))},onSetup:t.onSetup,getApi:xk,columns:1,presets:"normal",classes:[],dropdownBehaviours:[Wb.config({})]},n,e.shared)},Sk=function(t,n,e){return function(o){o(L(t,(function(t){var o,r,i=t.text.fold((function(){return{}}),(function(t){return{text:t}}));return l(l({type:t.type,active:!1},i),{onAction:function(t){var o=!t.isActive();t.setActive(o),r.storage.set(o),e.shared.getSink().each((function(t){n().getOpt(t).each((function(t){Na(t.element),Po(t,Zb,{name:r.name,value:r.storage.get()})}))}))},onSetup:(o=r=t,function(t){t.setActive(o.storage.get())})})})))}},kk=function(t,n,e,o,r,i){void 0===e&&(e=[]);var u=n.fold((function(){return{}}),(function(t){return{action:t}})),a=l({buttonBehaviours:Da([Zh((function(){return t.disabled||i.isDisabled()})),$h(),Wb.config({}),Tm("button press",[Wo("click"),Wo("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),c=Ft(a,{dom:o});return Ft(c,{components:r})},Ck=function(t,n,e,o){void 0===o&&(o=[]);var r={tag:"button",classes:["tox-tbtn"],attributes:t.tooltip.map((function(t){return{"aria-label":e.translate(t),title:e.translate(t)}})).getOr({})},i=t.icon.map((function(t){return ck(t,e.icons)})),u=uv([i]);return kk(t,n,o,r,u,e)},Ok=function(t,n,e,o){void 0===o&&(o=[]);var r=Ck(t,w.some(n),e,o);return Eg.sketch(r)},_k=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.translate(t.text),u=t.icon?t.icon.map((function(t){return ck(t,e.icons)})):w.none(),a=u.isSome()?uv([u]):[],c=u.isSome()?{}:{innerHtml:i},s=d(t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"],u.isSome()?["tox-button--icon"]:[],t.borderless?["tox-button--naked"]:[],r),f=l(l({tag:"button",classes:s},c),{attributes:{title:i}});return kk(t,n,o,f,a,e)},Tk=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=_k(t,w.some(n),e,o,r);return Eg.sketch(i)},Ek=function(t,n){return function(e){"custom"===n?Po(e,Zb,{name:t,value:{}}):"submit"===n?Vo(e,ty):"cancel"===n?Vo(e,Qb):console.error("Unknown button type: ",n)}},Bk=function(n,e,o){if("menu"===e){var r=n,i=l(l({},n),{onSetup:function(e){return e.setDisabled(n.disabled),t},fetch:Sk(r.items,(function(){return u}),o)}),u=Bg(wk(i,"tox-tbtn",o,w.none()));return u.asSpec()}if("custom"===(s=e)||"cancel"===s||"submit"===s){var a=Ek(n.name,e),c=l(l({},n),{borderless:!1});return Tk(c,a,o.shared.providers,[])}var s;console.error("Unknown footer button type: ",e)},Ak=e([Un("field1Name","field1"),Un("field2Name","field2"),Gu("onLockedChange"),Lu(["lockClass"]),Un("locked",!1),fl("coupledFieldBehaviours",[vf,al])]),Mk=function(t,n){return Rl({factory:Lb,name:t,overrides:function(t){return{fieldBehaviours:Da([Tm("coupled-input-behaviour",[Go(oo(),(function(e){Kl(e,t,n).bind(vf.getCurrent).each((function(n){Kl(e,t,"lock").each((function(o){Wm.isOn(o)&&t.onLockedChange(e,n,o)}))}))}))])])}}})},Dk=e([Mk("field1","field2"),Mk("field2","field1"),Rl({factory:Eg,schema:[Bn("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:Da([Wm.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),Fk=ff({name:"FormCoupledInputs",configFields:Ak(),partFields:Dk(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:dl(t.coupledFieldBehaviours,[vf.config({find:w.some}),al.config({store:{mode:"manual",getValue:function(n){var e=tf(n,t,["field1","field2"]),o={};return o[t.field1Name]=al.getValue(e.field1()),o[t.field2Name]=al.getValue(e.field2()),o},setValue:function(n,e){var o=tf(n,t,["field1","field2"]);Bt(e,t.field1Name)&&al.setValue(o.field1(),e[t.field1Name]),Bt(e,t.field2Name)&&al.setValue(o.field2(),e[t.field2Name])}}})]),apis:{getField1:function(n){return Kl(n,t,"field1")},getField2:function(n){return Kl(n,t,"field2")},getLock:function(n){return Kl(n,t,"lock")}}}},apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),Ik=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t);if(null===n)return ct.error(t);var e=parseFloat(n[1]),o=n[2];return ct.value({value:e,unit:o})},Rk=function(t,n){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=function(t){return Object.prototype.hasOwnProperty.call(e,t)};return t.unit===n?w.some(t.value):o(t.unit)&&o(n)?e[t.unit]===e[n]?w.some(t.value):w.some(t.value/e[t.unit]*e[n]):w.none()},Vk=function(t){return w.none()},Pk=function(t,n){var e=Vk,o=Wr("ratio-event"),r=Fk.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(t.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:Mg("lock",n.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:Mg("unlock",n.icons)}}],buttonBehaviours:Da([Sh.config({disabled:function(){return t.disabled||n.isDisabled()}}),$h(),Wb.config({})])}),i=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},u=function(e){return Lb.parts.field({factory:cy,inputClasses:["tox-textfield"],inputBehaviours:Da([Sh.config({disabled:function(){return t.disabled||n.isDisabled()}}),$h(),Wb.config({}),Tm("size-input-events",[Go(Ze(),(function(t,n){Po(t,o,{isField1:e})})),Go(ro(),(function(n,e){Po(n,Jb,{name:t.name})}))])]),selectOnFocus:!1})},a=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}},c=Fk.parts.field1(i([Lb.parts.label(a("Width")),u(!0)])),s=Fk.parts.field2(i([Lb.parts.label(a("Height")),u(!1)]));return Fk.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,s,i([a("&nbsp;"),r])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,n,o){Ik(al.getValue(t)).each((function(t){e(t).each((function(t){var e,o,r,i;al.setValue(n,(r={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},-1!==(i=(e=t).value.toFixed((o=e.unit)in r?r[o]:1)).indexOf(".")&&(i=i.replace(/\.?0*$/,"")),i+e.unit))}))}))},coupledFieldBehaviours:Da([Sh.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){Fk.getField1(t).bind(Lb.getField).each(Sh.disable),Fk.getField2(t).bind(Lb.getField).each(Sh.disable),Fk.getLock(t).each(Sh.disable)},onEnabled:function(t){Fk.getField1(t).bind(Lb.getField).each(Sh.enable),Fk.getField2(t).bind(Lb.getField).each(Sh.enable),Fk.getLock(t).each(Sh.enable)}}),$h(),Tm("size-input-events2",[Go(o,(function(t,n){var o=n.event.isField1,r=o?Fk.getField1(t):Fk.getField2(t),i=o?Fk.getField2(t):Fk.getField1(t),u=r.map(al.getValue).getOr(""),a=i.map(al.getValue).getOr("");e=function(t,n){var e,o,r,i=Ik(t).toOptional();return o=Ik(n).toOptional(),r=function(t,n){return Rk(t,n.unit).map((function(t){return n.value/t})).map((function(t){return e=t,o=n.unit,function(t){return Rk(t,o).map((function(t){return{value:t*e,unit:o}}))};var e,o})).getOr(Vk)},((e=i).isSome()&&o.isSome()?w.some(r(e.getOrDie(),o.getOrDie())):w.none()).getOr(Vk)}(u,a)}))])])})},Hk={undo:e(Wr("undo")),redo:e(Wr("redo")),zoom:e(Wr("zoom")),back:e(Wr("back")),apply:e(Wr("apply")),swap:e(Wr("swap")),transform:e(Wr("transform")),tempTransform:e(Wr("temp-transform")),transformApply:e(Wr("transform-apply"))},zk=e("save-state"),Nk=e("disable"),Lk=e("enable"),jk={formActionEvent:Zb,saveState:zk,disable:Nk,enable:Lk},Uk=function(n,o){var r=function(t,n,e,r){return Bg(Tk({name:t,text:t,disabled:e,primary:r,icon:w.none(),borderless:!1},n,o))},i=function(t,n,e,r){return Bg(Ok({name:t,icon:w.some(t),tooltip:w.some(n),disabled:r,primary:!1,borderless:!1},e,o))},u=function(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(Sh)&&Sh.disable(e)}))},a=function(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(Sh)&&Sh.enable(e)}))},c={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},s=t,l=function(t,n,e){Po(t,n,e)},f=function(t){return Vo(t,jk.disable())},d=function(t){return Vo(t,jk.enable())},m=function(t,n){f(t),l(t,Hk.transform(),{transform:n}),d(t)},g=function(t){return function(){Q.getOpt(t).each((function(t){_m.set(t,[J])}))}},p=function(t,n){f(t),l(t,Hk.transformApply(),{transform:n,swap:g(t)}),d(t)},h=function(){return r("Back",(function(t){return l(t,Hk.back(),{swap:g(t)})}),!1,!1)},v=function(){return Bg({dom:{tag:"div",classes:["tox-spacer"]},behaviours:Da([Sh.config({})])})},b=function(){return r("Apply",(function(t){return l(t,Hk.apply(),{swap:g(t)})}),!0,!0)},y=[h(),v(),r("Apply",(function(t){p(t,(function(t){var e=n.getRect();return ik(t,e.x,e.y,e.w,e.h)})),n.hideCrop()}),!1,!0)],x=Pb.sketch({dom:c,components:y.map((function(t){return t.asSpec()})),containerBehaviours:Da([Tm("image-tools-crop-buttons-events",[Go(jk.disable(),(function(t,n){u(y,t)})),Go(jk.enable(),(function(t,n){a(y,t)}))])])}),S=Bg(Pk({name:"size",label:w.none(),constrain:!0,disabled:!1},o)),k=[h(),v(),S,v(),r("Apply",(function(t){S.getOpt(t).each((function(n){var e,o,r=al.getValue(n),i=parseInt(r.width,10),u=parseInt(r.height,10),a=(e=i,o=u,function(t){return function(t,n,e){return r=n,i=e,(o=t).toCanvas().then((function(t){return $S(t,r,i).then((function(t){return HS(t,o.getType())}))}));var o,r,i}(t,e,o)});p(t,a)}))}),!1,!0)],C=Pb.sketch({dom:c,components:k.map((function(t){return t.asSpec()})),containerBehaviours:Da([Tm("image-tools-resize-buttons-events",[Go(jk.disable(),(function(t,n){u(k,t)})),Go(jk.enable(),(function(t,n){a(k,t)}))])])}),O=function(t,n){return function(e){return t(e,n)}},_=O(rk,"h"),T=O(rk,"v"),E=O(uk,-90),B=O(uk,90),A=function(t,n){var e,o;o=n,f(e=t),l(e,Hk.tempTransform(),{transform:o}),d(e)},M=[h(),v(),i("flip-horizontally","Flip horizontally",(function(t){A(t,_)}),!1),i("flip-vertically","Flip vertically",(function(t){A(t,T)}),!1),i("rotate-left","Rotate counterclockwise",(function(t){A(t,E)}),!1),i("rotate-right","Rotate clockwise",(function(t){A(t,B)}),!1),v(),b()],D=Pb.sketch({dom:c,components:M.map((function(t){return t.asSpec()})),containerBehaviours:Da([Tm("image-tools-fliprotate-buttons-events",[Go(jk.disable(),(function(t,n){u(M,t)})),Go(jk.enable(),(function(t,n){a(M,t)}))])])}),F=function(t,n,r,i,u){var a=Lw.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:o.translate(t)}}),c=Lw.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),s=Lw.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Bg(Lw.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:r,maxX:u,getInitialValue:e({x:i})},components:[a,c,s],sliderBehaviours:Da([Dm.config({})]),onChoose:n}))},I=function(t,n,e,o,r){var i=function(t,n,e,o,r){return[h(),(i=n,F(t,(function(t,n,e){var o=O(i,e.x/100);m(t,o)}),e,o,r)),b()];var i}(t,n,e,o,r);return Pb.sketch({dom:c,components:i.map((function(t){return t.asSpec()})),containerBehaviours:Da([Tm("image-tools-filter-panel-buttons-events",[Go(jk.disable(),(function(t,n){u(i,t)})),Go(jk.enable(),(function(t,n){a(i,t)}))])])})},R=[h(),v(),b()],V=Pb.sketch({dom:c,components:R.map((function(t){return t.asSpec()}))}),P=I("Brightness",ek,-100,0,100),H=I("Contrast",ok,-100,0,100),z=I("Gamma",nk,-100,0,100),N=function(t){return F(t,(function(t,n,e){var o=L.getOpt(t),r=U.getOpt(t),i=j.getOpt(t);o.each((function(n){r.each((function(e){i.each((function(o){var r,i,u,a=al.getValue(n).x/100,c=al.getValue(o).x/100,s=al.getValue(e).x/100,l=(r=a,i=c,u=s,function(t){return function(t,n,e,o){return US(t,(r=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],u=e,a=o,i=NS(i=n,0,2),u=NS(u,0,2),a=NS(a,0,2),jS(r,[i,0,0,0,0,0,u,0,0,0,0,0,a,0,0,0,0,0,1,0,0,0,0,0,1])));var r,i,u,a}(t,r,i,u)});m(t,l)}))}))}))}),0,100,200)},L=N("R"),j=N("G"),U=N("B"),W=[h(),L,j,U,b()],G=Pb.sketch({dom:c,components:W.map((function(t){return t.asSpec()}))}),X=function(t,n,e){return function(o){l(o,Hk.swap(),{transform:n,swap:function(){Q.getOpt(o).each((function(n){_m.set(n,[t]),e(n)}))}})}},Y=w.some(tk),q=w.some(ZS),K=[i("crop","Crop",X(x,w.none(),(function(t){n.showCrop()})),!1),i("resize","Resize",X(C,w.none(),(function(t){S.getOpt(t).each((function(t){var e=n.getMeasurements(),o=e.width,r=e.height;al.setValue(t,{width:o,height:r})}))})),!1),i("orientation","Orientation",X(D,w.none(),s),!1),i("brightness","Brightness",X(P,w.none(),s),!1),i("sharpen","Sharpen",X(V,Y,s),!1),i("contrast","Contrast",X(H,w.none(),s),!1),i("color-levels","Color levels",X(G,w.none(),s),!1),i("gamma","Gamma",X(z,w.none(),s),!1),i("invert","Invert",X(V,q,s),!1)],J=Pb.sketch({dom:c,components:K.map((function(t){return t.asSpec()}))}),$=Pb.sketch({dom:{tag:"div"},components:[J],containerBehaviours:Da([_m.config({})])}),Q=Bg($);return{memContainer:Q,getApplyButton:function(t){return Q.getOpt(t).map((function(t){var n=t.components()[0];return n.components()[n.components().length-1]}))}}},Wk=tinymce.util.Tools.resolve("tinymce.geom.Rect"),Gk=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),Xk=tinymce.util.Tools.resolve("tinymce.util.Observable"),Yk=tinymce.util.Tools.resolve("tinymce.util.VK"),qk=function(t){var n,e;if(t.changedTouches)for(n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]};var Kk,Jk,$k,Qk=0,Zk=function(t,n,e,o,r){var i,u="tox-",a="tox-crid-"+Qk++,c=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],s=["top","right","bottom","left"],l=function(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}},f=function(n,o,r,i){var u,a=o.x,c=o.y,s=o.w,f=o.h;a+=r*n.deltaX,c+=i*n.deltaY,(s+=r*n.deltaW)<20&&(s=20),(f+=i*n.deltaH)<20&&(f=20),u=t=Wk.clamp({x:a,y:c,w:s,h:f},e,"move"===n.name),u=l(e,u),p.fire("updateRect",{rect:u}),g(u)},d=function(t){var e=function(t,n){n.h<0&&(n.h=0),n.w<0&&(n.w=0),Gk("#"+a+"-"+t,o).css({left:n.x,top:n.y,width:n.w,height:n.h})};rS.each(c,(function(n){Gk("#"+a+"-"+n.name,o).css({left:t.w*n.xMul+t.x,top:t.h*n.yMul+t.y})})),e("top",{x:n.x,y:n.y,w:n.w,h:t.y-n.y}),e("right",{x:t.x+t.w,y:t.y,w:n.w-t.x-t.w+n.x,h:t.h}),e("bottom",{x:n.x,y:t.y+t.h,w:n.w,h:n.h-t.y-t.h+n.y}),e("left",{x:n.x,y:t.y,w:t.x-n.x,h:t.h}),e("move",t)},m=function(n){d(t=n)},g=function(t){var n,o;m((n=e,{x:(o=t).x+n.x,y:o.y+n.y,w:o.w,h:o.h}))};Gk('<div id="'+a+'" class="'+u+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),rS.each(s,(function(t){Gk("#"+a,o).append('<div id="'+a+"-"+t+'"class="'+u+'croprect-block" style="display: none" data-mce-bogus="all">')})),rS.each(c,(function(t){Gk("#"+a,o).append('<div id="'+a+"-"+t.name+'" class="'+u+"croprect-handle "+u+"croprect-handle-"+t.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+t.label+'" aria-grabbed="false" title="'+t.label+'">')})),i=rS.map(c,(function(n){var e;return function(t,n){var e,o,r,i,u=n.document||document,a=u.getElementById(n.handle||t),c=function(t){if(qk(t),t.button!==o)return s(t);t.deltaX=t.screenX-r,t.deltaY=t.screenY-i,t.preventDefault(),n.drag(t)},s=function(t){qk(t),Gk(u).off("mousemove touchmove",c).off("mouseup touchend",s),e.remove(),n.stop&&n.stop(t)};return Gk(a).on("mousedown touchstart",(function(t){var l,f,d,m,g,p,h,v,b,y,x=(l=u,f=Math.max,d=l.documentElement,m=l.body,g=f(d.scrollWidth,m.scrollWidth),p=f(d.clientWidth,m.clientWidth),h=f(d.offsetWidth,m.offsetWidth),v=f(d.scrollHeight,m.scrollHeight),b=f(d.clientHeight,m.clientHeight),{width:g<h?p:g,height:v<f(d.offsetHeight,m.offsetHeight)?b:v});qk(t),t.preventDefault(),o=t.button;var w=a;r=t.screenX,i=t.screenY,y=window.getComputedStyle?window.getComputedStyle(w,null).getPropertyValue("cursor"):w.runtimeStyle.cursor,e=Gk("<div></div>").css({position:"absolute",top:0,left:0,width:x.width,height:x.height,zIndex:2147483647,opacity:1e-4,cursor:y}).appendTo(u.body),Gk(u).on("mousemove touchmove",c).on("mouseup touchend",s),n.start(t)})),{destroy:function(){Gk(a).off()}}}(a,{document:o.ownerDocument,handle:a+"-"+n.name,start:function(){e=t},drag:function(t){f(n,e,t.deltaX,t.deltaY)}})})),d(t),Gk(o).on("focusin focusout",(function(t){Gk(t.target).attr("aria-grabbed","focus"===t.type?"true":"false")})),Gk(o).on("keydown",(function(n){var e;rS.each(c,(function(t){if(n.target.id===a+"-"+t.name)return e=t,!1}));var o=function(t,n,o,r,i){t.stopPropagation(),t.preventDefault(),f(e,o,r,i)};switch(n.keyCode){case Yk.LEFT:o(n,0,t,-10,0);break;case Yk.RIGHT:o(n,0,t,10,0);break;case Yk.UP:o(n,0,t,0,-10);break;case Yk.DOWN:o(n,0,t,0,10);break;case Yk.ENTER:case Yk.SPACEBAR:n.preventDefault(),r()}}));var p=rS.extend({toggleVisibility:function(t){var n=rS.map(c,(function(t){return"#"+a+"-"+t.name})).concat(rS.map(s,(function(t){return"#"+a+"-"+t}))).join(",");t?Gk(n,o).show():Gk(n,o).hide()},setClampRect:function(n){e=n,d(t)},setRect:m,getInnerRect:function(){return l(e,t)},setInnerRect:g,setViewPortRect:function(e){n=e,d(t)},destroy:function(){rS.each(i,(function(t){t.destroy()})),i=[]}},Xk);return p},tC=function(t,n,e,o,r){return Ok({name:t,icon:w.some(n),disabled:e,tooltip:w.some(t),primary:!1,borderless:!1},o,r)},nC=function(t,n){n?Sh.enable(t):Sh.disable(t)},eC=function(n,e){var o,r,i,u=function(n){var e,o,r,i,u=Zn(n),a=Zn(w.none()),c=(o=-1,{data:e=[],add:function(t){var n=e.splice(++o);return e.push(t),{state:t,removed:n}},undo:function(){if(r())return e[--o]},redo:function(){if(i())return e[++o]},canUndo:r=function(){return 0<o},canRedo:i=function(){return-1!==o&&o<e.length-1}});c.add(n);var s=function(t){u.set(t)},l=function(t){return{blob:t,url:URL.createObjectURL(t)}},f=function(t){URL.revokeObjectURL(t.url)},d=function(){a.get().each(f),a.set(w.none())},m=function(t){var n,e=l(t);return s(e),n=c.add(e).removed,rS.each(n,f),e.url};return{getBlobState:function(){return u.get()},setBlobState:s,addBlobState:m,getTempState:function(){return a.get().fold((function(){return u.get()}),(function(t){return t}))},updateTempState:function(t){var n=l(t);return d(),a.set(w.some(n)),n.url},addTempState:function(t){var n=l(t);return a.set(w.some(n)),n.url},applyTempState:function(n){return a.get().fold(t,(function(t){m(t.blob),n()}))},destroyTempState:d,undo:function(){var t=c.undo();return s(t),t.url},redo:function(){var t=c.redo();return s(t),t.url},getHistoryStates:function(){return{undoEnabled:c.canUndo(),redoEnabled:c.canRedo()}}}}(n.currentState),a=function(t){var n=u.getHistoryStates();h.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),Po(t,jk.formActionEvent,{name:jk.saveState(),value:n.undoEnabled})},c=function(t){return t.toBlob()},s=function(t){Po(t,jk.formActionEvent,{name:jk.disable(),value:{}})},l=function(t){v.getApplyButton(t).each((function(t){Sh.enable(t)})),Po(t,jk.formActionEvent,{name:jk.enable(),value:{}})},f=function(t,n){return s(t),p.updateSrc(t,n)},d=function(t,n,e,o,r){return s(t),zS(n).then(e).then(c).then(o).then((function(n){return f(t,n).then((function(n){return a(t),r(),l(t),n}))})).catch((function(n){return console.log(n),l(t),n}))},m=function(t,n,e){var o=u.getBlobState().blob;d(t,o,n,(function(t){return u.updateTempState(t)}),e)},g=function(t){var n=u.getBlobState().url;return u.destroyTempState(),a(t),n},p=function(n){var e=Bg({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),o=Zn(1),r=Zn(w.none()),i=Zn({x:0,y:0,w:1,h:1}),u=Zn({x:0,y:0,w:1,h:1}),a=function(t,n){l.getOpt(t).each((function(t){var u=o.get(),a=ou(t.element),c=Ki(t.element),s=n.dom.naturalWidth*u,l=n.dom.naturalHeight*u,f=Math.max(0,a/2-s/2),d=Math.max(0,c/2-l/2),m={left:f.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:l.toString()+"px",position:"absolute"};Bi(n,m),e.getOpt(t).each((function(t){Bi(t.element,m)})),r.get().each((function(t){var n=i.get();t.setRect({x:n.x*u+f,y:n.y*u+d,w:n.w*u,h:n.h*u}),t.setClampRect({x:f,y:d,w:s,h:l}),t.setViewPortRect({x:0,y:0,w:a,h:c})}))}))},c=function(t,n){var e,r=ee("img");return Rr(r,"src",n),e=r.dom,new Gg((function(t){var n=function(){e.removeEventListener("load",n),t(e)};e.complete?t(e):e.addEventListener("load",n)})).then((function(){return l.getOpt(t).map((function(t){var n=Ui({element:r});_m.replaceAt(t,1,w.some(n));var e=u.get(),c={x:0,y:0,w:r.dom.naturalWidth,h:r.dom.naturalHeight};u.set(c);var s,f,d=Wk.inflate(c,-20,-20);return i.set(d),e.w===c.w&&e.h===c.h||(s=t,f=r,l.getOpt(s).each((function(t){var n=ou(t.element),e=Ki(t.element),r=f.dom.naturalWidth,i=f.dom.naturalHeight,u=Math.min(n/r,e/i);1<=u?o.set(1):o.set(u)}))),a(t,r),r}))}))},s=Pb.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[e.asSpec(),{dom:{tag:"img",attributes:{src:n}}},{dom:{tag:"div"},behaviours:Da([Tm("image-panel-crop-events",[Qo((function(n){l.getOpt(n).each((function(n){var e=n.element.dom,u=Zk({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},e,t);u.toggleVisibility(!1),u.on("updateRect",(function(t){var n=t.rect,e=o.get(),r={x:Math.round(n.x/e),y:Math.round(n.y/e),w:Math.round(n.w/e),h:Math.round(n.h/e)};i.set(r)})),r.set(w.some(u))}))}))])])}],containerBehaviours:Da([_m.config({}),Tm("image-panel-events",[Qo((function(t){c(t,n)}))])])}),l=Bg(s);return{memContainer:l,updateSrc:c,zoom:function(t,n){var e=o.get(),r=0<n?Math.min(2,e+.1):Math.max(.1,e-.1);o.set(r),l.getOpt(t).each((function(t){var n=t.components()[1].element;a(t,n)}))},showCrop:function(){r.get().each((function(t){t.toggleVisibility(!0)}))},hideCrop:function(){r.get().each((function(t){t.toggleVisibility(!1)}))},getRect:function(){return i.get()},getMeasurements:function(){var t=u.get();return{width:t.w,height:t.h}}}}(n.currentState.url),h=(r=Bg(tC("Undo","undo",!0,(function(t){Po(t,Hk.undo(),{direction:1})}),o=e)),i=Bg(tC("Redo","redo",!0,(function(t){Po(t,Hk.redo(),{direction:1})}),o)),{container:Pb.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[r.asSpec(),i.asSpec(),tC("Zoom in","zoom-in",!1,(function(t){Po(t,Hk.zoom(),{direction:1})}),o),tC("Zoom out","zoom-out",!1,(function(t){Po(t,Hk.zoom(),{direction:-1})}),o)]}),updateButtonUndoStates:function(t,n,e){r.getOpt(t).each((function(t){nC(t,n)})),i.getOpt(t).each((function(t){nC(t,e)}))}}),v=Uk(p,e);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[v.memContainer.asSpec(),p.memContainer.asSpec(),h.container],behaviours:Da([al.config({store:{mode:"manual",getValue:function(){return u.getBlobState()}}}),Tm("image-tools-events",[Go(Hk.undo(),(function(t,n){var e=u.undo();f(t,e).then((function(n){l(t),a(t)}))})),Go(Hk.redo(),(function(t,n){var e=u.redo();f(t,e).then((function(n){l(t),a(t)}))})),Go(Hk.zoom(),(function(t,n){var e=n.event.direction;p.zoom(t,e)})),Go(Hk.back(),(function(t,n){var e,o;o=g(e=t),f(e,o).then((function(t){l(e)})),(0,n.event.swap)(),p.hideCrop()})),Go(Hk.apply(),(function(t,n){u.applyTempState((function(){g(t),(0,n.event.swap)()}))})),Go(Hk.transform(),(function(n,e){return m(n,e.event.transform,t)})),Go(Hk.tempTransform(),(function(n,e){return o=n,r=e.event.transform,i=u.getTempState().blob,void d(o,i,r,(function(t){return u.addTempState(t)}),t);var o,r,i})),Go(Hk.transformApply(),(function(t,n){return e=t,o=n.event.transform,r=n.event.swap,i=u.getBlobState().blob,void d(e,i,o,(function(t){var n=u.addBlobState(t);return g(e),n}),r);var e,o,r,i})),Go(Hk.swap(),(function(t,n){var e;e=t,h.updateButtonUndoStates(e,!1,!1);var o=n.event.transform,r=n.event.swap;o.fold((function(){r()}),(function(n){m(t,n,r)}))}))]),Qw()])}},oC=function(t){return!Et(t,"items")},rC="data-value",iC=function(t,n,e,o){return L(e,(function(e){return oC(e)?{type:"togglemenuitem",text:e.text,value:e.value,active:e.value===o,onAction:function(){al.setValue(t,e.value),Po(t,Jb,{name:n}),Dm.focus(t)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:function(){return iC(t,n,e.items,o)}}}))},uC=function(t,n){return it(t,(function(t){return oC(t)?mf(t.value===n,t):uC(t.items,n)}))},aC=lf({name:"HtmlSelect",configFields:[Bn("options"),cl("selectBehaviours",[Dm,al]),Un("selectClasses",[]),Un("selectAttributes",{}),Pn("data")],factory:function(t,n){var e=L(t.options,(function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}})),o=t.data.map((function(t){return Ut("initialValue",t)})).getOr({});return{uid:t.uid,dom:{tag:"select",classes:t.selectClasses,attributes:t.selectAttributes},components:e,behaviours:ll(t.selectBehaviours,[Dm.config({}),al.config({store:l({mode:"manual",getValue:function(t){return Pi(t.element)},setValue:function(n,e){Y(t.options,(function(t){return t.value===e})).isSome()&&Hi(n.element,e)}},o)})])}}}),cC=function(t,n){var o=t.label.map((function(t){return Kb(t,n)})),r=[Sh.config({disabled:function(){return t.disabled||n.isDisabled()}}),$h(),wm.config({mode:"execution",useEnter:!0!==t.multiline,useControlEnter:!0===t.multiline,execute:function(t){return Vo(t,ty),w.some(!0)}}),Tm("textfield-change",[Go(oo(),(function(n,e){Po(n,Jb,{name:t.name})})),Go(mo(),(function(n,e){Po(n,Jb,{name:t.name})}))]),Wb.config({})],i=t.validation.map((function(t){return By.config({getRoot:function(t){return dr(t.element)},invalidClass:"tox-invalid",validator:{validate:function(n){var e=al.getValue(n),o=t.validator(e);return yy(!0===o?ct.value(e):ct.error(o))},validateOnLoad:t.validateOnLoad}})})).toArray(),u=t.placeholder.fold(e({}),(function(t){return{placeholder:n.translate(t)}})),a=t.inputMode.fold(e({}),(function(t){return{inputmode:t}})),c=l(l({},u),a),s=Lb.parts.field({tag:!0===t.multiline?"textarea":"input",inputAttributes:c,inputClasses:[t.classname],inputBehaviours:Da(K([r,i])),selectOnFocus:!1,factory:cy}),f=(t.flex?["tox-form__group--stretched"]:[]).concat(t.maximized?["tox-form-group--maximize"]:[]),d=[Sh.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){Lb.getField(t).each(Sh.disable)},onEnabled:function(t){Lb.getField(t).each(Sh.enable)}}),$h()];return Xb(o,s,f,d)},sC=Object.freeze({__proto__:null,events:function(t,n){var e=t.stream.streams.setup(t,n);return jo([Go(t.event,e),Zo((function(){return n.cancel()}))].concat(t.cancelEvent.map((function(t){return[Go(t,(function(){return n.cancel()}))]})).getOr([])))}}),lC=function(t){var n=Zn(null);return ai({readState:function(){return{timer:null!==n.get()?"set":"unset"}},setTimer:function(t){n.set(t)},cancel:function(){var t=n.get();null!==t&&t.cancel()}})},fC=Object.freeze({__proto__:null,throttle:lC,init:function(t){return t.stream.streams.state(t)}}),dC=[An("stream",yn("mode",{throttle:[Bn("delay"),Un("stopEvent",!0),Yu("streams",{setup:function(t,n){var e=t.stream,o=Vg(t.onStream,e.delay);return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},state:lC})]})),Un("event","input"),Pn("cancelEvent"),Gu("onStream")],mC=Ia({fields:dC,name:"streaming",active:sC,state:fC}),gC=function(t,n,e){var o=al.getValue(e);al.setValue(n,o),hC(n)},pC=function(t,n){var e=t.element,o=Pi(e),r=e.dom;"number"!==Vr(e,"type")&&n(r,o)},hC=function(t){pC(t,(function(t,n){return t.setSelectionRange(n.length,n.length)}))},vC=e("alloy.typeahead.itemexecute"),bC=e([Pn("lazySink"),Bn("fetch"),Un("minChars",5),Un("responseTime",1e3),Uu("onOpen"),Un("getHotspot",w.some),Un("getAnchorOverrides",e({})),Un("layouts",w.none()),Un("eventOrder",{}),$n("model",{},[Un("getDisplayText",(function(t){return void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.value})),Un("selectsOver",!0),Un("populateFromBrowse",!0)]),Uu("onSetValue"),Wu("onExecute"),Uu("onItemExecute"),Un("inputClasses",[]),Un("inputAttributes",{}),Un("inputStyles",{}),Un("matchWidth",!0),Un("useMinWidth",!1),Un("dismissOnBlur",!0),Lu(["openClass"]),Pn("initialData"),cl("typeaheadBehaviours",[Dm,al,mC,wm,Wm,Dy]),Qn("previewing",(function(){return Zn(!0)}))].concat(iy()).concat(Ky())),yC=e([Vl({schema:[Nu()],name:"menu",overrides:function(t){return{fakeFocus:!0,onHighlight:function(n,e){t.previewing.get()?n.getSystem().getByUid(t.uid).each((function(o){(function(t,n,e){if(t.selectsOver){var o=al.getValue(n),r=t.getDisplayText(o),i=al.getValue(e);return 0===t.getDisplayText(i).indexOf(r)?w.some((function(){var t,o;gC(0,n,e),t=n,o=r.length,pC(t,(function(t,n){return t.setSelectionRange(o,n.length)}))})):w.none()}return w.none()})(t.model,o,e).fold((function(){return Tf.dehighlight(n,e)}),(function(t){return t()}))})):n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&gC(t.model,n,e)})),t.previewing.set(!1)},onExecute:function(n,e){return n.getSystem().getByUid(t.uid).toOptional().map((function(t){return Po(t,vC(),{item:e}),!0}))},onHover:function(n,e){t.previewing.set(!1),n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&gC(t.model,n,e)}))}}}})]),xC=ff({name:"Typeahead",configFields:bC(),partFields:yC(),factory:function(n,e,o,r){var i=function(e,o,i){n.previewing.set(!1);var u=Dy.getCoupled(e,"sandbox");Ls.isOpen(u)?vf.getCurrent(u).each((function(t){Tf.getHighlighted(t).fold((function(){i(t)}),(function(){Lo(u,t.element,"keydown",o)}))})):jy(n,a(e),e,u,r,(function(t){vf.getCurrent(t).each(i)}),fy.HighlightFirst).get(t)},u=uy(n),a=function(t){return function(n){return n.map((function(n){var e=_t(n.menus),o=J(e,(function(t){return W(t.items,(function(t){return"item"===t.type}))}));return al.getState(t).update(L(o,(function(t){return t.data}))),n}))}},c=[Dm.config({}),al.config({onSetValue:n.onSetValue,store:l({mode:"dataset",getDataKey:function(t){return Pi(t.element)},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(t,e){Hi(t.element,n.model.getDisplayText(e))}},n.initialData.map((function(t){return Ut("initialValue",t)})).getOr({}))}),mC.config({stream:{mode:"throttle",delay:n.responseTime,stopEvent:!1},onStream:function(e,o){var i,u=Dy.getCoupled(e,"sandbox");Dm.isFocused(e)&&Pi(e.element).length>=n.minChars&&(i=vf.getCurrent(u).bind((function(t){return Tf.getHighlighted(t).map(al.getValue)})),n.previewing.set(!0),jy(n,a(e),e,u,r,(function(t){vf.getCurrent(u).each((function(t){i.fold((function(){n.model.selectsOver&&Tf.highlightFirst(t)}),(function(n){Tf.highlightBy(t,(function(t){return al.getValue(t).value===n.value})),Tf.getHighlighted(t).orThunk((function(){return Tf.highlightFirst(t),w.none()}))}))}))}),fy.HighlightFirst).get(t))},cancelEvent:xo()}),wm.config({mode:"special",onDown:function(t,n){return i(t,n,Tf.highlightFirst),w.some(!0)},onEscape:function(t){var n=Dy.getCoupled(t,"sandbox");return Ls.isOpen(n)?(Ls.close(n),w.some(!0)):w.none()},onUp:function(t,n){return i(t,n,Tf.highlightLast),w.some(!0)},onEnter:function(t){var e=Dy.getCoupled(t,"sandbox"),o=Ls.isOpen(e);if(o&&!n.previewing.get())return vf.getCurrent(e).bind((function(t){return Tf.getHighlighted(t)})).map((function(n){return Po(t,vC(),{item:n}),!0}));var r=al.getValue(t);return Vo(t,xo()),n.onExecute(e,t,r),o&&Ls.close(e),w.some(!0)}}),Wm.config({toggleClass:n.markers.openClass,aria:{mode:"expanded"}}),Dy.config({others:{sandbox:function(t){return Yy(n,t,{onOpen:function(){return Wm.on(t)},onClose:function(){return Wm.off(t)}})}}}),Tm("typeaheadevents",[nr((function(e){var o=t;Wy(n,a(e),e,r,o,fy.HighlightFirst).get(t)})),Go(vC(),(function(t,e){var o=Dy.getCoupled(t,"sandbox");gC(n.model,t,e.event.item),Vo(t,xo()),n.onItemExecute(t,o,e.event.item,al.getValue(t)),Ls.close(o),hC(t)}))].concat(n.dismissOnBlur?[Go(fo(),(function(t){var n=Dy.getCoupled(t,"sandbox");ja(n.element).isNone()&&Ls.close(n)}))]:[]))];return{uid:n.uid,dom:ay(Ft(n,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:l(l({},u),ll(n.typeaheadBehaviours,c)),eventOrder:n.eventOrder}}}),wC=function(t){return l(l({},t),{toCached:function(){return wC(t.toCached())},bindFuture:function(n){return wC(t.bind((function(t){return t.fold((function(t){return yy(ct.error(t))}),(function(t){return n(t)}))})))},bindResult:function(n){return wC(t.map((function(t){return t.bind(n)})))},mapResult:function(n){return wC(t.map((function(t){return t.map(n)})))},mapError:function(n){return wC(t.map((function(t){return t.mapError(n)})))},foldResult:function(n,e){return t.map((function(t){return t.fold(n,e)}))},withTimeout:function(n,e){return wC(by((function(o){var r=!1,i=setTimeout((function(){r=!0,o(ct.error(e()))}),n);t.get((function(t){r||(clearTimeout(i),o(t))}))})))}})},SC=function(t){return wC(by(t))},kC={type:"separator"},CC=function(n){return{type:"menuitem",value:n.url,text:n.title,meta:{attach:n.attach},onAction:t}},OC=function(n,e){return{type:"menuitem",value:e,text:n,meta:{attach:void 0},onAction:t}},_C=function(t,n){return o=t,e=W(n,(function(t){return t.type===o})),L(e,CC);var e,o},TC=function(t,n){var e=t.toLowerCase();return W(n,(function(t){var n=void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.text;return le(n.toLowerCase(),e)||le(t.value.toLowerCase(),e)}))},EC=Wr("aria-invalid"),BC=function(n,e,o){var r,i,u,a,c,s=e.shared.providers,f=function(t){var e=al.getValue(t);o.addToHistory(e.value,n.filetype)},d=Lb.parts.field({factory:xC,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":EC,type:"url"},minChars:0,responseTime:0,fetch:function(t){var r=function(t,n,e){var o=al.getValue(n),r=void 0!==o.meta.text?o.meta.text:o.value;return e.getLinkInformation().fold((function(){return[]}),(function(n){var o,i,u,a,c=TC(r,(o=e.getHistory(t),L(o,(function(t){return OC(t,t)}))));return"file"===t?(i=[c,TC(r,_C("header",n.targets)),TC(r,K([(a=n,w.from(a.anchorTop).map((function(t){return OC("<top>",t)})).toArray()),_C("anchor",n.targets),(u=n,w.from(u.anchorBottom).map((function(t){return OC("<bottom>",t)})).toArray())]))],X(i,(function(t,n){return 0===t.length||0===n.length?t.concat(n):t.concat(kC,n)}),[])):c}))}(n.filetype,t,o),i=yk(r,pp.BUBBLE_TO_SANDBOX,e,!1);return yy(i)},getHotspot:function(t){return b.getOpt(t)},onSetValue:function(n,e){n.hasConfigured(By)&&By.run(n).get(t)},typeaheadBehaviours:Da(K([o.getValidationHandler().map((function(t){return By.config({getRoot:function(t){return dr(t.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){g.getOpt(t).each((function(t){Rr(t.element,"title",s.translate(n))}))}},validator:{validate:function(e){var o=al.getValue(e);return SC((function(e){t({type:n.filetype,url:o.value},(function(t){var n,o;"invalid"===t.status?(n=ct.error(t.message),e(n)):(o=ct.value(t.message),e(o))}))}))},validateOnLoad:!1}})})).toArray(),[Sh.config({disabled:function(){return n.disabled||s.isDisabled()}}),Wb.config({}),Tm("urlinput-events",K(["file"===n.filetype?[Go(oo(),(function(t){Po(t,Jb,{name:n.name})}))]:[],[Go(ro(),(function(t){Po(t,Jb,{name:n.name}),f(t)})),Go(mo(),(function(t){Po(t,Jb,{name:n.name}),f(t)}))]]))]])),eventOrder:((r={})[oo()]=["streaming","urlinput-events","invalidating"],r),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:e.shared.getSink,parts:{menu:Ap(0,0,"normal")},onExecute:function(t,n,e){Po(n,ty,{})},onItemExecute:function(t,e,o,r){f(t),Po(t,Jb,{name:n.name})}}),m=n.label.map((function(t){return Kb(t,s)})),g=Bg((i="invalid",u=w.some(EC),void 0===(a="warning")&&(a=i),void 0===c&&(c=i),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+i],innerHtml:Mg(a,s.icons),attributes:l({title:s.translate(c),"aria-live":"polite"},u.fold((function(){return{}}),(function(t){return{id:t}})))}})),p=Bg({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[g.asSpec()]}),h=o.getUrlPicker(n.filetype),v=Wr("browser.url.event"),b=Bg({dom:{tag:"div",classes:["tox-control-wrap"]},components:[d,p.asSpec()],behaviours:Da([Sh.config({disabled:function(){return n.disabled||s.isDisabled()}})])}),y=Bg(Tk({name:n.name,icon:w.some("browse"),text:n.label.getOr(""),disabled:n.disabled,primary:!1,borderless:!0},(function(t){return Vo(t,v)}),s,[],["tox-browse-url"]));return Lb.sketch({dom:qb([]),components:m.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:K([[b.asSpec()],h.map((function(){return y.asSpec()})).toArray()])}]),fieldBehaviours:Da([Sh.config({disabled:function(){return n.disabled||s.isDisabled()},onDisabled:function(t){Lb.getField(t).each(Sh.disable),y.getOpt(t).each(Sh.disable)},onEnabled:function(t){Lb.getField(t).each(Sh.enable),y.getOpt(t).each(Sh.enable)}}),$h(),Tm("url-input-events",[Go(v,(function(t){vf.getCurrent(t).each((function(e){var o=al.getValue(e),r=l({fieldname:n.name},o);h.each((function(o){o(r).get((function(o){al.setValue(e,o),Po(t,Jb,{name:n.name})}))}))}))}))])])})},AC=function(t){return function(n,e,o){return Tt(e,"name").fold((function(){return t(e,o)}),(function(r){return n.field(r,t(e,o))}))}},MC={bar:AC((function(t,n){return e=t,o=n.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:L(e.items,o.interpreter)};var e,o})),collection:AC((function(t,n){return function(t,n){var e,r,i=t.label.map((function(t){return Kb(t,n)})),u=function(t){return function(n,e){Tu(e.event.target,"[data-collection-item-value]").each((function(o){t(n,e,o,Vr(o,"data-collection-item-value"))}))}},a=u((function(e,o,r,i){o.stop(),n.isDisabled()||Po(e,Zb,{name:t.name,value:i})})),c=[Go(Qe(),u((function(t,n,e){Na(e)}))),Go(io(),a),Go(vo(),a),Go(Ze(),u((function(t,n,e){_u(t.element,"."+kp).each((function(t){bi(t,kp)})),vi(e,kp)}))),Go(to(),u((function(t){_u(t.element,"."+kp).each((function(t){bi(t,kp)}))}))),nr(u((function(n,e,o,r){Po(n,Zb,{name:t.name,value:r})})))],s=function(t,n){return L(Yc(t.element,".tox-collection__item"),n)},l=Lb.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==t.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:o},behaviours:Da([Sh.config({disabled:n.isDisabled,onDisabled:function(t){s(t,(function(t){vi(t,"tox-collection__item--state-disabled"),Rr(t,"aria-disabled",!0)}))},onEnabled:function(t){s(t,(function(t){bi(t,"tox-collection__item--state-disabled"),zr(t,"aria-disabled")}))}}),$h(),_m.config({}),al.config({store:{mode:"memory",initialValue:[]},onSetValue:function(e,o){var r,i,u,a;r=e,i=L(o,(function(e){var o=ch.translate(e.text),r=1===t.columns?'<div class="tox-collection__item-label">'+o+"</div>":"",i='<div class="tox-collection__item-icon">'+e.icon+"</div>",u={_:" "," - ":" ","-":" "},a=o.replace(/\_| \- |\-/g,(function(t){return u[t]}));return'<div class="tox-collection__item'+(n.isDisabled()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+Gb.encodeAllRaw(e.value)+'" title="'+a+'" aria-label="'+a+'">'+i+r+"</div>"})),u="auto"!==t.columns&&1<t.columns?N(i,t.columns):[i],a=L(u,(function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"})),Fr(r.element,a.join("")),"auto"===t.columns&&$p(e,5,"tox-collection__item").each((function(t){var n=t.numRows,o=t.numColumns;wm.setGridSize(e,n,o)})),Vo(e,ry)}}),Wb.config({}),wm.config((r=t.columns,1===r?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===r?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:".tox-collection__group",cell:"."+vp}})),Tm("collection-events",c)]),eventOrder:((e={})[po()]=["disabling","alloy.base.behaviour","collection-events"],e)});return Xb(i,l,["tox-form__group--collection"],[])}(t,n.shared.providers)})),alertbanner:AC((function(t,n){return e=t,o=n.shared.providers,Pb.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+e.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[Eg.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:Mg(e.icon,o.icons),attributes:{title:o.translate(e.iconTooltip)}},action:function(t){Po(t,Zb,{name:"alert-banner",value:e.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:o.translate(e.text)}}]});var e,o})),input:AC((function(t,n){return e=t,o=n.shared.providers,cC({name:e.name,multiline:!1,label:e.label,inputMode:e.inputMode,placeholder:e.placeholder,flex:!1,disabled:e.disabled,classname:"tox-textfield",validation:w.none(),maximized:e.maximized},o);var e,o})),textarea:AC((function(t,n){return e=t,o=n.shared.providers,cC({name:e.name,multiline:!0,label:e.label,inputMode:w.none(),placeholder:e.placeholder,flex:!0,disabled:e.disabled,classname:"tox-textarea",validation:w.none(),maximized:e.maximized},o);var e,o})),label:AC((function(t,n){return e=t,r={dom:{tag:"label",innerHtml:(o=n.shared).providers.translate(e.label),classes:["tox-label"]}},i=L(e.items,o.interpreter),{dom:{tag:"div",classes:["tox-form__group"]},components:[r].concat(i),behaviours:Da([Qw(),_m.config({}),sS(w.none()),wm.config({mode:"acyclic"})])};var e,o,r,i})),iframe:(Kk=function(t,n){return function(t,n){var e,o,r=bS&&t.sandboxed,i=l(l({},t.label.map((function(t){return{title:t}})).getOr({})),r?{sandbox:"allow-scripts allow-same-origin"}:{}),u=(e=r,o=Zn(""),{getValue:function(t){return o.get()},setValue:function(t,n){var r;e?Rr(t.element,"srcdoc",n):(Rr(t.element,"src","javascript:''"),(r=t.element.dom.contentWindow.document).open(),r.write(n),r.close()),o.set(n)}}),a=t.label.map((function(t){return Kb(t,n)})),c=Lb.parts.field({factory:{sketch:function(t){return gS({uid:t.uid,dom:{tag:"iframe",attributes:i},behaviours:Da([Wb.config({}),Dm.config({}),cS(w.none(),u.getValue,u.setValue)])})}}});return Xb(a,c,["tox-form__group--stretched"],[])}(t,n.shared.providers)},function(t,n,e){var o=Ft(n,{source:"dynamic"});return AC(Kk)(t,o,e)}),button:AC((function(t,n){return function(t,n){var e,o,r=Ek(t.name,"custom");return e=w.none(),o=Lb.parts.field(l({factory:Eg},_k(t,w.some(r),n,[lS(""),Qw()]))),Xb(e,o,[],[])}(t,n.shared.providers)})),checkbox:AC((function(t,n){return e=t,r=n.shared.providers,i=al.config({store:{mode:"manual",getValue:function(t){return t.element.dom.checked},setValue:function(t,n){t.element.dom.checked=n}}}),u=function(t){return t.element.dom.click(),w.some(!0)},a=Lb.parts.field({factory:{sketch:o},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:Da([Qw(),Sh.config({disabled:function(){return e.disabled||r.isDisabled()}}),Wb.config({}),Dm.config({}),i,wm.config({mode:"special",onEnter:u,onSpace:u,stopSpaceKeyup:!0}),Tm("checkbox-events",[Go(ro(),(function(t,n){Po(t,Jb,{name:e.name})}))])])}),c=Lb.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:r.translate(e.label)},behaviours:Da([Zy.config({})])}),l=Bg({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[(s=function(t){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t],innerHtml:Mg("checked"===t?"selected":"unselected",r.icons)}}})("checked"),s("unchecked")]}),Lb.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[a,l.asSpec(),c],fieldBehaviours:Da([Sh.config({disabled:function(){return e.disabled||r.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(t){Lb.getField(t).each(Sh.disable)},onEnabled:function(t){Lb.getField(t).each(Sh.enable)}}),$h()])});var e,r,i,u,a,c,s,l})),colorinput:AC((function(n,e){return function(n,e,o){var r,i,u=Lb.parts.field({factory:cy,inputClasses:["tox-textfield"],onSetValue:function(n){return By.run(n).get(t)},inputBehaviours:Da([Sh.config({disabled:e.providers.isDisabled}),$h(),Wb.config({}),By.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return dr(t.element)},notify:{onValid:function(t){var n=al.getValue(t);Po(t,tx,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=al.getValue(t);if(0===n.length)return yy(ct.value(!0));var e=ee("span");Ei(e,"background-color",n);var o=Fi(e,"background-color").fold((function(){return ct.error("blah")}),(function(t){return ct.value(n)}));return yy(o)}}})]),selectOnFocus:!1}),c=n.label.map((function(t){return Kb(t,e.providers)})),s=function(t,n){Po(t,nx,{value:n})},l=Bg((r={dom:{tag:"span",attributes:{"aria-label":e.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[ga,ma,ba]},onLtr:function(){return[ma,ga,ba]}},components:[],fetch:tb(o.getColors(),o.hasCustomColors()),columns:o.getColorCols(),presets:"color",onItemAction:function(t,n){l.getOpt(t).each((function(t){"custom"===n?o.colorPicker((function(n){n.fold((function(){return Vo(t,ex)}),(function(n){s(t,n),Jv(n)}))}),"#ffffff"):s(t,"remove"===n?"":n)}))}},i=e,Qy.sketch({dom:r.dom,components:r.components,toggleClass:"mce-active",dropdownBehaviours:Da([Zh(i.providers.isDisabled),$h(),Zy.config({}),Wb.config({})]),layouts:r.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:i.getSink,fetch:function(t){return by((function(t){return r.fetch(t)})).map((function(n){return w.from(bb(Ft(ib(Wr("menu-value"),n,(function(n){r.onItemAction(t,n)}),r.columns,r.presets,pp.CLOSE_ON_EXECUTE,a,i.providers),{movement:ab(r.columns,r.presets)})))}))},parts:{menu:Ap(0,0,r.presets)}})));return Lb.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:c.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[u,l.asSpec()]}]),fieldBehaviours:Da([Tm("form-field-events",[Go(tx,(function(t,e){l.getOpt(t).each((function(t){Ei(t.element,"background-color",e.event.color)})),Po(t,Jb,{name:n.name})})),Go(nx,(function(t,n){Lb.getField(t).each((function(e){al.setValue(e,n.event.value),vf.getCurrent(t).each(Dm.focus)}))})),Go(ex,(function(t,n){Lb.getField(t).each((function(n){vf.getCurrent(t).each(Dm.focus)}))}))])])})}(n,e.shared,e.colorinput)})),colorpicker:AC((function(t){var n=$w(eS,(function(t){return"tox-"+t})),e=Bg(n.sketch({dom:{tag:"div",classes:["tox-color-picker-container"],attributes:{role:"presentation"}},onValidHex:function(t){Po(t,Zb,{name:"hex-valid",value:!0})},onInvalidHex:function(t){Po(t,Zb,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[e.asSpec()],behaviours:Da([al.config({store:{mode:"manual",getValue:function(t){var n=e.get(t);return vf.getCurrent(n).bind((function(t){return al.getValue(t).hex})).map((function(t){return"#"+t})).getOr("")},setValue:function(t,n){var o=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(n),r=e.get(t);vf.getCurrent(r).fold((function(){console.log("Can not find form")}),(function(t){al.setValue(t,{hex:w.from(o[1]).getOr("")}),Gw.getField(t,"hex").each((function(t){Vo(t,oo())}))}))}}}),Qw()])}})),dropzone:AC((function(t,n){return function(t,n){var e=function(t,n){n.stop()},o=function(t){return function(n,e){j(t,(function(t){t(n,e)}))}},r=function(t,n){var e;Sh.isDisabled(t)||(e=n.event.raw,u(t,e.dataTransfer.files))},i=function(t,n){var e=n.event.raw.target;u(t,e.files)},u=function(e,o){var r,i,u;al.setValue(e,(r=o,i=n,u=rS.explode(i.getSetting("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string")),W(rt(r),(function(t){return H(u,(function(n){return fe(t.name.toLowerCase(),"."+n.toLowerCase())}))})))),Po(e,Jb,{name:t.name})},a=Bg({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:Da([Tm("input-file-events",[Jo(io()),Jo(vo())])])}),c=t.label.map((function(t){return Kb(t,n)})),s=Lb.parts.field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:Da([lS([]),Qw(),Sh.config({}),Wm.config({toggleClass:"dragenter",toggleOnExecute:!1}),Tm("dropzone-events",[Go("dragenter",o([e,Wm.toggle])),Go("dragleave",o([e,Wm.toggle])),Go("dragover",e),Go("drop",o([e,r])),Go(ro(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:n.translate("Drop an image here")}},Eg.sketch({dom:{tag:"button",innerHtml:n.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(t){a.get(t).element.dom.click()},buttonBehaviours:Da([Wb.config({}),Zh(n.isDisabled),$h()])})]}]}}}});return Xb(c,s,["tox-form__group--stretched"],[])}(t,n.shared.providers)})),grid:AC((function(t,n){return e=t,o=n.shared,{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+e.columns+"col"]},components:L(e.items,o.interpreter)};var e,o})),listbox:AC((function(n,o){return r=n,u=(i=o).shared.providers,a=et(r.items).filter(oC),c=r.label.map((function(t){return Kb(t,u)})),s={dom:{tag:"div",classes:["tox-listboxfield"]},components:[Lb.parts.field({dom:{},factory:{sketch:function(n){return pk({uid:n.uid,text:a.map((function(t){return t.text})),icon:w.none(),tooltip:r.label,role:w.none(),fetch:function(t,n){var e=iC(t,r.name,r.items,al.getValue(t));n(yk(e,pp.CLOSE_ON_EXECUTE,i,!1))},onSetup:e(t),getApi:e({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[Wb.config({}),al.config({store:{mode:"manual",initialValue:a.map((function(t){return t.value})).getOr(""),getValue:function(t){return Vr(t.element,rC)},setValue:function(t,n){uC(r.items,n).each((function(n){Rr(t.element,rC,n.value),Po(t,mk,{text:n.text})}))}}})]},"tox-listbox",i.shared)}}})]},Lb.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:K([c.toArray(),[s]]),fieldBehaviours:Da([Sh.config({disabled:e(r.disabled),onDisabled:function(t){Lb.getField(t).each(Sh.disable)},onEnabled:function(t){Lb.getField(t).each(Sh.enable)}})])});var r,i,u,a,c,s})),selectbox:AC((function(t,n){return e=t,o=n.shared.providers,r=L(e.items,(function(t){return{text:o.translate(t.text),value:t.value}})),i=e.label.map((function(t){return Kb(t,o)})),u=Lb.parts.field({dom:{},selectAttributes:{size:e.size},options:r,factory:aC,selectBehaviours:Da([Sh.config({disabled:function(){return e.disabled||o.isDisabled()}}),Wb.config({}),Tm("selectbox-change",[Go(ro(),(function(t,n){Po(t,Jb,{name:e.name})}))])])}),a=1<e.size?w.none():w.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:Mg("chevron-down",o.icons)}}),c={dom:{tag:"div",classes:["tox-selectfield"]},components:K([[u],a.toArray()])},Lb.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:K([i.toArray(),[c]]),fieldBehaviours:Da([Sh.config({disabled:function(){return e.disabled||o.isDisabled()},onDisabled:function(t){Lb.getField(t).each(Sh.disable)},onEnabled:function(t){Lb.getField(t).each(Sh.enable)}}),$h()])});var e,o,r,i,u,a,c})),sizeinput:AC((function(t,n){return Pk(t,n.shared.providers)})),urlinput:AC((function(t,n){return BC(t,n,n.urlinput)})),customeditor:AC((function(t){var n=Zn(w.none()),e=Bg({dom:{tag:t.tag}}),o=Zn(w.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:Da([Tm("custom-editor-events",[Qo((function(r){e.getOpt(r).each((function(e){var r;r=t,(Object.prototype.hasOwnProperty.call(r,"init")?t.init(e.element.dom):oS.load(t.scriptId,t.scriptUrl).then((function(n){return n(e.element.dom,t.settings)}))).then((function(t){o.get().each((function(n){t.setValue(n)})),o.set(w.none()),n.set(w.some(t))}))}))}))]),al.config({store:{mode:"manual",getValue:function(){return n.get().fold((function(){return o.get().getOr("")}),(function(t){return t.getValue()}))},setValue:function(t,e){n.get().fold((function(){o.set(w.some(e))}),(function(t){return t.setValue(e)}))}}}),Qw()]),components:[e.asSpec()]}})),htmlpanel:AC((function(t){return"presentation"===t.presets?Pb.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):Pb.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:Da([Wb.config({}),Dm.config({})])})})),imagetools:AC((function(t,n){return eC(t,n.shared.providers)})),table:AC((function(t,n){return e=t,o=n.shared.providers,u=function(t){return{dom:{tag:"th",innerHtml:o.translate(t)}}},a=function(t){return{dom:{tag:"td",innerHtml:o.translate(t)}}},c=function(t){return{dom:{tag:"tr"},components:L(t,a)}},{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(i=e.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:L(i,u)}]}),(r=e.cells,{dom:{tag:"tbody"},components:L(r,c)})],behaviours:Da([Wb.config({}),Dm.config({})])};var e,o,r,i,u,a,c})),panel:AC((function(t,n){return o=n,{dom:{tag:"div",classes:(e=t).classes},components:L(e.items,o.shared.interpreter)};var e,o}))},DC={field:function(t,n){return n}},FC=function(t,n,e){var o=Ft(e,{shared:{interpreter:function(n){return IC(t,n,o)}}});return IC(t,n,o)},IC=function(t,n,e){return Tt(MC,n.type).fold((function(){return console.error('Unknown factory type "'+n.type+'", defaulting to container: ',n),n}),(function(o){return o(t,n,e)}))},RC={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},VC=function(t,n,e){var o=cc(-12,12,RC),r={maxHeightFunction:rc()};return function(){return e()?{anchor:"node",root:wr(t()),node:w.from(t()),bubble:o,layouts:{onRtl:function(){return[Cg]},onLtr:function(){return[kg]}},overrides:r}:{anchor:"hotspot",hotspot:n(),bubble:o,layouts:{onRtl:function(){return[ma]},onLtr:function(){return[ga]}},overrides:r}}},PC=function(t,n,e){return function(){return e()?{anchor:"node",root:wr(t()),node:w.from(t()),layouts:{onRtl:function(){return[Og]},onLtr:function(){return[Og]}}}:{anchor:"hotspot",hotspot:n(),layouts:{onRtl:function(){return[ba]},onLtr:function(){return[ba]}}}}},HC=function(t,n,e){var o,r,i,u=Uh(t),a=function(){return re(t.getContentAreaContainer())},c=function(){return u||!e()};return{inlineDialog:VC(a,n,c),banner:PC(a,n,c),cursor:(r=t,function(){return{anchor:"selection",root:i(),getSelection:function(){var t=r.selection.getRng();return w.some(Pc.range(re(t.startContainer),t.startOffset,re(t.endContainer),t.endOffset))}}}),node:(o=i=function(){return re(t.getBody())},function(t){return{anchor:"node",root:o(),node:t}})}},zC=function(t){return{colorPicker:function(t,n){rb(r)(t,n)},hasCustomColors:function(){return qv(o)},getColors:function(){return Kv(e)},getColorCols:(n=e=o=r=t,function(){return $v(n)})};var n,e,o,r},NC=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],LC=function(t){return X(t,(function(t,n){if(Et(n,"items")){var e=LC(n.items);return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(Et(n,"inline")||Et(n,"block")||Et(n,"selector")){var o="custom-"+(C(n.name)?n.name:n.title.toLowerCase());return{customFormats:t.customFormats.concat([{name:o,format:n}]),formats:t.formats.concat([{title:n.title,format:o,icon:n.icon}])}}return l(l({},t),{formats:t.formats.concat(n)})}),{customFormats:[],formats:[]})},jC=function(t){return n=t,w.from(n.getParam("style_formats")).filter(_).map((function(n){var e,o,r,i=(e=t,o=LC(n),r=function(t){j(t,(function(t){e.formatter.has(t.name)||e.formatter.register(t.name,t.format)}))},e.formatter?r(o.customFormats):e.on("init",(function(){r(o.customFormats)})),o.formats);return t.getParam("style_formats_merge",!1,"boolean")?NC.concat(i):i})).getOr(NC);var n},UC=function(t,n,e){var o={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)};return Ft(t,o)},WC=function(t,n,e,o){var r=function(n){return L(n,(function(n){var i,u,a,c,s,l=yt(n);if(Bt(n,"items")){var f=r(n.items);return Ft(Ft(n,{type:"submenu"}),{getStyleItems:function(){return f}})}return Bt(n,"format")?UC(n,e,o):1===l.length&&P(l,"title")?Ft(n,{type:"separator"}):(c={type:"formatter",format:a="custom-"+(u=C((i=n).name)?i.name:Wr(i.title)),isSelected:e(a),getStylePreview:o(a)},s=Ft(i,c),t.formatter.register(u,s),s)}))};return r(n)},GC=rS.trim,XC=function(t){return function(n){if(B(e=n)&&1===e.nodeType){if(n.contentEditable===t)return!0;if(n.getAttribute("data-mce-contenteditable")===t)return!0}var e;return!1}},YC=XC("true"),qC=XC("false"),KC=function(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}},JC=function(t){return t.innerText||t.textContent},$C=function(t){return(n=t)&&"A"===n.nodeName&&void 0!==(n.id||n.name)&&ZC(t);var n},QC=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},ZC=function(t){return function(t){for(;t=t.parentNode;){var n=t.contentEditable;if(n&&"inherit"!==n)return YC(t)}return!1}(t)&&!qC(t)},tO=function(t){return QC(t)&&ZC(t)},nO=function(t){var n,e,o=(n=t).id?n.id:Wr("h");return KC("header",JC(t),"#"+o,QC(e=t)?parseInt(e.nodeName.substr(1),10):0,(function(){t.id=o}))},eO=function(n){var e=n.id||n.name,o=JC(n);return KC("anchor",o||"#"+e,"#"+e,0,t)},oO=function(t){return 0<GC(t.title).length},rO=function(t){var n=function(t){return L(Yc(re(t),"h1,h2,h3,h4,h5,h6,a:not([href])"),(function(t){return t.dom}))}(t);return W(L(W(n,tO),nO).concat(L(W(n,$C),eO)),oO)},iO="tinymce-url-history",uO=function(t){return C(t)&&/^https?/.test(t)},aO=function(t){return O(t)&&Ot(t,(function(t){return!(_(n=t)&&n.length<=5&&$(n,uO));var n})).isNone()},cO=function(){var t,n=Uv.getItem(iO);if(null===n)return{};try{t=JSON.parse(n)}catch(t){if(t instanceof SyntaxError)return console.log("Local storage "+iO+" was not valid JSON",t),{};throw t}return aO(t)?t:(console.log("Local storage "+iO+" was not valid format",t),{})},sO=function(t){var n=cO();return Object.prototype.hasOwnProperty.call(n,t)?n[t]:[]},lO=function(t,n){var e,o,r;uO(t)&&(e=cO(),o=Object.prototype.hasOwnProperty.call(e,n)?e[n]:[],r=W(o,(function(n){return n!==t})),e[n]=[t].concat(r).slice(0,5),function(t){if(!aO(t))throw new Error("Bad format for history:\n"+JSON.stringify(t));Uv.setItem(iO,JSON.stringify(t))}(e))},fO=function(t){return!!t},dO=function(t){return St(rS.makeMap(t,/[, ]/),fO)},mO=function(t){return w.from(t.getParam("file_picker_callback")).filter(A)},gO=function(t){return w.from(t).filter(C).getOrUndefined()},pO=function(t){return{getHistory:sO,addToHistory:lO,getLinkInformation:function(){return!1===(n=t).getParam("typeahead_urls")?w.none():w.some({targets:rO(n.getBody()),anchorTop:gO(n.getParam("anchor_top","#top")),anchorBottom:gO(n.getParam("anchor_bottom","#bottom"))});var n},getValidationHandler:function(){return function(t){return w.from(void 0===(e=(n=t).getParam("file_picker_validator_handler",void 0,"function"))?n.getParam("filepicker_validator_handler",void 0,"function"):e);var n,e}(t)},getUrlPicker:function(n){return function(t,n){var e,o,r,i,u=(e=t,o=w.some(e.getParam("file_picker_types")).filter(fO),r=w.some(e.getParam("file_browser_callback_types")).filter(fO),i=o.or(r).map(dO),mO(e).fold(a,(function(t){return i.fold(c,(function(t){return 0<yt(t).length&&t}))})));return T(u)?u?mO(t):w.none():u[n]?mO(t):w.none()}(e=t,o=n).map((function(t){return function(n){return by((function(r){var i=l({filetype:o,fieldname:n.fieldname},w.from(n.meta).getOr({}));t.call(e,(function(t,n){if(!C(t))throw new Error("Expected value to be string");if(void 0!==n&&!O(n))throw new Error("Expected meta to be a object");r({value:t,meta:n})}),n.value,i)}))}}));var e,o}}},hO=function(t,n,e){var o,r,i=Zn(!1),u={isPositionedAtTop:function(){return"top"===o.get()},getDockingMode:(o=Zn(Lh(n)?"bottom":"top")).get,setDockingMode:o.set},a={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:ch.translate,isDisabled:function(){return n.mode.isReadOnly()||n.ui.isDisabled()},getSetting:n.getParam.bind(n)},interpreter:function(t){return IC(DC,t,a)},anchors:HC(n,e,u.isPositionedAtTop),header:u,getSink:function(){return ct.value(t)}},urlinput:pO(n),styleselect:function(t){var n=function(n){return function(){return t.formatter.match(n)}},e=function(n){return function(){var e=t.formatter.get(n);return void 0!==e?w.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):w.none()}},o=function(t){var n=t.items;return void 0!==n&&0<n.length?J(n,o):[t.format]},r=Zn([]),i=Zn([]),u=Zn([]),a=Zn([]),c=Zn(!1);return t.on("PreInit",(function(u){var a=jC(t),c=WC(t,a,n,e);r.set(c),i.set(J(c,o))})),t.on("addStyleModifications",(function(r){var i=WC(t,r.items,n,e);u.set(i),c.set(r.replace),a.set(J(i,o))})),{getData:function(){var t=c.get()?[]:r.get(),n=u.get();return t.concat(n)},getFlattenedKeys:function(){var t=c.get()?[]:i.get(),n=a.get();return t.concat(n)}}}(n),colorinput:zC(n),dialog:{isDraggableModal:(r=n,function(){return r.getParam("draggable_modal",!1,"boolean")})},isContextMenuOpen:function(){return i.get()},setContextMenuState:function(t){return i.set(t)}};return a},vO=e((function(t,n){var e,o,r;e=t,o=Math.floor(n),r=eu.max(e,o,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]),Ei(e,"max-width",r+"px")})),bO="contexttoolbar-hide",yO=e([Bn("dom"),Un("shell",!0),cl("toolbarBehaviours",[_m])]),xO=e([Pl({name:"groups",overrides:function(){return{behaviours:Da([_m.config({})])}}})]),wO=ff({name:"Toolbar",configFields:yO(),partFields:xO(),factory:function(t,n,e,o){var r=function(n){return t.shell?w.some(n):Kl(n,t,"groups")},i=t.shell?{behaviours:[_m.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:i.components,behaviours:ll(t.toolbarBehaviours,i.behaviours),apis:{setGroups:function(t,n){r(t).fold((function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(t){_m.set(t,n)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),SO=function(t,n,e){return{within:t,extra:n,withinWidth:e}},kO=function(t,n,o){var r,i=(r=function(t,n){var e=o(t);return w.some({element:t,start:n,finish:n+e,width:e})},X(t,(function(t,n){return r(n,t.len).fold(e(t),(function(n){return{len:n.finish,list:t.list.concat([n])}}))}),{len:0,list:[]}).list),u=W(i,(function(t){return t.finish<=n})),a=G(u,(function(t,n){return t+n.width}),0);return{within:u,extra:i.slice(u.length),withinWidth:a}},CO=function(t){return L(t,(function(t){return t.element}))},OO=function(t,n){var e=L(n,(function(t){return Xi(t)}));wO.setGroups(t,e)},_O=function(t,n,e){var o=Jl(t,n,"primary"),r=Dy.getCoupled(t,"overflowGroup");Ei(o.element,"visibility","hidden");var i=n.builtGroups.get().concat([r]),u=it(i,(function(t){return ja(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))}));e([]),OO(o,i);var a=function(t,n,e,o){var r,i,u,a,c,s,l,f,d,m=(0===(r=kO(n,t,e)).extra.length?w.some(r):w.none()).getOrThunk((function(){return kO(n,t-e(o),e)})),g=m.within,p=m.extra,h=m.withinWidth;return 1===p.length&&p[0].width<=e(o)?(l=p,f=h,d=CO(g.concat(l)),SO(d,[],f)):1<=p.length?(u=p,a=o,c=h,s=CO(g).concat([a]),SO(s,CO(u),c)):(i=h,SO(CO(g),[],i))}(ou(o.element),n.builtGroups.get(),(function(t){return ou(t.element)}),r);0===a.extra.length?(_m.remove(o,r),e([])):(OO(o,a.within),e(a.extra)),Ri(o.element,"visibility"),Vi(o.element),u.each(Dm.focus)},TO=e([cl("splitToolbarBehaviours",[Dy]),Qn("builtGroups",(function(){return Zn([])}))]),EO=e([Lu(["overflowToggledClass"]),Ln("getOverflowBounds"),Bn("lazySink"),Qn("overflowGroups",(function(){return Zn([])}))].concat(TO())),BO=e([Rl({factory:wO,schema:yO(),name:"primary"}),Vl({schema:yO(),name:"overflow"}),Vl({name:"overflow-button"}),Vl({name:"overflow-group"})]),AO=e([Lu(["toggledClass"]),Bn("lazySink"),Fn("fetch"),Ln("getBounds"),jn("fireDismissalEventInstead",[Un("event",Eo())]),bc()]),MO=e([Vl({name:"button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:Da([Wm.config({toggleClass:t.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),Vl({factory:wO,schema:yO(),name:"toolbar",overrides:function(t){return{toolbarBehaviours:Da([wm.config({mode:"cyclic",onEscape:function(n){return Kl(n,t,"button").each(Dm.focus),w.none()}})])}}})]),DO=function(t,n){var e=Dy.getCoupled(t,"toolbarSandbox");Ls.isOpen(e)?Ls.close(e):Ls.open(e,n.toolbar())},FO=function(t,n,e,o){var r=e.getBounds.map((function(t){return t()})),i=e.lazySink(t).getOrDie();ys.positionWithinBounds(i,{anchor:"hotspot",hotspot:t,layouts:o,overrides:{maxWidthFunction:vO()}},n,r)},IO=function(t,n,e,o,r){wO.setGroups(n,r),FO(t,n,e,o),Wm.on(t)},RO=ff({name:"FloatingToolbarButton",factory:function(t,n,e,o){return l(l({},Eg.sketch(l(l({},o.button()),{action:function(t){DO(t,o)},buttonBehaviours:dl({dump:o.button().buttonBehaviours},[Dy.config({others:{toolbarSandbox:function(n){return o=n,r=e,i=t,{dom:{tag:"div",attributes:{id:(u=Eu()).id}},behaviours:Da([wm.config({mode:"special",onEscape:function(t){return Ls.close(t),w.some(!0)}}),Ls.config({onOpen:function(t,n){i.fetch().get((function(t){IO(o,n,i,r.layouts,t),u.link(o.element),wm.focusIn(n)}))},onClose:function(){Wm.off(o),Dm.focus(o),u.unlink(o.element)},isPartOf:function(t,n,e){return Bu(n,e)||Bu(o,e)},getAttachPoint:function(){return i.lazySink(o).getOrDie()}}),Ha.config({channels:l(l({},Xs(l({isExtraPart:a},i.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),qs({doReposition:function(){Ls.getState(Dy.getCoupled(o,"toolbarSandbox")).each((function(t){FO(o,t,i,r.layouts)}))}}))})])};var o,r,i,u}}})])}))),{apis:{setGroups:function(n,o){Ls.getState(Dy.getCoupled(n,"toolbarSandbox")).each((function(r){IO(n,r,t,e.layouts,o)}))},reposition:function(n){Ls.getState(Dy.getCoupled(n,"toolbarSandbox")).each((function(o){FO(n,o,t,e.layouts)}))},toggle:function(t){DO(t,o)},getToolbar:function(t){return Ls.getState(Dy.getCoupled(t,"toolbarSandbox"))},isOpen:function(t){return Ls.isOpen(Dy.getCoupled(t,"toolbarSandbox"))}}})},configFields:AO(),partFields:MO(),apis:{setGroups:function(t,n,e){t.setGroups(n,e)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},getToolbar:function(t,n){return t.getToolbar(n)},isOpen:function(t,n){return t.isOpen(n)}}}),VO=e([Bn("items"),Lu(["itemSelector"]),cl("tgroupBehaviours",[wm])]),PO=e([Hl({name:"items",unit:"item"})]),HO=ff({name:"ToolbarGroup",configFields:VO(),partFields:PO(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:ll(t.tgroupBehaviours,[wm.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),zO=function(t){return L(t,(function(t){return Xi(t)}))},NO=function(t,n,e){_O(t,e,(function(o){e.overflowGroups.set(o),n.getOpt(t).each((function(t){RO.setGroups(t,zO(o))}))}))},LO=ff({name:"SplitFloatingToolbar",configFields:EO(),partFields:BO(),factory:function(t,n,e,o){var r=Bg(RO.sketch({fetch:function(){return by((function(n){n(zO(t.overflowGroups.get()))}))},layouts:{onLtr:function(){return[ga,ma]},onRtl:function(){return[ma,ga]},onBottomLtr:function(){return[ha,pa]},onBottomRtl:function(){return[pa,ha]}},getBounds:e.getOverflowBounds,lazySink:t.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:t.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:t.uid,dom:t.dom,components:n,behaviours:ll(t.splitToolbarBehaviours,[Dy.config({others:{overflowGroup:function(){return HO.sketch(l(l({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(n,e){t.builtGroups.set(L(e,n.getSystem().build)),NO(n,r,t)},refresh:function(n){return NO(n,r,t)},toggle:function(t){r.getOpt(t).each((function(t){RO.toggle(t)}))},isOpen:function(t){return r.getOpt(t).map(RO.isOpen).getOr(!1)},reposition:function(t){r.getOpt(t).each((function(t){RO.reposition(t)}))},getOverflow:function(t){return r.getOpt(t).bind(RO.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)},getOverflow:function(t,n){return t.getOverflow(n)}}}),jO=function(t,n){return n.getAnimationRoot.fold((function(){return t.element}),(function(n){return n(t)}))},UO=function(t){return t.dimension.property},WO=function(t,n){return t.dimension.getDimension(n)},GO=function(t,n){var e=jO(t,n);wi(e,[n.shrinkingClass,n.growingClass])},XO=function(t,n){bi(t.element,n.openClass),vi(t.element,n.closedClass),Ei(t.element,UO(n),"0px"),Vi(t.element)},YO=function(t,n){bi(t.element,n.closedClass),vi(t.element,n.openClass),Ri(t.element,UO(n))},qO=function(t,n,e,o){e.setCollapsed(),Ei(t.element,UO(n),WO(n,t.element)),Vi(t.element),GO(t,n),XO(t,n),n.onStartShrink(t),n.onShrunk(t)},KO=function(t,n,e,o){var r=o.getOrThunk((function(){return WO(n,t.element)}));e.setCollapsed(),Ei(t.element,UO(n),r),Vi(t.element);var i=jO(t,n);bi(i,n.growingClass),vi(i,n.shrinkingClass),XO(t,n),n.onStartShrink(t)},JO=function(t,n,e){var o=WO(n,t.element);("0px"===o?qO:KO)(t,n,e,w.some(o))},$O=function(t,n,e){var o=jO(t,n),r=yi(o,n.shrinkingClass),i=WO(n,t.element);YO(t,n);var u=WO(n,t.element);(r?function(){Ei(t.element,UO(n),i),Vi(t.element)}:function(){XO(t,n)})(),bi(o,n.shrinkingClass),vi(o,n.growingClass),YO(t,n),Ei(t.element,UO(n),u),e.setExpanded(),n.onStartGrow(t)},QO=function(t,n,e){var o=jO(t,n);return!0===yi(o,n.growingClass)},ZO=function(t,n,e){var o=jO(t,n);return!0===yi(o,n.shrinkingClass)},t_=Object.freeze({__proto__:null,refresh:function(t,n,e){var o;e.isExpanded()&&(Ri(t.element,UO(n)),o=WO(n,t.element),Ei(t.element,UO(n),o))},grow:function(t,n,e){e.isExpanded()||$O(t,n,e)},shrink:function(t,n,e){e.isExpanded()&&JO(t,n,e)},immediateShrink:function(t,n,e){e.isExpanded()&&qO(t,n,e,w.none())},hasGrown:function(t,n,e){return e.isExpanded()},hasShrunk:function(t,n,e){return e.isCollapsed()},isGrowing:QO,isShrinking:ZO,isTransitioning:function(t,n,e){return QO(t,n)||ZO(t,n)},toggleGrow:function(t,n,e){(e.isExpanded()?JO:$O)(t,n,e)},disableTransitions:GO}),n_=Object.freeze({__proto__:null,exhibit:function(t,n,e){var o=n.expanded;return si(o?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:Ut(n.dimension.property,"0px")})},events:function(t,n){return jo([$o(uo(),(function(e,o){o.event.raw.propertyName===t.dimension.property&&(GO(e,t),n.isExpanded()&&Ri(e.element,t.dimension.property),(n.isExpanded()?t.onGrown:t.onShrunk)(e))}))])}}),e_=[Bn("closedClass"),Bn("openClass"),Bn("shrinkingClass"),Bn("growingClass"),Pn("getAnimationRoot"),Uu("onShrunk"),Uu("onStartShrink"),Uu("onGrown"),Uu("onStartGrow"),Un("expanded",!1),An("dimension",yn("property",{width:[Yu("property","width"),Yu("getDimension",(function(t){return ou(t)+"px"}))],height:[Yu("property","height"),Yu("getDimension",(function(t){return Ki(t)+"px"}))]}))],o_=Ia({fields:e_,name:"sliding",active:n_,apis:t_,state:Object.freeze({__proto__:null,init:function(t){var n=Zn(t.expanded);return ai({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:r(n.set,!1),setExpanded:r(n.set,!0),readState:function(){return"expanded: "+n.get()}})}})}),r_=e([Lu(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),Uu("onOpened"),Uu("onClosed")].concat(TO())),i_=e([Rl({factory:wO,schema:yO(),name:"primary"}),Rl({factory:wO,schema:yO(),name:"overflow",overrides:function(t){return{toolbarBehaviours:Da([o_.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:function(n){Kl(n,t,"overflow-button").each((function(t){Wm.off(t),Dm.focus(t)})),t.onClosed(n)},onGrown:function(n){wm.focusIn(n),t.onOpened(n)},onStartGrow:function(n){Kl(n,t,"overflow-button").each(Wm.on)}}),wm.config({mode:"acyclic",onEscape:function(n){return Kl(n,t,"overflow-button").each(Dm.focus),w.some(!0)}})])}}}),Vl({name:"overflow-button",overrides:function(t){return{buttonBehaviours:Da([Wm.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),Vl({name:"overflow-group"})]),u_=function(t,n){Kl(t,n,"overflow-button").bind((function(){return Kl(t,n,"overflow")})).each((function(e){a_(t,n),o_.toggleGrow(e)}))},a_=function(t,n){Kl(t,n,"overflow").each((function(e){_O(t,n,(function(t){var n=L(t,(function(t){return Xi(t)}));wO.setGroups(e,n)})),Kl(t,n,"overflow-button").each((function(t){o_.hasGrown(e)&&Wm.on(t)})),o_.refresh(e)}))},c_=ff({name:"SplitSlidingToolbar",configFields:r_(),partFields:i_(),factory:function(t,n,e,o){var r="alloy.toolbar.toggle";return{uid:t.uid,dom:t.dom,components:n,behaviours:ll(t.splitToolbarBehaviours,[Dy.config({others:{overflowGroup:function(t){return HO.sketch(l(l({},o["overflow-group"]()),{items:[Eg.sketch(l(l({},o["overflow-button"]()),{action:function(n){Vo(t,r)}}))]}))}}}),Tm("toolbar-toggle-events",[Go(r,(function(n){u_(n,t)}))])]),apis:{setGroups:function(n,e){var o;o=L(e,n.getSystem().build),t.builtGroups.set(o),a_(n,t)},refresh:function(n){return a_(n,t)},toggle:function(n){return u_(n,t)},isOpen:function(n){return Kl(n,t,"overflow").map(o_.hasGrown).getOr(!1)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)}}}),s_=e(Wr("toolbar-height-change")),l_=function(t){var n=t.title.fold((function(){return{}}),(function(t){return{attributes:{title:t}}}));return{dom:l({tag:"div",classes:["tox-toolbar__group"]},n),components:[HO.parts.items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:Da([Wb.config({}),Dm.config({})])}},f_=function(t){return HO.sketch(l_(t))},d_=function(t,n){var e=Qo((function(n){var e=L(t.initGroups,f_);wO.setGroups(n,e)}));return Da([nv(t.providers.isDisabled),$h(),wm.config({mode:n,onEscape:t.onEscape,selector:".tox-toolbar__group"}),Tm("toolbar-events",[e])])},m_=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":l_({title:w.none(),items:[]}),"overflow-button":Ck({name:"more",icon:w.some("more-drawer"),disabled:!1,tooltip:w.some("More..."),primary:!1,borderless:!1},w.none(),t.providers)},splitToolbarBehaviours:d_(t,n)}},g_=function(t){var n=m_(t),e=LO.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return LO.sketch(l(l({},n),{lazySink:t.getSink,getOverflowBounds:function(){var n=t.moreDrawerData.lazyHeader().element,e=vu(n),o=lr(n),r=vu(o),i=Math.max(o.dom.scrollHeight,r.height);return pu(e.x+4,r.y,e.width-8,i)},parts:l(l({},n.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:t.attributes}}}),components:[e],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},p_=function(t){var n=c_.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=c_.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=m_(t);return c_.sketch(l(l({},o),{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([s_()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([s_()],{type:"closed"})}}))},h_=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return wO.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===mp.scrolling?["tox-toolbar--scrolling"]:[])},components:[wO.parts.groups({})],toolbarBehaviours:d_(t,n)})},v_=tn([Mn("type"),An("items",en([ln([Mn("name"),Vn("items",kn)]),kn]))].concat(Zg)),b_=[Nn("text"),Nn("tooltip"),Nn("icon"),Fn("fetch"),Kn("onSetup",(function(){return t}))],y_=tn(d([Mn("type")],b_)),x_=function(t){return gn("menubutton",y_,t)},w_=tn([Mn("type"),Nn("tooltip"),Nn("icon"),Nn("text"),Ln("select"),Fn("fetch"),Kn("onSetup",(function(){return t})),Yn("presets","normal",["normal","color","listpreview"]),Un("columns",1),Fn("onAction"),Fn("onItemAction")]),S_=Object.freeze({__proto__:null,events:function(t,n){var e=function(e,o){t.updateState.each((function(t){var r=t(e,o);n.set(r)})),t.renderComponents.each((function(t){var r=t(o,n.get()),i=L(r,e.getSystem().build);ks(e,i)}))};return jo([Go(go(),(function(n,o){var r,i=o;i.universal||(r=t.channel,P(i.channels,r)&&e(n,i.data))})),Qo((function(n,o){t.initialData.each((function(t){e(n,t)}))}))])}}),k_=Object.freeze({__proto__:null,getState:function(t,n,e){return e}}),C_=[Bn("channel"),Pn("renderComponents"),Pn("updateState"),Pn("initialData")],O_=Ia({fields:C_,name:"reflecting",active:S_,apis:k_,state:Object.freeze({__proto__:null,init:function(){var t=Zn(w.none());return{readState:function(){return t.get().fold((function(){return"none"}),(function(t){return t}))},get:function(){return t.get()},set:function(n){return t.set(n)},clear:function(){return t.set(w.none())}}}})}),__=e([Bn("toggleClass"),Bn("fetch"),Gu("onExecute"),Un("getHotspot",w.some),Un("getAnchorOverrides",e({})),bc(),Gu("onItemExecute"),Pn("lazySink"),Bn("dom"),Uu("onOpen"),cl("splitDropdownBehaviours",[Dy,wm,Dm]),Un("matchWidth",!1),Un("useMinWidth",!1),Un("eventOrder",{}),Pn("role")].concat(Ky())),T_=Rl({factory:Eg,schema:[Bn("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:Da([Dm.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each(Ho)},buttonBehaviours:Da([Wm.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])}}}),E_=Rl({factory:Eg,schema:[Bn("dom")],name:"button",defaults:function(){return{buttonBehaviours:Da([Dm.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each((function(e){t.onExecute(e,n)}))}}}}),B_=e([T_,E_,Pl({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Bn("text")],name:"aria-descriptor"}),Vl({schema:[Nu()],name:"menu",defaults:function(t){return{onExecute:function(n,e){n.getSystem().getByUid(t.uid).each((function(o){t.onItemExecute(o,n,e)}))}}}}),Iy()]),A_=ff({name:"SplitDropdown",configFields:__(),partFields:B_(),factory:function(n,e,o,r){var i,u=function(t){vf.getCurrent(t).each((function(t){Tf.highlightFirst(t),wm.focusIn(t)}))},a=function(e){Wy(n,(function(t){return t}),e,r,u,fy.HighlightFirst).get(t)},c=function(t){var e=Jl(t,n,"button");return Ho(e),w.some(!0)},s=l(l({},jo([Qo((function(t,e){Kl(t,n,"aria-descriptor").each((function(n){var e=Wr("aria");Rr(n.element,"id",e),Rr(t.element,"aria-describedby",e)}))}))])),Xm(w.some(a))),f={repositionMenus:function(t){Wm.isOn(t)&&qy(t)}};return{uid:n.uid,dom:n.dom,components:e,apis:f,eventOrder:l(l({},n.eventOrder),((i={})[po()]=["disabling","toggling","alloy.base.behaviour"],i)),events:s,behaviours:ll(n.splitDropdownBehaviours,[Dy.config({others:{sandbox:function(t){var e=Jl(t,n,"arrow");return Yy(n,t,{onOpen:function(){Wm.on(e),Wm.on(t)},onClose:function(){Wm.off(e),Wm.off(t)}})}}}),wm.config({mode:"special",onSpace:c,onEnter:c,onDown:function(t){return a(t),w.some(!0)}}),Dm.config({}),Wm.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:n.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(t,n){return t.repositionMenus(n)}}}),M_=function(t){return{isDisabled:function(){return Sh.isDisabled(t)},setDisabled:function(n){return Sh.set(t,n)}}},D_=function(t){return{setActive:function(n){Wm.set(t,n)},isActive:function(){return Wm.isOn(t)},isDisabled:function(){return Sh.isDisabled(t)},setDisabled:function(n){return Sh.set(t,n)}}},F_=function(t,n){return t.map((function(t){return{"aria-label":n.translate(t),title:n.translate(t)}})).getOr({})},I_=Wr("focus-button"),R_=["checklist","ordered-list"],V_=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],P_=function(t,n,e,o,r,i){var u,a=function(t){return ch.isRtl()&&P(R_,t)?t+"-rtl":t},c=ch.isRtl()&&t.exists((function(t){return P(V_,t)}));return{dom:{tag:"button",classes:["tox-tbtn"].concat(n.isSome()?["tox-tbtn--select"]:[]).concat(c?["tox-tbtn__icon-rtl"]:[]),attributes:F_(e,i)},components:uv([t.map((function(t){return ck(a(t),i.icons)})),n.map((function(t){return lk(t,"tox-tbtn",i)}))]),eventOrder:((u={})[qe()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:Da([nv(i.isDisabled),$h(),Tm("common-button-display-events",[Go(qe(),(function(t,n){n.event.prevent(),Vo(t,I_)}))])].concat(o.map((function(e){return O_.config({channel:e,initialData:{icon:t,text:n},renderComponents:function(t,n){return uv([t.icon.map((function(t){return ck(a(t),i.icons)})),t.text.map((function(t){return lk(t,"tox-tbtn",i)}))])}})})).toArray()).concat(r.getOr([])))}},H_=function(n,e,o){var r,i=Zn(t),u=P_(n.icon,n.text,n.tooltip,w.none(),w.none(),o);return Eg.sketch({dom:u.dom,components:u.components,eventOrder:dk,buttonBehaviours:Da([Tm("toolbar-button-events",[(r={onAction:n.onAction,getApi:e.getApi},nr((function(t,n){ev(r,t)((function(n){Po(t,fk,{buttonApi:n}),r.onAction(n)}))}))),ov(e,i),rv(e,i)]),nv((function(){return n.disabled||o.isDisabled()})),$h()].concat(e.toolbarButtonBehaviours))})},z_=function(t,n,e){return H_(t,{toolbarButtonBehaviours:[].concat(0<e.length?[Tm("toolbarButtonWith",e)]:[]),getApi:M_,onSetup:t.onSetup},n)},N_=function(t,n,e){return Ft(H_(t,{toolbarButtonBehaviours:[_m.config({}),Wm.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<e.length?[Tm("toolbarToggleButtonWith",e)]:[]),getApi:D_,onSetup:t.onSetup},n))},L_=function(t,n){return Go(fk,(function(e,o){var r,i=t.get(e),u=(r=i,{hide:function(){return Vo(r,yo())},getValue:function(){return al.getValue(r)}});n.onAction(u,o.event.buttonApi)}))},j_=function(n,e){var o,r,u,a,c=n.label.fold((function(){return{}}),(function(t){return{"aria-label":t}})),s=Bg(cy.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:n.initValue(),inputAttributes:c,selectOnFocus:!0,inputBehaviours:Da([wm.config({mode:"special",onEnter:function(t){return d.findPrimary(t).map((function(t){return Ho(t),!0}))},onLeft:function(t,n){return n.cut(),w.none()},onRight:function(t,n){return n.cut(),w.none()}})])})),d=(o=s,r=n.commands,u=e,a=L(r,(function(n){return Bg(function(n,e,o){var r,i,u,a,c,s,d,m,g,p,h,v,b={backstage:{shared:{providers:o}}};return"contextformtogglebutton"===e.type?(d=n,g=b,(p=(m=e).original).primary,h=f(p,["primary"]),v=pn(rp(l(l({},h),{type:"togglebutton",onAction:t}))),N_(v,g.backstage.shared.providers,[L_(d,m)])):(r=n,u=b,(a=(i=e).original).primary,c=f(a,["primary"]),s=pn(np(l(l({},c),{type:"button",onAction:t}))),z_(s,u.backstage.shared.providers,[L_(r,i)]))}(o,n,u))})),{asSpecs:function(){return L(a,(function(t){return t.asSpec()}))},findPrimary:function(t){return it(r,(function(n,e){return n.primary?w.from(a[e]).bind((function(n){return n.getOpt(t)})).filter(i(Sh.isDisabled)):w.none()}))}});return[{title:w.none(),items:[s.asSpec()]},{title:w.none(),items:d.asSpecs()}]},U_=function(t,n){var e,o,r,i,u,a=fu(window),c=hu(re(t.getContentAreaContainer())),s=Ah(t)||Mh(t)||Fh(t),l=(e=c,o=a,r=Math.max(o.x,e.x),i=e.right-r,u=o.width-(r-o.x),{x:r,width:Math.min(i,u)}),f=l.x,d=l.width;if(t.inline&&!s)return pu(f,a.y,d,a.height);var m=function(t,n,e,o){var r=re(t.getContainer()),i=_u(r,".tox-editor-header").getOr(r),u=hu(i),a=u.y>=n.bottom,c=o&&!a;if(t.inline&&c)return{y:Math.max(u.bottom,e.y),bottom:e.bottom};if(t.inline&&!c)return{y:e.y,bottom:Math.min(u.y,e.bottom)};var s=hu(r);return c?{y:Math.max(u.bottom,e.y),bottom:Math.min(s.bottom,e.bottom)}:{y:Math.max(s.y,e.y),bottom:Math.min(u.y,e.bottom)}}(t,c,a,n.header.isPositionedAtTop()),g=m.y,p=m.bottom;return pu(f,g,d,p-g)},W_=function(t,n){var e=W(n,(function(n){return n.predicate(t.dom)})),o=U(e,(function(t){return"contexttoolbar"===t.type}));return{contextToolbars:o.pass,contextForms:o.fail}},G_=function(t,n){var e={},o=[],r=[],i={},u={},a=function(t,a){var c=pn(gn("ContextForm",fp,a));(e[t]=c).launch.map((function(e){i["form:"+t]=l(l({},a.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){n(c)}})})),"editor"===c.scope?r.push(c):o.push(c),u[t]=c},c=yt(t);return j(c,(function(n){var e=t[n];"contextform"===e.type?a(n,e):"contexttoolbar"===e.type&&function(t,n){gn("ContextToolbar",dp,n).each((function(e){"editor"===n.scope?r.push(e):o.push(e),u[t]=e}))}(n,e)})),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:u,formNavigators:i}},X_=Wr("forward-slide"),Y_=Wr("backward-slide"),q_=Wr("change-slide-event"),K_="tox-pop--resizing",J_=function(t,n,e){var o,r,i,u,a,c=e.dataset,s="basic"===c.type?function(){return L(c.data,(function(t){return UC(t,e.isSelectedFor,e.getPreviewFor)}))}:c.getData;return{items:(o=n,r=e,i=function(t,n,e,i){var a=o.shared.providers.translate(t.title);if("separator"===t.type)return w.some({type:"separator",text:a});if("submenu"!==t.type)return w.some(l({type:"togglemenuitem",text:a,icon:t.icon,active:t.isSelected(i),disabled:e,onAction:r.onAction(t)},t.getStylePreview().fold((function(){return{}}),(function(t){return{meta:{style:t}}}))));var c=J(t.getStyleItems(),(function(t){return u(t,n,i)}));return 0===n&&c.length<=0?w.none():w.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return J(t.getStyleItems(),(function(t){return u(t,n,i)}))}})},u=function(t,n,e){var o="formatter"===t.type&&r.isInvalid(t);return 0===n?o?[]:i(t,n,!1,e).toArray():i(t,n,o,e).toArray()},{validateItems:a=function(t){var n=r.getCurrentValue(),e=r.shouldHide?0:1;return J(t,(function(t){return u(t,e,n)}))},getFetch:function(t,n){return function(e,o){var r=n(),i=a(r);o(yk(i,pp.CLOSE_ON_EXECUTE,t,!1))}}}),getStyleItems:s}},$_=function(n,e,o){var r=J_(0,e,o),i=r.items,u=r.getStyleItems;return pk({text:o.icon.isSome()?w.none():w.some(""),icon:o.icon,tooltip:w.from(o.tooltip),role:w.none(),fetch:i.getFetch(e,u),onSetup:function(e){return o.setInitialValue.each((function(t){return t(e.getComponent())})),o.nodeChangeHandler.map((function(t){var o=t(e.getComponent());return n.on("NodeChange",o),function(){n.off("NodeChange",o)}})).getOr(t)},getApi:function(t){return{getComponent:function(){return t}}},columns:1,presets:"normal",classes:o.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",e.shared)};($k=Jk=Jk||{})[$k.SemiColon=0]="SemiColon",$k[$k.Space=1]="Space";var Q_,Z_,tT,nT,eT,oT,rT=function(t,n,e,o){var r,i;return{type:"basic",data:(i=t.getParam(n,e,"string"),r=o===Jk.SemiColon?i.replace(/;$/,"").split(";"):i.split(" "),L(r,(function(t){var n=t,e=t,o=t.split("=");return 1<o.length&&(n=o[0],e=o[1]),{title:n,format:e}})))}},iT=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],uT=function(t){var n=function(n){var e=Y(iT,(function(n){return t.formatter.match(n.format)})).fold((function(){return"left"}),(function(t){return t.title.toLowerCase()}));Po(n,gk,{icon:"align-"+e})},e=w.some((function(t){return function(){return n(t)}})),o=w.some(n),r={type:"basic",data:iT};return{tooltip:"Align",icon:w.some("align-left"),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:w.none,getPreviewFor:function(t){return function(){return w.none()}},onAction:function(n){return function(){return Y(iT,(function(t){return t.format===n.format})).each((function(n){return t.execCommand(n.command)}))}},setInitialValue:o,nodeChangeHandler:e,dataset:r,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},aT=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],cT=function(t){var n=t.split(/\s*,\s*/);return L(n,(function(t){return t.replace(/^['"]+|['"]+$/g,"")}))},sT=function(t){var n=function(){var n=function(t){return t?cT(t)[0]:""},e=t.queryCommandValue("FontName"),o=i.data,r=e?e.toLowerCase():"";return{matchOpt:Y(o,(function(t){var e=t.format;return e.toLowerCase()===r||n(e).toLowerCase()===n(r).toLowerCase()})).orThunk((function(){return function(t){var n;return 0===t.indexOf("-apple-system")&&(n=cT(t.toLowerCase()),$(aT,(function(t){return-1<n.indexOf(t.toLowerCase())})))}(r)?w.from({title:"System Font",format:r}):w.none()})),font:e}},e=function(t){var e=n(),o=e.matchOpt,r=e.font,i=o.fold((function(){return r}),(function(t){return t.title}));Po(t,mk,{text:i})},o=w.some((function(t){return function(){return e(t)}})),r=w.some(e),i=rT(t,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",Jk.SemiColon);return{tooltip:"Fonts",icon:w.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getCurrentValue:function(){return n().matchOpt},getPreviewFor:function(t){return function(){return w.some({tag:"div",styles:-1===t.indexOf("dings")?{"font-family":t}:{}})}},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontName",!1,n.format)}))}},setInitialValue:r,nodeChangeHandler:o,dataset:i,shouldHide:!1,isInvalid:a}},lT={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},fT={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},dT=function(t){var n=function(){var n=w.none(),e=c.data,o=t.queryCommandValue("FontSize");if(o)for(var r=function(t){var r=function(t,n){return/[0-9.]+px$/.test(t)?(e=72*parseInt(t,10)/96,o=n||0,r=Math.pow(10,o),Math.round(e*r)/r+"pt"):Tt(fT,t).getOr(t);var e,o,r}(o,t),i=Tt(lT,r).getOr("");n=Y(e,(function(t){return t.format===o||t.format===r||t.format===i}))},i=3;n.isNone()&&0<=i;i--)r(i);return{matchOpt:n,size:o}},o=e(w.none),r=function(t){var e=n(),o=e.matchOpt,r=e.size,i=o.fold((function(){return r}),(function(t){return t.title}));Po(t,mk,{text:i})},i=w.some((function(t){return function(){return r(t)}})),u=w.some(r),c=rT(t,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",Jk.Space);return{tooltip:"Font sizes",icon:w.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getPreviewFor:o,getCurrentValue:function(){return n().matchOpt},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontSize",!1,n.format)}))}},setInitialValue:u,nodeChangeHandler:i,dataset:c,shouldHide:!1,isInvalid:a}},mT=function(t,n){var e=n(),o=L(e,(function(t){return t.format}));return w.from(t.formatter.closest(o)).bind((function(t){return Y(e,(function(n){return n.format===t}))})).orThunk((function(){return mf(t.formatter.match("p"),{title:"Paragraph",format:"p"})}))},gT=function(t){var n=Zn(w.none()),e=function(){return n.get().each(t)};return{clear:function(){e(),n.set(w.none())},isSet:function(){return n.get().isSome()},set:function(t){e(),n.set(w.some(t))}}},pT=function(){return gT((function(t){return t.destroy()}))},hT=function(){return gT((function(t){return t.unbind()}))},vT=function(t,n){return function(e){var o=hT(),r=function(){e.setActive(t.formatter.match(n));var r=t.formatter.formatChanged(n,e.setActive);o.set(r)};return t.initialized?r():t.on("init",r),o.clear}},bT=function(t){return function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("mceToggleFormat",!1,n.format)}))}}},yT=function(t){var n=function(n){var e=mT(t,(function(){return r.data})).fold((function(){return"Paragraph"}),(function(t){return t.title}));Po(n,mk,{text:e})},e=w.some((function(t){return function(){return n(t)}})),o=w.some(n),r=rT(t,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",Jk.SemiColon);return{tooltip:"Blocks",icon:w.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:w.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return w.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))})}},onAction:bT(t),setInitialValue:o,nodeChangeHandler:e,dataset:r,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},xT=function(t,n){var e=function(n){var e=function(t){var n=t.items;return void 0!==n&&0<n.length?J(n,e):[{title:t.title,format:t.format}]},o=J(jC(t),e),r=mT(t,(function(){return o})).fold((function(){return"Paragraph"}),(function(t){return t.title}));Po(n,mk,{text:r})},o=w.some((function(t){return function(){return e(t)}})),r=w.some(e);return{tooltip:"Formats",icon:w.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:w.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return void 0!==e?w.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):w.none()}},onAction:bT(t),setInitialValue:r,nodeChangeHandler:o,shouldHide:t.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(n){return!t.formatter.canApply(n.format)},dataset:n}},wT=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],ST=function(t,n){return function(e,o,r){var i=t(e).mapError((function(t){return vn(t)})).getOrDie();return n(i,o,r)}},kT={button:ST(np,(function(t,n){return e=t,o=n.backstage.shared.providers,z_(e,o,[]);var e,o})),togglebutton:ST(rp,(function(t,n){return e=t,o=n.backstage.shared.providers,N_(e,o,[]);var e,o})),menubutton:ST(x_,(function(t,n){return wk(t,"tox-tbtn",n.backstage,w.none())})),splitbutton:ST((function(t){return gn("SplitButton",w_,t)}),(function(n,e){return function(n,e){var o,r,i,u,c=Wr("channel-update-split-dropdown-display"),s=function(t){return{isDisabled:function(){return Sh.isDisabled(t)},setDisabled:function(n){return Sh.set(t,n)},setIconFill:function(n,e){_u(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){Rr(t,"fill",e)}))},setIconStroke:function(n,e){_u(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){Rr(t,"stroke",e)}))},setActive:function(n){Rr(t.element,"aria-pressed",n),_u(t.element,"span").each((function(e){t.getSystem().getByDom(e).each((function(t){return Wm.set(t,n)}))}))},isActive:function(){return _u(t.element,"span").exists((function(n){return t.getSystem().getByDom(n).exists(Wm.isOn)}))}}},f=Zn(t),d={getApi:s,onSetup:n.onSetup};return A_.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:l({"aria-pressed":!1},F_(n.tooltip,e.providers))},onExecute:function(t){n.onAction(s(t))},onItemExecute:function(t,n,e){},splitDropdownBehaviours:Da([tv(e.providers.isDisabled),$h(),Tm("split-dropdown-events",[Go(I_,Dm.focus),ov(d,f),rv(d,f)]),Zy.config({})]),eventOrder:((o={})[_o()]=["alloy.base.behaviour","split-dropdown-events"],o),toggleClass:"tox-tbtn--enabled",lazySink:e.getSink,fetch:(r=s,i=n,u=e.providers,function(t){return by((function(t){return i.fetch(t)})).map((function(n){return w.from(bb(Ft(ib(Wr("menu-value"),n,(function(n){i.onItemAction(r(t),n)}),i.columns,i.presets,pp.CLOSE_ON_EXECUTE,i.select.getOr(a),u),{movement:ab(i.columns,i.presets),menuBehaviours:Qp("auto"!==i.columns?[]:[Qo((function(t,n){$p(t,4,_p(i.presets)).each((function(n){var e=n.numRows,o=n.numColumns;wm.setGridSize(t,e,o)}))}))])})))}))}),parts:{menu:Ap(0,n.columns,n.presets)},components:[A_.parts.button(P_(n.icon,n.text,w.none(),w.some(c),w.some([Wm.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),e.providers)),A_.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:Mg("chevron-down",e.providers.icons)},buttonBehaviours:Da([tv(e.providers.isDisabled),$h()])}),A_.parts["aria-descriptor"]({text:e.providers.translate("To open the popup, press Shift+Enter")})]})}(n,e.backstage.shared)})),grouptoolbarbutton:ST((function(t){return gn("GroupToolbarButton",v_,t)}),(function(t,n,e){var o,r,i,u,a,c,s=e.ui.registry.getAll().buttons,l=((o={})[hc]=n.backstage.shared.header.isPositionedAtTop()?Au.TopToBottom:Au.BottomToTop,o);switch(Vh(e)){case mp.floating:return r=t,i=n.backstage,u=function(t){return OT(e,{buttons:s,toolbar:t,allowToolbarGroups:!1},n,w.none())},a=l,c=i.shared,RO.sketch({lazySink:c.getSink,fetch:function(){return by((function(t){t(L(u(r.items),f_))}))},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:P_(r.icon,r.text,r.tooltip,w.none(),w.none(),c.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:a}}}});default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}})),styleSelectButton:function(t,n){return e=t,o=n.backstage,r=l({type:"advanced"},o.styleselect),$_(e,o,xT(e,r));var e,o,r},fontsizeSelectButton:function(t,n){return e=t,o=n.backstage,$_(e,o,dT(e));var e,o},fontSelectButton:function(t,n){return e=t,o=n.backstage,$_(e,o,sT(e));var e,o},formatButton:function(t,n){return e=t,o=n.backstage,$_(e,o,yT(e));var e,o},alignMenuButton:function(t,n){return e=t,o=n.backstage,$_(e,o,uT(e));var e,o}},CT={styleselect:kT.styleSelectButton,fontsizeselect:kT.fontsizeSelectButton,fontselect:kT.fontSelectButton,formatselect:kT.formatButton,align:kT.alignMenuButton},OT=function(t,n,e,o){var r=function(t){var n,e,o,r=t.toolbar,i=t.buttons;return!1===r?[]:void 0===r||!0===r?(e=i,o=L(wT,(function(t){var n=W(t.items,(function(t){return Et(e,t)||Et(CT,t)}));return{name:t.name,items:n}})),W(o,(function(t){return 0<t.items.length}))):C(r)?(n=r.split("|"),L(n,(function(t){return{items:t.trim().split(" ")}}))):D(r,(function(t){return Et(t,"name")&&Et(t,"items")}))?r:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])}(n),i=L(r,(function(r){var i=J(r.items,(function(r){return 0===r.trim().length?[]:function(t,n,e,o,r,i){return Tt(n,e.toLowerCase()).orThunk((function(){return i.bind((function(t){return it(t,(function(t){return Tt(n,t+e.toLowerCase())}))}))})).fold((function(){return Tt(CT,e.toLowerCase()).map((function(n){return n(t,r)})).orThunk((function(){return w.none()}))}),(function(n){return"grouptoolbarbutton"!==n.type||o?(u=r,a=t,Tt(kT,(i=n).type).fold((function(){return console.error("skipping button defined by",i),w.none()}),(function(t){return w.some(t(i,u,a))}))):(console.warn("Ignoring the '"+e+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),w.none());var i,u,a}))}(t,n.buttons,r,n.allowToolbarGroups,e,o).toArray()}));return{title:w.from(t.translate(r.name)),items:i}}));return W(i,(function(t){return 0<t.items.length}))},_T={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},TT={maxHeightFunction:rc(),maxWidthFunction:vO()},ET={onLtr:function(){return[va,ba,pa,ma,ha,ga,Og,_g,kg,wg,Cg,Sg]},onRtl:function(){return[va,ba,ha,ga,pa,ma,Og,_g,Cg,Sg,kg,wg]}},BT={onLtr:function(){return[ba,ma,ga,pa,ha,va,Og,_g,kg,wg,Cg,Sg]},onRtl:function(){return[ba,ga,ma,ha,pa,va,Og,_g,Cg,Sg,kg,wg]}},AT=function(n,e,o,r){var i,u,a=Fe().deviceType.isTouch,c=Gi((i={sink:o,onEscape:function(){return n.focus(),w.some(!0)}},u=Zn([]),pg.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){u.set([]),pg.getContent(t).each((function(t){Ri(t.element,"visibility")})),bi(t.element,K_),Ri(t.element,"width")},inlineBehaviours:Da([Tm("context-toolbar-events",[$o(uo(),(function(t,n){bi(t.element,K_),Ri(t.element,"width")})),Go(q_,(function(t,n){var e=t.element;Ri(e,"width");var o=ou(e);pg.setContent(t,n.event.contents),vi(e,K_);var r=ou(e);Ei(e,"width",o+"px"),pg.getContent(t).each((function(t){n.event.focus.bind((function(t){return Na(t),ja(e)})).orThunk((function(){return wm.focusIn(t),La(xr(e))}))})),Tg.setTimeout((function(){Ei(t.element,"width",r+"px")}),0)})),Go(X_,(function(t,n){pg.getContent(t).each((function(n){u.set(u.get().concat([{bar:n,focus:La(xr(t.element))}]))})),Po(t,q_,{contents:n.event.forwardContents,focus:w.none()})})),Go(Y_,(function(t,n){ot(u.get()).each((function(n){u.set(u.get().slice(0,u.get().length-1)),Po(t,q_,{contents:Xi(n.bar),focus:n.focus})}))}))]),wm.config({mode:"special",onEscape:function(t){return ot(u.get()).fold((function(){return i.onEscape()}),(function(n){return Vo(t,Y_),w.some(!0)}))}})]),lazySink:function(){return ct.value(i.sink)}}))),s=function(){return U_(n,r.backstage.shared)},f=function(){if(a()&&r.backstage.isContextMenuOpen())return!0;var t,e,o,i,u,c,l=(t=h.get().filter((function(t){return ki(re(t))})).map((function(t){return t.getBoundingClientRect()})).getOrThunk((function(){return n.selection.getRng().getBoundingClientRect()})),e=n.inline?cu().top:vu(re(n.getBody())).y,{y:t.top+e,bottom:t.bottom+e}),f=s();return o=l.y,i=l.bottom,u=f.y,c=f.bottom,!(Math.max(o,u)<=Math.min(i,c))},d=function(){p.set(w.none()),pg.hide(c)},m=function(){pg.hide(c)},g=function(){p.get().each((function(t){var n=c.element;Ri(n,"display"),f()?Ei(n,"display","none"):ys.positionWithinBounds(o,t,c,w.some(s()))}))},p=Zn(w.none()),h=Zn(w.none()),v=Zn(null),b=function(t){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:Da([wm.config({mode:"acyclic"}),Tm("pop-dialog-wrap-events",[Qo((function(t){n.shortcuts.add("ctrl+F9","focus statusbar",(function(){return wm.focusIn(t)}))})),Zo((function(t){n.shortcuts.remove("ctrl+F9")}))])])}},y=Rt((function(){return G_(e,(function(t){var n=x([t]);Po(c,X_,{forwardContents:b(n)})}))})),x=function(t){var e=n.ui.registry.getAll().buttons,o=y(),i=l(l({},e),o.formNavigators),u=Vh(n)===mp.scrolling?mp.scrolling:mp.default,a=K(L(t,(function(t){return"contexttoolbar"===t.type?OT(n,{buttons:i,toolbar:t.items,allowToolbarGroups:!1},r,w.some(["form:"])):(e=t,o=r.backstage.shared.providers,j_(e,o));var e,o})));return h_({type:u,uid:Wr("context-toolbar"),initGroups:a,onEscape:w.none,cyclicKeying:!0,providers:r.backstage.shared.providers})};n.on("contexttoolbar-show",(function(t){var e=y();Tt(e.lookupTable,t.toolbarKey).each((function(e){S([e],t.target===n?w.none():w.some(t)),pg.getContent(c).each(wm.focusIn)}))}));var S=function(t,n){var e,o,i,u;C(),a()&&r.backstage.isContextMenuOpen()||(e=x(t),o=n.map(re),i=function(t,n){var e,o,i="node"===t?r.backstage.shared.anchors.node(n):r.backstage.shared.anchors.cursor();return Ft(i,(e=t,o=a(),"line"===e?{bubble:cc(12,0,_T),layouts:{onLtr:function(){return[ya]},onRtl:function(){return[xa]}},overrides:TT}:{bubble:cc(0,12,_T),layouts:o?BT:ET,overrides:TT}))}(t[0].position,o),p.set(w.some(i)),h.set(n),u=c.element,Ri(u,"display"),pg.showWithinBounds(c,i,b(e),(function(){return w.some(s())})),f()&&Ei(u,"display","none"))},k=function(){var t,e,o,r,i,u,a;n.hasFocus()&&(t=y(),e=t,i=re((o=n).getBody()),u=function(t){return Ve(t,i)},a=re(o.selection.getNode()),(u(r=a)||Pe(i,r)?function(t,n,e){var o=W_(t,n);if(0<o.contextForms.length)return w.some({elem:t,toolbars:[o.contextForms[0]]});var r=W_(t,e);if(0<r.contextForms.length)return w.some({elem:t,toolbars:[r.contextForms[0]]});if(0<o.contextToolbars.length||0<r.contextToolbars.length){var i=function(t){if(t.length<=1)return t;var n=function(n){return H(t,(function(t){return t.position===n}))},e=function(n){return W(t,(function(t){return t.position===n}))},o=n("selection"),r=n("node");if(o||r){if(r&&o){var i=e("node"),u=L(e("selection"),(function(t){return l(l({},t),{position:"node"})}));return i.concat(u)}return e(o?"selection":"node")}return e("line")}(o.contextToolbars.concat(r.contextToolbars));return w.some({elem:t,toolbars:i})}return w.none()}(a,e.inNodeScope,e.inEditorScope).orThunk((function(){return function(t,n,e){return t(n)?w.none():ze(n,(function(t){var n=W_(t,e.inNodeScope),o=n.contextToolbars,r=n.contextForms,i=0<r.length?r:function(t){if(t.length<=1)return t;var n=function(n){return Y(t,(function(t){return t.position===n}))};return n("selection").orThunk((function(){return n("node")})).orThunk((function(){return n("line")})).map((function(t){return t.position})).fold((function(){return[]}),(function(n){return W(t,(function(t){return t.position===n}))}))}(o);return 0<i.length?w.some({elem:t,toolbars:i}):w.none()}),t)}(u,a,e)})):w.none()).fold(d,(function(t){S(t.toolbars,w.some(t.elem.dom))})))},C=function(){var t=v.get();null!==t&&(Tg.clearTimeout(t),v.set(null))},O=function(){C(),v.set(Tg.setEditorTimeout(n,k,0))};n.on("init",(function(){n.on(bO,m),n.on("ScrollContent ScrollWindow longpress",g),n.on("click keyup focus SetContent ObjectResized ResizeEditor",(function(){O()})),n.on("focusout",(function(t){Tg.setEditorTimeout(n,(function(){ja(o.element).isNone()&&ja(c.element).isNone()&&d()}),0)})),n.on("SwitchMode",(function(){n.mode.isReadOnly()&&d()})),n.on("AfterProgressState",(function(t){t.state?d():n.hasFocus()&&O()})),n.on("NodeChange",(function(n){ja(c.element).fold(O,t)}))}))},MT=of,DT=Nl,FT=e([Un("shell",!1),Bn("makeItem"),Un("setupItem",t),fl("listBehaviours",[_m])]),IT=Pl({name:"items",overrides:function(){return{behaviours:Da([_m.config({})])}}}),RT=e([IT]),VT=ff({name:e("CustomList")(),configFields:FT(),partFields:RT(),factory:function(t,n,e,o){var r=t.shell?{behaviours:[_m.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:r.components,behaviours:ll(t.listBehaviours,r.behaviours),apis:{setItems:function(n,e){(function(n){return t.shell?w.some(n):Kl(n,t,"items")})(n).fold((function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(o){var r=_m.contents(o),i=e.length,u=i-r.length,a=0<u?z(u,(function(){return t.makeItem()})):[],c=r.slice(i);j(c,(function(t){return _m.remove(o,t)})),j(a,(function(t){return _m.append(o,t)}));var s=_m.contents(o);j(s,(function(o,r){t.setupItem(n,o,e[r],r)}))}))}}}},apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),PT=e([]),HT=Object.freeze({__proto__:null,setup:t,isDocked:a,getBehaviours:PT}),zT=function(t){return(Fi(t,"position").is("fixed")?w.none():gr(t)).orThunk((function(){var n=ee("span");return dr(t).bind((function(t){Tr(t,n);var e=gr(n);return Ar(n),e}))}))},NT=function(t){return zT(t).map(tu).getOrThunk((function(){return Qi(0,0)}))},LT=At([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),jT=function(t,n){var e=t.element;vi(e,n.transitionClass),bi(e,n.fadeOutClass),vi(e,n.fadeInClass),n.onShow(t)},UT=function(t,n){var e=t.element;vi(e,n.transitionClass),bi(e,n.fadeInClass),vi(e,n.fadeOutClass),n.onHide(t)},WT=function(t,n,e){return $(t,(function(t){switch(t){case"bottom":return r=e,n.bottom<=r.bottom;case"top":return o=e,n.y>=o.y}var o,r}))},GT=function(t,n){return n.getInitialPosition().map((function(n){return pu(n.bounds.x,n.bounds.y,ou(t),Ki(t))}))},XT=function(t,n,e){return e.getInitialPosition().bind((function(o){switch(e.setInitialPosition(w.none()),o.position){case"static":return w.some(LT.static());case"absolute":var r=zT(t).map(hu).getOrThunk((function(){return hu(Ci())}));return w.some(LT.absolute(Wa("absolute",Tt(o.style,"left").map((function(t){return n.x-r.x})),Tt(o.style,"top").map((function(t){return n.y-r.y})),Tt(o.style,"right").map((function(t){return r.right-n.right})),Tt(o.style,"bottom").map((function(t){return r.bottom-n.bottom})))));default:return w.none()}}))},YT=function(t,n,e){var o,r,i,u=t.element;return Fi(u,"position").is("fixed")?(r=n,GT(o=u,i=e).filter((function(t){return WT(i.getModes(),t,r)})).bind((function(t){return XT(o,t,i)}))):function(t,n,e){var o=hu(t);if(WT(e.getModes(),o,n))return w.none();!function(t,n,e){e.setInitialPosition(w.some({style:function(t){var n={},e=t.dom;if(Si(e))for(var o=0;o<e.style.length;o++){var r=e.style.item(o);n[r]=e.style[r]}return n}(t),position:Mi(t,"position")||"static",bounds:n}))}(t,o,e);var r=bu(),i=o.x-r.x,u=n.y-r.y,a=r.bottom-n.bottom,c=o.y<=n.y;return w.some(LT.fixed(Wa("fixed",w.some(i),c?w.some(u):w.none(),w.none(),c?w.none():w.some(a))))}(u,n,e)},qT=function(t,n){j(["left","right","top","bottom","position"],(function(n){return Ri(t.element,n)})),n.onUndocked(t)},KT=function(t,n,e){Ga(t.element,e),("fixed"===e.position?n.onDocked:n.onUndocked)(t)},JT=function(t,n,e,o,r){void 0===r&&(r=!1),n.contextual.each((function(n){n.lazyContext(t).each((function(i){var u,a,c=(a=o,(u=i).y<a.bottom&&u.bottom>a.y);c!==e.isVisible()&&(e.setVisible(c),r&&!c?(xi(t.element,[n.fadeOutClass]),n.onHide(t)):(c?jT:UT)(t,n))}))}))},$T=function(t,n,e){var o,r,i,u,a;t.getSystem().isConnected()&&(o=t,i=e,u=(r=n).lazyViewport(o),(a=i.isDocked())&&JT(o,r,i,u),YT(o,u,i).each((function(t){i.setDocked(!a),t.fold((function(){return qT(o,r)}),(function(t){return KT(o,r,t)}),(function(t){JT(o,r,i,u,!0),KT(o,r,t)}))})))},QT=function(n,e,o){o.isDocked()&&function(n,e,o){var r,i,u=n.element;o.setDocked(!1),r=o,i=n.element,GT(i,r).bind((function(t){return XT(i,t,r)})).each((function(o){o.fold((function(){return qT(n,e)}),(function(t){return KT(n,e,t)}),t)})),o.setVisible(!0),e.contextual.each((function(t){wi(u,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(n)})),$T(n,e,o)}(n,e,o)},ZT=Object.freeze({__proto__:null,refresh:$T,reset:QT,isDocked:function(t,n,e){return e.isDocked()},getModes:function(t,n,e){return e.getModes()},setModes:function(t,n,e,o){return e.setModes(o)}}),tE=Object.freeze({__proto__:null,events:function(t,n){return jo([$o(uo(),(function(e,o){t.contextual.each((function(t){yi(e.element,t.transitionClass)&&(wi(e.element,[t.transitionClass,t.fadeInClass]),(n.isVisible()?t.onShown:t.onHidden)(e)),o.stop()}))})),Go(Co(),(function(e,o){$T(e,t,n)})),Go(Oo(),(function(e,o){QT(e,t,n)}))])}}),nE=[jn("contextual",[Mn("fadeInClass"),Mn("fadeOutClass"),Mn("transitionClass"),Fn("lazyContext"),Uu("onShow"),Uu("onShown"),Uu("onHide"),Uu("onHidden")]),Kn("lazyViewport",bu),Jn("modes",["top","bottom"],kn),Uu("onDocked"),Uu("onUndocked")],eE=Ia({fields:nE,name:"docking",active:tE,apis:ZT,state:Object.freeze({__proto__:null,init:function(t){var n=Zn(!1),e=Zn(!0),o=Zn(w.none()),r=Zn(t.modes);return ai({isDocked:n.get,setDocked:n.set,getInitialPosition:o.get,setInitialPosition:o.set,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+n.get()+", visible: "+e.get()+", modes: "+r.get().join(",")}})}})}),oE={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},rE="tox-tinymce--toolbar-sticky-on",iE="tox-tinymce--toolbar-sticky-off",uE=function(t){var n=t.element;dr(n).each((function(e){var o,r,i="padding-"+eE.getModes(t)[0];eE.isDocked(t)?(o=ou(e),Ei(n,"width",o+"px"),Ei(e,i,Ji(r=n)+(parseInt(Mi(r,"margin-top"),10)||0)+(parseInt(Mi(r,"margin-bottom"),10)||0)+"px")):(Ri(n,"width"),Ri(e,i))}))},aE=function(t,n){n?(bi(t,oE.fadeOutClass),xi(t,[oE.transitionClass,oE.fadeInClass])):(bi(t,oE.fadeInClass),xi(t,[oE.fadeOutClass,oE.transitionClass]))},cE=function(t,n){var e=re(t.getContainer());n?(vi(e,rE),bi(e,iE)):(vi(e,iE),bi(e,rE))},sE=function(t,n){var e,o=Zn(w.none()),r=n.getSink,i=function(t){r().each((function(n){return t(n.element)}))},u=function(n){t.inline||uE(n),cE(t,eE.isDocked(n)),n.getSystem().broadcastOn([Us()],{}),r().each((function(t){return t.getSystem().broadcastOn([Us()],{})}))},a=t.inline?[]:[Ha.config({channels:((e={})[s_()]={onReceive:uE},e)})];return d([Dm.config({}),eE.config({contextual:l({lazyContext:function(n){var e,o=Ji(n.element),r=t.inline?t.getContentAreaContainer():t.getContainer(),i=hu(re(r)),u=i.height-o,a=i.y+(e=n,"top",P(eE.getModes(e),"top")?0:o);return w.some(pu(i.x,a,i.width,u))},onShow:function(){i((function(t){return aE(t,!0)}))},onShown:function(t){i((function(t){return wi(t,[oE.transitionClass,oE.fadeInClass])})),o.get().each((function(n){var e,r,i;e=t.element,i=cr(r=n),La(i).filter((function(t){return!Ve(r,t)})).filter((function(t){return Ve(t,re(i.dom.body))||Pe(e,t)})).each((function(){return Na(r)})),o.set(w.none())}))},onHide:function(t){var n,e;o.set((n=t.element,e=r,ja(n).orThunk((function(){return e().toOptional().bind((function(t){return ja(t.element)}))})))),i((function(t){return aE(t,!1)}))},onHidden:function(){i((function(t){return wi(t,[oE.transitionClass])}))}},oE),modes:[n.header.getDockingMode()],onDocked:u,onUndocked:u})],a)},lE=Object.freeze({__proto__:null,setup:function(t,n,e){t.inline||(n.header.isPositionedAtTop()||t.on("ResizeEditor",(function(){e().each(eE.reset)})),t.on("ResizeWindow ResizeEditor",(function(){e().each(uE)})),t.on("SkinLoaded",(function(){e().each((function(t){eE.isDocked(t)?eE.reset(t):eE.refresh(t)}))})),t.on("FullscreenStateChanged",(function(){e().each(eE.reset)}))),t.on("AfterScrollIntoView",(function(t){e().each((function(n){eE.refresh(n);var e,o,r,i,u,a,c,s,l,f,d,m,g,p,h,v,b,y=n.element;pd(y)&&(e=t,u=(i=cr(o=y)).dom.defaultView.innerHeight,a=cu(i),c=re(e.elm),s=vu(c),l=Ki(c),d=(f=s.y)+l,m=tu(o),g=Ki(o),h=(p=m.top)+g,v=Math.abs(p-a.top)<2,b=Math.abs(h-(a.top+u))<2,v&&f<h?su(a.left,f-g,i):b&&p<d&&(r=f-u+l+g,su(a.left,r,i)))}))})),t.on("PostRender",(function(){cE(t,!1)}))},isDocked:function(t){return t().map(eE.isDocked).getOr(!1)},getBehaviours:sE}),fE=lf({factory:function(t,n){var e={focus:wm.focusIn,setMenus:function(t,e){var o=L(e,(function(t){var e={type:"menubutton",text:t.text,fetch:function(n){n(t.getItems())}},o=x_(e).mapError((function(t){return vn(t)})).getOrDie();return wk(o,"tox-mbtn",n.backstage,w.some("menuitem"))}));_m.set(t,o)}};return{uid:t.uid,dom:t.dom,components:[],behaviours:Da([_m.config({}),Tm("menubar-events",[Qo((function(n){t.onSetup(n)})),Go(Qe(),(function(t,n){_u(t.element,".tox-mbtn--active").each((function(e){Tu(n.event.target,".tox-mbtn").each((function(n){Ve(e,n)||t.getSystem().getByDom(e).each((function(e){t.getSystem().getByDom(n).each((function(t){Qy.expand(t),Qy.close(e),Dm.focus(t)}))}))}))}))})),Go(Ao(),(function(t,n){n.event.prevFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(e){n.event.newFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(t){Qy.isOpen(e)&&(Qy.expand(t),Qy.close(e))}))}))}))]),wm.config({mode:"flow",selector:".tox-mbtn",onEscape:function(n){return t.onEscape(n),w.some(!0)}}),Wb.config({})]),apis:e,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[Bn("dom"),Bn("uid"),Bn("onEscape"),Bn("backstage"),Un("onSetup",t)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),dE="container",mE=[cl("slotBehaviours",[])],gE=function(t){return"<alloy.field."+t+">"},pE=function(t,n){var e,o=function(n){return Zl(t)},r=function(n,e){return function(o,r){return Kl(o,t,r).map((function(t){return n(t,r)})).getOr(e)}},i=function(t,n){return"true"!==Vr(t.element,"aria-hidden")},u=r(i,!1),a=r((function(t,n){var e;i(t)&&(e=t.element,Ei(e,"display","none"),Rr(e,"aria-hidden","true"),Po(t,Mo(),{name:n,visible:!1}))})),c=r((function(t,n){var e;i(t)||(e=t.element,Ri(e,"display"),zr(e,"aria-hidden"),Po(t,Mo(),{name:n,visible:!0}))})),s={getSlotNames:o,getSlot:function(n,e){return Kl(n,t,e)},isShowing:u,hideSlot:e=a,hideAllSlots:function(t){return function(t,n){j(n,(function(n){return e(t,n)}))}(t,o())},showSlot:c};return{uid:t.uid,dom:t.dom,components:n,behaviours:sl(t.slotBehaviours),apis:s}},hE=St({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},ii),vE=l(l({},hE),{sketch:function(t){var n,e=(n=[],{slot:function(t,e){return n.push(t),Wl(dE,gE(t),e)},record:function(){return n}}),o=t(e),r=e.record(),i=L(r,(function(t){return Rl({name:t,pname:gE(t)})}));return uf(dE,mE,i,pE,o)}}),bE=tn([Nn("icon"),Nn("tooltip"),Kn("onShow",t),Kn("onHide",t),Kn("onSetup",(function(){return t}))]),yE=function(t){return{element:function(){return t.element.dom}}},xE=function(n,e){var o=L(yt(e),(function(t){var n=e[t],o=pn(gn("sidebar",bE,n));return{name:t,getApi:yE,onSetup:o.onSetup,onShow:o.onShow,onHide:o.onHide}}));return L(o,(function(e){var r=Zn(t);return n.slot(e.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Qp([ov(e,r),rv(e,r),Go(Mo(),(function(t,n){var e=n.event;Y(o,(function(t){return t.name===e.name})).each((function(n){(e.visible?n.onShow:n.onHide)(n.getApi(t))}))}))])})}))},wE=function(t){return vf.getCurrent(t).bind((function(t){return o_.isGrowing(t)||o_.hasGrown(t)?vf.getCurrent(t).bind((function(t){return Y(vE.getSlotNames(t),(function(n){return vE.isShowing(t,n)}))})):w.none()}))},SE=Wr("FixSizeEvent"),kE=Wr("AutoSizeEvent"),CE=function(t){var n,e,o,r=ne(t),i=pr(r),u=(e=void 0!==(n=r).dom.attributes?n.dom.attributes:[],X(e,(function(t,n){var e;return"class"===n.name?t:l(l({},t),((e={})[n.name]=n.value,e))}),{})),a=(o=r,Array.prototype.slice.call(o.dom.classList,0)),c=0===i.length?{}:{innerHtml:Dr(r)};return l({tag:er(r),classes:a,attributes:u},c)},OE=DT.optional({factory:fE,name:"menubar",schema:[Bn("backstage")]}),_E=DT.optional({factory:{sketch:function(t){return VT.sketch({uid:t.uid,dom:t.dom,listBehaviours:Da([wm.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return h_({type:t.type,uid:Wr("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:function(){return t.onEscape(),w.some(!0)}})},setupItem:function(t,n,e,o){wO.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[Bn("dom"),Bn("onEscape")]}),TE=DT.optional({factory:{sketch:function(t){var n;return((n=t).type===mp.sliding?p_:n.type===mp.floating?g_:h_)({type:t.type,uid:t.uid,onEscape:function(){return t.onEscape(),w.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes})}},name:"toolbar",schema:[Bn("dom"),Bn("onEscape"),Bn("getSink")]}),EE=DT.optional({factory:{sketch:function(t){var n=t.editor,e=t.sticky?sE:PT;return{uid:t.uid,dom:t.dom,components:t.components,behaviours:Da(e(n,t.sharedBackstage))}}},name:"header",schema:[Bn("dom")]}),BE=DT.optional({name:"socket",schema:[Bn("dom")]}),AE=DT.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:Da([Wb.config({}),Dm.config({}),o_.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){vf.getCurrent(t).each(vE.hideAllSlots),Vo(t,kE)},onGrown:function(t){Vo(t,kE)},onStartGrow:function(t){Po(t,SE,{width:Fi(t.element,"width").getOr("")})},onStartShrink:function(t){Po(t,SE,{width:ou(t.element)+"px"})}}),_m.config({}),vf.config({find:function(t){var n=_m.contents(t);return et(n)}})])}],behaviours:Da([tS(0),Tm("sidebar-sliding-events",[Go(SE,(function(t,n){Ei(t.element,"width",n.event.width)})),Go(kE,(function(t,n){Ri(t.element,"width")}))])])}}},name:"sidebar",schema:[Bn("dom")]}),ME=DT.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:Da([_m.config({})]),components:[]}}},name:"throbber",schema:[Bn("dom")]}),DE=ff({name:"OuterContainer",factory:function(t,n,e){var o={getSocket:function(n){return MT.getPart(n,t,"socket")},setSidebar:function(n,e){MT.getPart(n,t,"sidebar").each((function(t){return function(t,n){vf.getCurrent(t).each((function(t){return _m.set(t,[(e=n,vE.sketch((function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:xE(t,e),slotBehaviours:Qp([Qo((function(t){return vE.hideAllSlots(t)}))])}})))]);var e}))}(t,e)}))},toggleSidebar:function(n,e){MT.getPart(n,t,"sidebar").each((function(t){return n=t,o=e,void vf.getCurrent(n).each((function(t){vf.getCurrent(t).each((function(n){o_.hasGrown(t)?vE.isShowing(n,o)?o_.shrink(t):(vE.hideAllSlots(n),vE.showSlot(n,o)):(vE.hideAllSlots(n),vE.showSlot(n,o),o_.grow(t))}))}));var n,o}))},whichSidebar:function(n){return MT.getPart(n,t,"sidebar").bind(wE).getOrNull()},getHeader:function(n){return MT.getPart(n,t,"header")},getToolbar:function(n){return MT.getPart(n,t,"toolbar")},setToolbar:function(n,e){MT.getPart(n,t,"toolbar").each((function(t){t.getApis().setGroups(t,e)}))},setToolbars:function(n,e){MT.getPart(n,t,"multiple-toolbar").each((function(t){VT.setItems(t,e)}))},refreshToolbar:function(n){MT.getPart(n,t,"toolbar").each((function(t){return t.getApis().refresh(t)}))},toggleToolbarDrawer:function(n){MT.getPart(n,t,"toolbar").each((function(t){var n,e;e=function(n){return n(t)},null!=(n=t.getApis().toggle)?w.some(e(n)):w.none()}))},isToolbarDrawerToggled:function(n){return MT.getPart(n,t,"toolbar").bind((function(t){return w.from(t.getApis().isOpen).map((function(n){return n(t)}))})).getOr(!1)},getThrobber:function(n){return MT.getPart(n,t,"throbber")},focusToolbar:function(n){MT.getPart(n,t,"toolbar").orThunk((function(){return MT.getPart(n,t,"multiple-toolbar")})).each((function(t){wm.focusIn(t)}))},setMenubar:function(n,e){MT.getPart(n,t,"menubar").each((function(t){fE.setMenus(t,e)}))},focusMenubar:function(n){MT.getPart(n,t,"menubar").each((function(t){fE.focus(t)}))}};return{uid:t.uid,dom:t.dom,components:n,apis:o,behaviours:t.behaviours}},configFields:[Bn("dom"),Bn("behaviours")],partFields:[EE,OE,TE,_E,BE,AE,ME],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getHeader:function(t,n){return t.getHeader(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){var o=L(e,f_);t.setToolbar(n,o)},setToolbars:function(t,n,e){var o=L(e,(function(t){return L(t,f_)}));t.setToolbars(n,o)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},toggleToolbarDrawer:function(t,n){t.toggleToolbarDrawer(n)},isToolbarDrawerToggled:function(t,n){return t.isToolbarDrawerToggled(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),FE={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},IE=function(t){return"string"==typeof t?t.split(" "):t},RE=function(t,n){var e=l(l({},FE),n.menus),o=0<yt(n.menus).length,r=void 0===n.menubar||!0===n.menubar?IE("file edit view insert format tools table help"):IE(!1===n.menubar?"":n.menubar),i=W(r,(function(t){return o&&n.menus.hasOwnProperty(t)&&n.menus[t].hasOwnProperty("items")||FE.hasOwnProperty(t)})),u=L(i,(function(o){var r,i,u,a=e[o];return r={title:a.title,items:IE(a.items)},i=n,u=t.getParam("removed_menuitems","").split(/[ ,]/),{text:r.title,getItems:function(){return J(r.items,(function(t){var n=t.toLowerCase();return 0===n.trim().length||H(u,(function(t){return t===n}))?[]:"separator"===n||"|"===n?[{type:"separator"}]:i.menuItems[n]?[i.menuItems[n]]:[]}))}}}));return W(u,(function(t){return 0<t.getItems().length&&H(t.getItems(),(function(t){return"separator"!==t.type}))}))},VE=function(t){var n=function(){t._skinLoaded=!0,t.fire("SkinLoaded")};return function(){t.initialized?n():t.on("init",n)}},PE=function(t,n,e){return new Gg((function(o,r){e.load(n,o,r),t.on("remove",(function(){return e.unload(n)}))}))},HE=function(t,n){var e;return e=re(t.getElement()),Sr(e).isSome()?PE(t,n+"/skin.shadowdom.min.css",ah.DOM.styleSheetLoader):Gg.resolve()},zE=function(t,n){var e,o,r,i,u,a=(r=(e=n).getParam("skin"),i=e.getParam("skin_url"),!1!==r&&(o=r||"oxide",i=i?e.documentBaseURI.toAbsolute(i):kh.baseURL+"/skins/ui/"+o),i);a&&n.contentCSS.push(a+(t?"/content.inline":"/content")+".min.css"),0==(!1===n.getParam("skin"))&&C(a)?Gg.all([PE(u=n,a+"/skin.min.css",u.ui.styleSheetLoader),HE(n,a)]).then(VE(n),function(t,n){return function(){return e={message:n},t.fire("SkinLoadError",e);var e}}(n,"Skin could not be loaded")):VE(n)()},NE=r(zE,!1),LE=r(zE,!0),jE=function(t,n,e,o){var r,i=n.outerContainer,u=e.toolbar,a=e.buttons;D(u,C)?(r=u.map((function(n){var r={toolbar:n,buttons:a,allowToolbarGroups:e.allowToolbarGroups};return OT(t,r,{backstage:o},w.none())})),DE.setToolbars(i,r)):DE.setToolbar(i,OT(t,e,{backstage:o},w.none()))},UE=Fe(),WE=UE.os.isiOS()&&UE.os.version.major<=12,GE=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=Zn(0),u=n.outerContainer;NE(t);var a,c,s=re(r.targetNode),l=wr(xr(s));a=s,c=n.mothership,As(a,c,Or),Bs(l,n.uiMothership),t.on("PostRender",(function(){jE(t,n,e,o),i.set(t.getWin().innerWidth),DE.setMenubar(u,RE(t,e)),DE.setSidebar(u,e.sidebar),function(t,n){var e=t.dom,o=t.getWin(),r=t.getDoc().documentElement,i=Zn(Qi(o.innerWidth,o.innerHeight)),u=Zn(Qi(r.offsetWidth,r.offsetHeight)),a=function(){var n=i.get();n.left===o.innerWidth&&n.top===o.innerHeight||(i.set(Qi(o.innerWidth,o.innerHeight)),jv(t))},c=function(){var n=t.getDoc().documentElement,e=u.get();e.left===n.offsetWidth&&e.top===n.offsetHeight||(u.set(Qi(n.offsetWidth,n.offsetHeight)),jv(t))},s=function(n){return e=n,t.fire("ScrollContent",e);var e};e.bind(o,"resize",a),e.bind(o,"scroll",s);var l=Sb(re(t.getBody()),"load",c),f=n.uiMothership.element;t.on("hide",(function(){Ei(f,"display","none")})),t.on("show",(function(){Ri(f,"display")})),t.on("NodeChange",c),t.on("remove",(function(){l.unbind(),e.unbind(o,"resize",a),e.unbind(o,"scroll",s),o=null}))}(t,n)}));var f,d,m,g,p=DE.getSocket(u).getOrDie("Could not find expected socket element");WE&&(Bi(p.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"}),m=function(){t.fire("ScrollContent")},20,g=null,f={cancel:function(){null!==g&&(clearTimeout(g),g=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];null===g&&(g=setTimeout((function(){m.apply(null,t),g=null}),20))}},d=wb(p.element,"scroll",f.throttle),t.on("remove",d.unbind)),Jh(t,n),t.addCommand("ToggleSidebar",(function(n,e){DE.toggleSidebar(u,e),t.fire("ToggleSidebar")})),t.addQueryValueHandler("ToggleSidebar",(function(){return DE.whichSidebar(u)}));var h=Vh(t);h!==mp.sliding&&h!==mp.floating||t.on("ResizeWindow ResizeEditor ResizeContent",(function(){var e=t.getWin().innerWidth;e!==i.get()&&(DE.refreshToolbar(n.outerContainer),i.set(e))}));var v={enable:function(){Kh(n,!1)},disable:function(){Kh(n,!0)},isDisabled:function(){return Sh.isDisabled(u)}};return{iframeContainer:p.element.dom,editorContainer:u.element.dom,api:v}}}),XE=function(t){return/^[0-9\.]+(|px)$/i.test(""+t)?w.some(parseInt(""+t,10)):w.none()},YE=function(t){return M(t)?t+"px":t},qE=function(t,n,e){var o=n.filter((function(n){return t<n})),r=e.filter((function(n){return n<t}));return o.or(r).getOr(t)},KE=function(t){var n=Oh(t),e=_h(t),o=Eh(t);return XE(n).map((function(t){return qE(t,e,o)}))},JE=function(t,n){var e=hu(t);return{pos:n?e.y:e.bottom,bounds:e}},$E=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=n.mothership,u=n.uiMothership,a=n.outerContainer,c=Zn(null),s=re(r.targetNode),l=function(t,n,e,o,r){var i=e.uiMothership,u=e.outerContainer,a=ah.DOM,c=Uh(t),s=Xh(t),l=Eh(t).or(KE(t)),f=o.shared.header,d=f.isPositionedAtTop,m=Vh(t),g=m===mp.sliding||m===mp.floating,p=Zn(!1),h=function(){return p.get()&&!t.removed},v=function(t){return g?t.fold((function(){return 0}),(function(t){return 1<t.components().length?Ki(t.components()[1].element):0})):0},b=function(){i.broadcastOn([Us()],{})},y=function(t){var e,o,i,a,f,m;void 0===t&&(t=!1),h()&&(c||(e=l.getOrThunk((function(){var t=XE(Mi(Ci(),"margin-left")).getOr(0);return ou(Ci())-tu(n).left+t})),Ei(r.get().element,"max-width",e+"px")),g&&DE.refreshToolbar(u),c||(o=DE.getToolbar(u),i=v(o),a=hu(n),f=d()?Math.max(a.y-Ki(r.get().element)+i,0):a.bottom,Bi(u.element,{position:"absolute",top:Math.round(f)+"px",left:Math.round(a.x)+"px"})),s&&(m=r.get(),t?eE.reset(m):eE.refresh(m)),b())},x=function(e){var o,i;void 0===e&&(e=!0),!c&&s&&h()&&(o=f.getDockingMode(),(i=function(e){switch(Nh(t)){case Ih.auto:var o=DE.getToolbar(u),r=v(o),i=Ki(e.element)-r,a=hu(n);if(a.y>i)return"top";var c=lr(n),s=Math.max(c.dom.scrollHeight,Ki(c));return a.bottom<s-i||bu().bottom<a.bottom-i?"bottom":"top";case Ih.bottom:return"bottom";case Ih.top:default:return"top"}}(r.get()))!==o&&(function(t){var n=r.get();eE.setModes(n,[t]),f.setDockingMode(t);var e=d()?Au.TopToBottom:Au.BottomToTop;Rr(n.element,hc,e)}(i),e&&y(!0)))};return{isVisible:h,isPositionedAtTop:d,show:function(){p.set(!0),Ei(u.element,"display","flex"),a.addClass(t.getBody(),"mce-edit-focus"),Ri(i.element,"display"),x(!1),y()},hide:function(){p.set(!1),e.outerContainer&&(Ei(u.element,"display","none"),a.removeClass(t.getBody(),"mce-edit-focus")),Ei(i.element,"display","none")},update:y,updateMode:x,repositionPopups:b}}(t,s,n,o,c),f=t.getParam("toolbar_persist",!1,"boolean");LE(t);var d=function(){var r;c.get()?l.show():(c.set(DE.getHeader(a).getOrDie()),r=Wh(t),Bs(r,i),Bs(r,u),jE(t,n,e,o),DE.setMenubar(a,RE(t,e)),l.show(),function(t,n,e,o){var r=Zn(JE(n,e.isPositionedAtTop())),i=function(o){var i=JE(n,e.isPositionedAtTop()),u=i.pos,a=i.bounds,c=r.get(),s=c.pos,l=c.bounds,f=a.height!==l.height||a.width!==l.width;r.set({pos:u,bounds:a}),f&&jv(t,o),e.isVisible()&&(s!==u?e.update(!0):f&&(e.updateMode(),e.repositionPopups()))};o||(t.on("activate",e.show),t.on("deactivate",e.hide)),t.on("SkinLoaded ResizeWindow",(function(){return e.update(!0)})),t.on("NodeChange keydown",(function(t){Tg.requestAnimationFrame((function(){return i(t)}))})),t.on("ScrollWindow",(function(){return e.updateMode()}));var u=hT();u.set(Sb(re(t.getBody()),"load",i)),t.on("remove",(function(){u.clear()}))}(t,s,l,f),t.nodeChanged())};t.on("show",d),t.on("hide",l.hide),f||(t.on("focus",d),t.on("blur",l.hide)),t.on("init",(function(){(t.hasFocus()||f)&&d()})),Jh(t,n);var m={show:function(){l.show()},hide:function(){l.hide()},enable:function(){Kh(n,!1)},disable:function(){Kh(n,!0)},isDisabled:function(){return Sh.isDisabled(a)}};return{editorContainer:a.element.dom,api:m}}}),QE={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},ZE=(Z_="[eE][+-]?[0-9]+",nT=["Infinity",(Q_="[0-9]+")+"\\."+(tT=function(t){return"(?:"+t+")?"})(Q_)+tT(Z_),"\\."+Q_+tT(Z_),Q_+tT(Z_)].join("|"),new RegExp("^([+-]?(?:"+nT+"))(.*)$")),tB=function(t){return function(t,n){return w.from(ZE.exec(t)).bind((function(t){var e,o=Number(t[1]),r=t[2];return e=r,H(n,(function(t){return H(QE[t],(function(t){return e===t}))}))?w.some({value:o,unit:r}):w.none()}))}(t,["fixed","relative","empty"]).map((function(t){return t.value+t.unit})).getOr(t)},nB=function(t){var n=t.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" "),e=new Map,o=pT(),r=function(){var n=tB(t.queryCommandValue("LineHeight"));w.from(e.get(n)).fold((function(){return o.clear()}),(function(t){o.set({destroy:function(){t.setActive(!1)}}),t.setActive(!0)}))};return t.on("nodeChange",r),L(n,(function(i,u){return{type:"togglemenuitem",text:i,onSetup:function(a){return e.set(tB(i),a),u+1===n.length&&r(),function(){0===u&&(t.off("nodeChange",r),o.clear())}},onAction:function(){return t.execCommand("LineHeight",!1,i)}}}))},eB=function(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}},oB=function(t){var n;(function(t){var n,e;!function(t){rS.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(n,e){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onSetup:vT(t,n.name),onAction:eB(t,n.name)})}));for(var n=1;n<=6;n++){var e="h"+n;t.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+n,onSetup:vT(t,e),onAction:eB(t,e)})}}(t),n=t,rS.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(t){n.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)}})})),e=t,rS.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(t){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return e.execCommand(t.action)},onSetup:vT(e,t.name)})}))})(t),n=t,rS.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(t){n.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:function(){return n.execCommand(t.action)}})})),n.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:eB(n,"code")})},rB=function(t,n,e){var o=function(){return!!n.undoManager&&n.undoManager[e]()},r=function(){t.setDisabled(n.mode.isReadOnly()||!o())};return t.setDisabled(!o()),n.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r),function(){return n.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r)}},iB=function(t,n){var e,o,r,i;!function(t){rS.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],(function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,onAction:function(){return t.execCommand(n.cmd)},icon:n.icon,onSetup:vT(t,n.name)})}));t.ui.registry.addButton("alignnone",{tooltip:"No alignment",onAction:function(){return t.execCommand("JustifyNone")},icon:"align-none"})}(t),oB(t),function(t,n){var e,o,r,i,u,a,c,s,f,d,m,g,p,h;r=J_(0,o=n,uT(e=t)),e.ui.registry.addNestedMenuItem("align",{text:o.shared.providers.translate("Align"),getSubmenuItems:function(){return r.items.validateItems(r.getStyleItems())}}),a=J_(0,u=n,sT(i=t)),i.ui.registry.addNestedMenuItem("fontformats",{text:u.shared.providers.translate("Fonts"),getSubmenuItems:function(){return a.items.validateItems(a.getStyleItems())}}),c=t,f=l({type:"advanced"},(s=n).styleselect),d=J_(0,s,xT(c,f)),c.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return d.items.validateItems(d.getStyleItems())}}),g=J_(0,n,yT(m=t)),m.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return g.items.validateItems(g.getStyleItems())}}),h=J_(0,n,dT(p=t)),p.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return h.items.validateItems(h.getStyleItems())}})}(t,n),function(t){var n,e;(n=t).ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(t){return rB(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(t){return rB(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}}),(e=t).ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(t){return rB(t,e,"hasUndo")},onAction:function(){return e.execCommand("undo")}}),e.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(t){return rB(t,e,"hasRedo")},onAction:function(){return e.execCommand("redo")}})}(t),function(t){!function(t){t.addCommand("mceApplyTextcolor",(function(n,e){var o,r,i;r=n,i=e,(o=t).undoManager.transact((function(){o.focus(),o.formatter.apply(r,{value:i}),o.nodeChanged()}))})),t.addCommand("mceRemoveTextcolor",(function(n){var e,o;o=n,(e=t).undoManager.transact((function(){e.focus(),e.formatter.remove(o,{value:null},null,!0),e.nodeChanged()}))}))}(t);var n=Zn(null),e=Zn(null);eb(t,"forecolor","forecolor","Text color",n),eb(t,"backcolor","hilitecolor","Background color",e),ob(t,"forecolor","forecolor","Text color"),ob(t,"backcolor","hilitecolor","Background color")}(t),(o=e=t).ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return o.execCommand("mceToggleVisualAid")}}),(r=e).ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(t){return function(t,n){t.setActive(n.hasVisual);var e=function(n){t.setActive(n.hasVisual)};return n.on("VisualAid",e),function(){return n.off("VisualAid",e)}}(t,r)},onAction:function(){r.execCommand("mceToggleVisualAid")}}),(i=t).ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(t){return function(t,n){t.setDisabled(!n.queryCommandState("outdent"));var e=function(){t.setDisabled(!n.queryCommandState("outdent"))};return n.on("NodeChange",e),function(){return n.off("NodeChange",e)}}(t,i)},onAction:function(){return i.execCommand("outdent")}}),i.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return i.execCommand("indent")}}),function(t){var n,e;(n=t).ui.registry.addNestedMenuItem("lineheight",{type:"nestedmenuitem",text:"Line height",getSubmenuItems:function(){return nB(n)}}),(e=t).ui.registry.addMenuButton("lineheight",{tooltip:"Line height",icon:"line-height",fetch:function(t){return t(nB(e))}})}(t)},uB=function(t,n){return{anchor:"makeshift",x:t,y:n}},aB=function(t){return"longpress"===t.type||0===t.type.indexOf("touch")},cB=function(t,n){return"contextmenu"===n.type||"longpress"===n.type?t.inline?function(t){if(aB(t)){var n=t.touches[0];return uB(n.pageX,n.pageY)}return uB(t.pageX,t.pageY)}(n):function(t,n){var e,o,r,i=ah.DOM.getPos(t);return e=n,o=i.x,r=i.y,uB(e.x+o,e.y+r)}(t.getContentAreaContainer(),function(t){if(aB(t)){var n=t.touches[0];return uB(n.clientX,n.clientY)}return uB(t.clientX,t.clientY)}(n)):sB(t)},sB=function(t){return{anchor:"selection",root:re(t.selection.getNode())}},lB=function(t){return{anchor:"node",node:w.some(re(t.selection.getNode())),root:re(t.getBody())}},fB=function(t,n,e,o,r,i){var u=e(),a=i?lB(t):cB(t,n);yk(u,pp.CLOSE_ON_EXECUTE,o,!1).map((function(t){n.preventDefault(),pg.showMenuAt(r,a,{menu:{markers:Ep("normal")},data:t})}))},dB={onLtr:function(){return[ba,ma,ga,pa,ha,va,Og,_g,kg,wg,Cg,Sg]},onRtl:function(){return[ba,ga,ma,ha,pa,va,Og,_g,Cg,Sg,kg,wg]}},mB={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},gB=function(t,n,e,o,r,i){var u,a=Fe(),c=a.os.isiOS(),s=a.os.isOSX(),f=a.os.isAndroid(),d=a.deviceType.isTouch(),m=function(){var u=e();!function(t,n,e,o,r,i,u){var a,c,s=i?lB(t):(a=t,c=n,l({bubble:cc(0,12,mB),layouts:dB,overrides:{maxWidthFunction:vO(),maxHeightFunction:rc()}},cB(a,c)));yk(e,pp.CLOSE_ON_EXECUTE,o,!0).map((function(e){n.preventDefault(),pg.showMenuWithinBounds(r,s,{menu:{markers:Ep("normal"),highlightImmediately:u},data:e,type:"horizontal"},(function(){return w.some(U_(t,o.shared))})),t.fire(bO)}))}(t,n,u,o,r,i,!(f||c||s&&d))};!s&&!c||i?(f&&!i&&t.selection.setCursorLocation(n.target,0),m()):(u=function(){!function(t){var n=t.selection.getRng(),e=function(){Tg.setEditorTimeout(t,(function(){t.selection.setRng(n)}),10),i()};t.once("touchend",e);var o=function(t){t.preventDefault(),t.stopImmediatePropagation()};t.on("mousedown",o,!0);var r=function(){return i()};t.once("longpresscancel",r);var i=function(){t.off("touchend",e),t.off("longpresscancel",r),t.off("mousedown",o)}}(t),m()},function(t,n){var e=t.selection;if(e.isCollapsed()||n.touches.length<1)return!1;var o=n.touches[0],r=e.getRng();return Jc(t.getWin(),Pc.domRange(r)).exists((function(t){return t.left<=o.clientX&&t.right>=o.clientX&&t.top<=o.clientY&&t.bottom>=o.clientY}))}(t,n)?u():(t.once("selectionchange",u),t.once("touchend",(function(){return t.off("selectionchange",u)}))))},pB=function(t){return"string"==typeof t?t.split(/[ ,]/):t},hB=function(t){return t.getParam("contextmenu_never_use_native",!1,"boolean")},vB=function(t){return C(t)?"|"===t:"separator"===t.type},bB={type:"separator"},yB=function(t){var n,e=function(t){return{text:t.text,icon:t.icon,disabled:t.disabled,shortcut:t.shortcut}};if(C(t))return t;switch(t.type){case"separator":return bB;case"submenu":return l(l({type:"nestedmenuitem"},e(t)),{getSubmenuItems:function(){var n=t.getSubmenuItems();return C(n)?n:L(n,yB)}});default:return l(l({type:"menuitem"},e(t)),{onAction:(n=t.onAction,function(){return n()})})}},xB=function(t,n){if(0===n.length)return t;var e=ot(t).filter((function(t){return!vB(t)})).fold((function(){return[]}),(function(t){return[bB]}));return t.concat(e).concat(n).concat([bB])},wB=function(t,n){return"longpress"!==n.type&&(2!==n.button||n.target===t.getBody()&&""===n.pointerType)},SB=function(t,n){return wB(t,n)?t.selection.getStart(!0):n.target},kB=function(t,n,e){var o=Fe().deviceType.isTouch,r=Gi(pg.sketch({dom:{tag:"div"},lazySink:n,onEscape:function(){return t.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:Da([Tm("dismissContextMenu",[Go(Eo(),(function(n,e){Ls.close(n),t.focus()}))])])})),i=function(t){return pg.hide(r)},u=function(n){var i,u;hB(t)&&n.preventDefault(),i=t,n.ctrlKey&&!hB(i)||!1===t.getParam("contextmenu")||(u=function(t,n){var e=t.getParam("contextmenu_avoid_overlap","","string");if(wB(t,n))return!0;if(e){var o=SB(t,n);return Cb(re(o),e)}return!1}(t,n),(o()?gB:fB)(t,n,(function(){var e,o,r,i=SB(t,n),u=t.ui.registry.getAll(),a=function(t){return e=(n=t).ui.registry.getAll().contextMenus,w.from(n.getParam("contextmenu")).map(pB).getOrThunk((function(){return W(pB("link linkchecker image imagetools table spellchecker configurepermanentpen"),(function(t){return Et(e,t)}))}));var n,e}(t);return e=u.contextMenus,o=i,0<(r=X(a,(function(t,n){return Tt(e,n.toLowerCase()).map((function(n){var e=n.update(o);if(C(e))return xB(t,e.split(" "));if(0<e.length){var r=L(e,yB);return xB(t,r)}return t})).getOrThunk((function(){return t.concat([n])}))}),[])).length&&vB(r[r.length-1])&&r.pop(),r}),e,r,u))};t.on("init",(function(){var n="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(o()?"":" ResizeWindow");t.on(n,i),t.on("longpress contextmenu",u)}))},CB=At([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),OB=function(t){return function(n){return n.translate(-t.left,-t.top)}},_B=function(t){return function(n){return n.translate(t.left,t.top)}},TB=function(t){return function(n,e){return X(t,(function(t,n){return n(t)}),Qi(n,e))}},EB=function(t,n,e){return t.fold(TB([_B(e),OB(n)]),TB([OB(n)]),TB([]))},BB=function(t,n,e){return t.fold(TB([_B(e)]),TB([]),TB([_B(n)]))},AB=function(t,n,e){return t.fold(TB([]),TB([OB(e)]),TB([_B(n),OB(e)]))},MB=function(t,n,e){var o=t.fold((function(t,n){return{position:w.some("absolute"),left:w.some(t+"px"),top:w.some(n+"px")}}),(function(t,n){return{position:w.some("absolute"),left:w.some(t-e.left+"px"),top:w.some(n-e.top+"px")}}),(function(t,n){return{position:w.some("fixed"),left:w.some(t+"px"),top:w.some(n+"px")}}));return l({right:w.none(),bottom:w.none()},o)},DB=function(t,n,e,o){var r=function(t,r){return function(i,u){var a=t(n,e,o);return r(i.getOr(a.left),u.getOr(a.top))}};return t.fold(r(AB,FB),r(BB,IB),r(EB,RB))},FB=CB.offset,IB=CB.absolute,RB=CB.fixed,VB=function(t,n){var e=Vr(t,n);return E(e)?NaN:parseInt(e,10)},PB=function(t,n,e,o,r,i){var u,a,c,s=function(t,n,e,o){return r=n,i=t.element,u=VB(i,r.leftAttr),a=VB(i,r.topAttr),(isNaN(u)||isNaN(a)?w.none():w.some(Qi(u,a))).fold((function(){return e}),(function(t){return RB(t.left+o.left,t.top+o.top)}));var r,i,u,a}(t,n,e,o),l=(n.mustSnap?zB:NB)(t,n,s,r,i),f=EB(s,r,i);return u=n,a=f,c=t.element,Rr(c,u.leftAttr,a.left+"px"),Rr(c,u.topAttr,a.top+"px"),l.fold((function(){return{coord:RB(f.left,f.top),extra:w.none()}}),(function(t){return{coord:t.output,extra:t.extra}}))},HB=function(t,n,e,o){return it(t,(function(t){var r,i,u,a,c,s,l,f,d=t.sensor;return r=n,i=d,u=t.range.left,a=t.range.top,l=BB(r,c=e,s=o),f=BB(i,c,s),Math.abs(l.left-f.left)<=u&&Math.abs(l.top-f.top)<=a?w.some({output:DB(t.output,n,e,o),extra:t.extra}):w.none()}))},zB=function(t,n,e,o,r){var i=n.getSnapPoints(t);return HB(i,e,o,r).orThunk((function(){return X(i,(function(t,n){var i,u,a,c,s,l,f,d,m=n.sensor,g=(i=e,u=m,n.range.left,n.range.top,s=BB(i,a=o,c=r),l=BB(u,a,c),f=Math.abs(s.left-l.left),d=Math.abs(s.top-l.top),Qi(f,d));return t.deltas.fold((function(){return{deltas:w.some(g),snap:w.some(n)}}),(function(e){return(g.left+g.top)/2<=(e.left+e.top)/2?{deltas:w.some(g),snap:w.some(n)}:t}))}),{deltas:w.none(),snap:w.none()}).snap.map((function(t){return{output:DB(t.output,e,o,r),extra:t.extra}}))}))},NB=function(t,n,e,o,r){var i=n.getSnapPoints(t);return HB(i,e,o,r)},LB=Object.freeze({__proto__:null,snapTo:function(t,n,e,o){var r,i,u,a,c,s,l,f=n.getTarget(t.element);n.repositionTarget&&(r=cr(t.element),s=cu(r),l=i=NT(f),u={coord:DB((c=o).output,c.output,s,l),extra:c.extra},a=MB(u.coord,0,i),Ai(f,a))}}),jB="data-initial-z-index",UB=function(t,n){var e;t.getSystem().addToGui(n),dr((e=n).element).filter(rr).each((function(t){Fi(t,"z-index").each((function(n){Rr(t,jB,n)})),Ei(t,"z-index",Mi(e.element,"z-index"))}))},WB=function(t){dr(t.element).filter(rr).each((function(t){Pr(t,jB).fold((function(){return Ri(t,"z-index")}),(function(n){return Ei(t,"z-index",n)})),zr(t,jB)})),t.getSystem().removeFromGui(t)},GB=function(t,n,e){return t.getSystem().build(Pb.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:e}))},XB=jn("snaps",[Bn("getSnapPoints"),Uu("onSensor"),Bn("leftAttr"),Bn("topAttr"),Un("lazyViewport",bu),Un("mustSnap",!1)]),YB=[Un("useFixed",a),Bn("blockerClass"),Un("getTarget",o),Un("onDrag",t),Un("repositionTarget",!0),Un("onDrop",t),Kn("getBounds",bu),XB],qB=function(t,n){return{bounds:t.getBounds(),height:Ji(n.element),width:ru(n.element)}},KB=function(t,n,e,o,r){var i=e.update(o,r),u=e.getStartData().getOrThunk((function(){return qB(n,t)}));i.each((function(e){var o,r,i,a,c,s,l,f,d,m,g;o=t,i=u,a=e,g=(r=n).getTarget(o.element),r.repositionTarget&&(c=cr(o.element),s=cu(c),l=NT(g),f=function(t){return n=Fi(t,"left"),e=Fi(t,"top"),o=Fi(t,"position"),r=function(t,n,e){return("fixed"===e?RB:FB)(parseInt(t,10),parseInt(n,10))},(n.isSome()&&e.isSome()&&o.isSome()?w.some(r(n.getOrDie(),e.getOrDie(),o.getOrDie())):w.none()).getOrThunk((function(){var n=tu(t);return IB(n.left,n.top)}));var n,e,o,r}(g),d=function(t,n,e,o,r,i,u){var a,c,s,l,f,d,m,g,p,h=n.fold((function(){var t,n,u,a=(t=e,n=i.left,u=i.top,t.fold((function(t,e){return FB(t+n,e+u)}),(function(t,e){return IB(t+n,e+u)}),(function(t,e){return RB(t+n,e+u)}))),c=EB(a,o,r);return RB(c.left,c.top)}),(function(n){var u=PB(t,n,e,i,o,r);return u.extra.each((function(e){n.onSensor(t,e)})),u.coord}));return a=h,c=o,s=r,f=(l=u).bounds,d=BB(a,c,s),m=Za(d.left,f.x,f.x+f.width-l.width),g=Za(d.top,f.y,f.y+f.height-l.height),p=IB(m,g),a.fold((function(){var t=AB(p,c,s);return FB(t.left,t.top)}),(function(){return p}),(function(){var t=EB(p,c,s);return RB(t.left,t.top)}))}(o,r.snaps,f,s,l,a,i),m=MB(d,0,l),Ai(g,m)),r.onDrag(o,g,a)}))},JB=function(t,n,e,o){n.each(WB),e.snaps.each((function(n){!function(t,n){var e,o;e=n,o=t.element,zr(o,e.leftAttr),zr(o,e.topAttr)}(t,n)}));var r=e.getTarget(t.element);o.reset(),e.onDrop(t,r)},$B=function(t){return function(n,e){var o=function(t){e.setStartData(qB(n,t))};return jo(d([Go(Co(),(function(t){e.getStartData().each((function(){return o(t)}))}))],t(n,e,o)))}},QB=Object.freeze({__proto__:null,getData:function(t){return w.from(Qi(t.x,t.y))},getDelta:function(t,n){return Qi(n.left-t.left,n.top-t.top)}}),ZB=function(t,n,e){return[Go(qe(),(function(o,r){var i,u,a,c,s;0===r.event.raw.button&&(r.stop(),a={drop:i=function(){return JB(o,w.some(c),t,n)},delayDrop:(u=Ob(i,200)).schedule,forceDrop:i,move:function(e){u.cancel(),KB(o,t,n,QB,e)}},c=GB(o,t.blockerClass,(s=a,jo([Go(qe(),s.forceDrop),Go($e(),s.drop),Go(Ke(),(function(t,n){s.move(n.event)})),Go(Je(),s.delayDrop)]))),e(o),UB(o,c))}))]},tA=d(YB,[Yu("dragger",{handlers:$B(ZB)})]),nA=Object.freeze({__proto__:null,getData:function(t){var n,e=t.raw.touches;return 1===e.length?(n=e[0],w.some(Qi(n.clientX,n.clientY))):w.none()},getDelta:function(t,n){return Qi(n.left-t.left,n.top-t.top)}}),eA=function(n,e,o){var r=Zn(w.none());return[Go(We(),(function(i,u){u.stop();var a,c=function(){JB(i,r.get(),n,e),r.set(w.none())},s={drop:c,delayDrop:t,forceDrop:c,move:function(t){KB(i,n,e,nA,t)}},l=GB(i,n.blockerClass,(a=s,jo([Go(We(),a.forceDrop),Go(Xe(),a.drop),Go(Ye(),a.drop),Go(Ge(),(function(t,n){a.move(n.event)}))])));r.set(w.some(l)),o(i),UB(i,l)})),Go(Ge(),(function(t,o){o.stop(),KB(t,n,e,nA,o.event)})),Go(Xe(),(function(t,o){o.stop(),JB(t,r.get(),n,e),r.set(w.none())})),Go(Ye(),(function(t){JB(t,r.get(),n,e),r.set(w.none())}))]},oA=d(YB,[Yu("dragger",{handlers:$B(eA)})]),rA=d(YB,[Yu("dragger",{handlers:$B((function(t,n,e){return d(ZB(t,n,e),eA(t,n,e))}))})]),iA=Va({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:tA,touch:oA,mouseOrTouch:rA}),name:"dragging",active:{events:function(t,n){return t.dragger.handlers(t,n)}},extra:{snap:function(t){return{sensor:t.sensor,range:t.range,output:t.output,extra:w.from(t.extra)}}},state:Object.freeze({__proto__:null,init:function(){var t=w.none(),n=w.none(),o=e({});return ai({readState:o,reset:function(){t=w.none(),n=w.none()},update:function(n,e){return n.getData(e).bind((function(e){return o=n,r=e,i=t.map((function(t){return o.getDelta(t,r)})),t=w.some(r),i;var o,r,i}))},getStartData:function(){return n},setStartData:function(t){n=w.some(t)}})}}),apis:LB}),uA=function(t,n,e,o,r,i){return t.fold((function(){return iA.snap({sensor:IB(e-20,o-20),range:Qi(r,i),output:IB(w.some(e),w.some(o)),extra:{td:n}})}),(function(t){var r=e-20,i=o-20,u=t.element.dom.getBoundingClientRect();return iA.snap({sensor:IB(r,i),range:Qi(40,40),output:IB(w.some(e-u.width/2),w.some(o-u.height/2)),extra:{td:n}})}))},aA=function(t,n,e){return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,o){var r,i,u=o.td;r=n.get(),i=u,r.exists((function(t){return Ve(t,i)}))||(n.set(w.some(u)),e(u))},mustSnap:!0}},cA=function(t){return Bg(Eg.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:Da([iA.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:t}),Zy.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},sA=function(t,n){var e=Zn([]),o=Zn([]),r=Zn(!1),i=Zn(w.none()),u=Zn(w.none()),a=function(t){var e=vu(t);return uA(f.getOpt(n),t,e.x,e.y,e.width,e.height)},c=function(t){var e=vu(t);return uA(d.getOpt(n),t,e.right,e.bottom,e.width,e.height)},s=aA((function(){return L(e.get(),a)}),i,(function(n){u.get().each((function(e){t.fire("TableSelectorChange",{start:n,finish:e})}))})),l=aA((function(){return L(o.get(),c)}),u,(function(n){i.get().each((function(e){t.fire("TableSelectorChange",{start:e,finish:n})}))})),f=cA(s),d=cA(l),m=Gi(f.asSpec()),g=Gi(d.asSpec()),p=function(n,e,o,r){var i=o(e);iA.snapTo(n,i),function(n,e,o,r){var i=e.dom.getBoundingClientRect();Ri(n.element,"display");var u=fr(re(t.getBody())).dom.innerHeight,a=o(i),c=r(i,u);(a||c)&&Ei(n.element,"display","none")}(n,e,(function(t){return t[r]<0}),(function(t,n){return t[r]>n}))},h=function(t){return p(m,t,a,"top")},v=function(t){return p(g,t,c,"bottom")};Fe().deviceType.isTouch()&&(t.on("TableSelectionChange",(function(t){r.get()||(Cs(n,m),Cs(n,g),r.set(!0)),i.set(w.some(t.start)),u.set(w.some(t.finish)),t.otherCells.each((function(n){e.set(n.upOrLeftCells),o.set(n.downOrRightCells),h(t.start),v(t.finish)}))})),t.on("ResizeEditor ResizeWindow ScrollContent",(function(){i.get().each(h),u.get().each(v)})),t.on("TableSelectionClear",(function(){r.get()&&(Ts(m),Ts(g),r.set(!1)),i.set(w.none()),u.set(w.none())})))};(oT=eT=eT||{})[oT.None=0]="None",oT[oT.Both=1]="Both",oT[oT.Vertical=2]="Vertical";var lA,fA,dA=function(t,n){var e,o,r,i,u,a;return{dom:{tag:"div",classes:["tox-statusbar"]},components:(u=function(){var e,o,r,i,u,a=[];return t.getParam("elementpath",!0,"boolean")&&a.push(function(t,n,e){return n.delimiter||(n.delimiter="»"),{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:Da([wm.config({mode:"flow",selector:"div[role=button]"}),Sh.config({disabled:e.isDisabled}),$h(),Wb.config({}),_m.config({}),Tm("elementPathEvents",[Qo((function(o,r){t.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return wm.focusIn(o)})),t.on("NodeChange",(function(r){var i,u,a=function(n){for(var e=[],o=n.length;0<o--;){var r=n[o];if(1===r.nodeType&&!function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0;if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1}(r)){var i=t.fire("ResolveName",{name:r.nodeName.toLowerCase(),target:r});if(i.isDefaultPrevented()||e.push({name:i.name,element:r}),i.isPropagationStopped())break}}return e}(r.parents);0<a.length?_m.set(o,(i=L(a||[],(function(n,o){return Eg.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":o,"tab-index":-1,"aria-level":o+1},innerHtml:n.name},action:function(e){t.focus(),t.selection.select(n.element),t.nodeChanged()},buttonBehaviours:Da([Zh(e.isDisabled),$h()])})})),u={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+n.delimiter+" "}},X(i.slice(1),(function(t,n){var e=t;return e.push(u),e.push(n),e}),[i[0]]))):_m.set(o,[])}))}))])]),components:[]}}(t,{},n)),t.hasPlugin("wordcount")&&a.push((e=t,o=n,i=function(t,n,e){return _m.set(t,[ji(o.translate(["{0} "+e,n[e]]))])},Eg.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:Da([Zh(o.isDisabled),$h(),Wb.config({}),_m.config({}),al.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),Tm("wordcount-events",[nr((function(t){var n=al.getValue(t),e="words"===n.mode?"characters":"words";al.setValue(t,{mode:e,count:n.count}),i(t,n.count,e)})),Qo((function(t){e.on("wordCountUpdate",(function(n){var e=al.getValue(t).mode;al.setValue(t,{mode:e,count:n.wordCount}),i(t,n.wordCount,e)}))}))])]),eventOrder:((r={})[po()]=["disabling","alloy.base.behaviour","wordcount-events"],r)}))),t.getParam("branding",!0,"boolean")&&a.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(u=ch.translate(["Powered by {0}","Tiny"]))+'">'+u+"</a>"}}),0<a.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:a}]:[]}(),o=!(e=t).hasPlugin("autoresize"),(a=!1===(r=e.getParam("resize",o))?eT.None:"both"===r?eT.Both:eT.Vertical)!==eT.None&&u.push((i=a,{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:n.translate("Resize"),"aria-hidden":"true"},innerHtml:Mg("resize-handle",n.icons)},behaviours:Da([iA.config({mode:"mouse",repositionTarget:!1,onDrag:function(n,e,o){!function(t,n,e){var o,r,i,u,a,c,s=re(t.getContainer()),l=(o=t,r=n,i=e,u=Ki(s),a=ou(s),(c={}).height=qE(u+r.top,Th(o),Bh(o)),i===eT.Both&&(c.width=qE(a+r.left,_h(o),Eh(o))),c);wt(l,(function(t,n){return Ei(s,n,YE(t)),0})),t.fire("ResizeEditor")}(t,o,i)},blockerClass:"tox-blocker"})])})),u)}},mA=function(n){var e,o,r,i,u=n.inline,a=u?$E:GE,c=Xh(n)?lE:HT,s=w.none(),f=Fe(),d=f.browser.isIE()?["tox-platform-ie"]:[],m=f.deviceType.isTouch()?["tox-platform-touch"]:[],g=Lh(n),p=Wh(n),h=ch.isRtl()?{attributes:{dir:"rtl"}}:{},v={attributes:((e={})[hc]=g?Au.BottomToTop:Au.TopToBottom,e)},b=function(){return s.bind(DE.getHeader)},y=Gi((o=Ve(Ci(),p)&&"grid"===Mi(p,"display"),r={dom:l({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(d).concat(m)},h),behaviours:Da([ys.config({useFixed:function(){return c.isDocked(b)}})])},i={dom:{styles:{width:document.body.clientWidth+"px"}},events:jo([Go(Oo(),(function(){Ei(ft.element,"width",document.body.clientWidth+"px")}))])},Ft(r,o?i:{}))),x=function(){return ct.value(y)},S=Bg({dom:{tag:"div",classes:["tox-anchorbar"]}}),k=function(){return s.bind((function(t){return DE.getThrobber(t)})).getOrDie("Could not find throbber element")},C=hO(y,n,(function(){return s.bind((function(t){return S.getOpt(t)})).getOrDie("Could not find a anchor bar element")})),O=DE.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:C,onEscape:function(){n.focus()}}),_=Vh(n),T=DE.parts.toolbar(l({dom:{tag:"div",classes:["tox-toolbar"]},getSink:x,providers:C.shared.providers,onEscape:function(){n.focus()},type:_,lazyToolbar:function(){return s.bind((function(t){return DE.getToolbar(t)})).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return b().getOrDie("Could not find header element")}},v)),E=DE.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:C.shared.providers,onEscape:function(){n.focus()},type:_}),B=DE.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),A=DE.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),D=DE.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:C}),F=n.getParam("statusbar",!0,"boolean")&&!u?w.some(dA(n,C.shared.providers)):w.none(),I={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[B,A]},R=Fh(n),V=Mh(n),P=Ah(n),H=DE.parts.header({dom:l({tag:"div",classes:["tox-editor-header"]},v),components:K([P?[O]:[],R?[E]:V?[T]:[],Uh(n)?[]:[S.asSpec()]]),sticky:Xh(n),editor:n,sharedBackstage:C.shared}),z=K([g?[]:[H],u?[]:[I],g?[H]:[]]),N=K([[{dom:{tag:"div",classes:["tox-editor-container"]},components:z}],u?[]:F.toArray(),[D]]),L=Gh(n),U=l(l({role:"application"},ch.isRtl()?{dir:"rtl"}:{}),L?{"aria-hidden":"true"}:{}),W=Gi(DE.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(u?["tox-tinymce-inline"]:[]).concat(g?["tox-tinymce--toolbar-bottom"]:[]).concat(m).concat(d),styles:l({visibility:"hidden"},L?{opacity:"0",border:"0"}:{}),attributes:U},components:N,behaviours:Da([$h(),Sh.config({disableClass:"tox-tinymce--disabled"}),wm.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})])}));s=w.some(W);n.shortcuts.add("alt+F9","focus menubar",(function(){DE.focusMenubar(W)})),n.shortcuts.add("alt+F10","focus toolbar",(function(){DE.focusToolbar(W)})),n.addCommand("ToggleToolbarDrawer",(function(){DE.toggleToolbarDrawer(W)})),n.addQueryStateHandler("ToggleToolbarDrawer",(function(){return DE.isToolbarDrawerToggled(W)}));var G,X,Y,q,J,$,Q,Z,tt,nt,et,ot,rt,it,ut,at,st,lt=Hb(W),ft=Hb(y);G=n,X=lt,Y=ft,q=function(t,n){j([X,Y],(function(e){e.broadcastEvent(t,n)}))},J=function(t,n){j([X,Y],(function(e){e.broadcastOn([t],n)}))},$=function(t){return J(js(),{target:t.target})},Q=wb(re(document),"touchstart",$),Z=wb(re(document),"touchmove",(function(t){return q(So(),t)})),tt=wb(re(document),"touchend",(function(t){return q(ko(),t)})),nt=wb(re(document),"mousedown",$),et=wb(re(document),"mouseup",(function(t){0===t.raw.button&&J(Ws(),{target:t.target})})),ot=function(t){return J(js(),{target:re(t.target)})},rt=function(t){0===t.button&&J(Ws(),{target:re(t.target)})},it=function(t){return q(Co(),kb(t))},ut=function(t){J(Us(),{}),q(Oo(),kb(t))},at=function(){return J(Us(),{})},st=function(t){t.state&&J(js(),{target:re(G.getContainer())})},G.on("PostRender",(function(){G.on("click",ot),G.on("tap",ot),G.on("mouseup",rt),G.on("ScrollWindow",it),G.on("ResizeWindow",ut),G.on("ResizeEditor",at),G.on("AfterProgressState",st)})),G.on("remove",(function(){G.off("click",ot),G.off("tap",ot),G.off("mouseup",rt),G.off("ScrollWindow",it),G.off("ResizeWindow",ut),G.off("ResizeEditor",at),G.off("AfterProgressState",st),nt.unbind(),Q.unbind(),Z.unbind(),tt.unbind(),et.unbind()})),G.on("detach",(function(){Ms(X),Ms(Y),X.destroy(),Y.destroy()}));var dt=function(){var t,e=YE(function(t){var n,e,o,r;return(e=Ch(n=t),o=Th(n),r=Bh(n),XE(e).map((function(t){return qE(t,o,r)}))).getOr(Ch(t))}(n)),o=YE(KE(t=n).getOr(Oh(t)));return n.inline||(Ii("div","width",o)&&Ei(W.element,"width",o),Ii("div","height",e)?Ei(W.element,"height",e):Ei(W.element,"height","200px")),e};return{mothership:lt,uiMothership:ft,backstage:C,renderUI:function(){var t,e,o,r,i,u,s,f;c.setup(n,C.shared,b),iB(n,C),kB(n,x,C),e=(t=n).ui.registry.getAll().sidebars,j(yt(e),(function(n){var o=e[n],r=function(){return w.from(t.queryCommandValue("ToggleSidebar")).is(n)};t.ui.registry.addToggleButton(n,{icon:o.icon,tooltip:o.tooltip,onAction:function(e){t.execCommand("ToggleSidebar",!1,n),e.setActive(r())},onSetup:function(n){var e=function(){return n.setActive(r())};return t.on("ToggleSidebar",e),function(){t.off("ToggleSidebar",e)}}})})),o=n,r=k,i=C.shared,u=Zn(!1),s=Zn(w.none()),f=function(t){t!==u.get()&&(function(t,n,e){var o=t.element;!0===n?(_m.set(t,[{dom:{tag:"div",attributes:{"aria-label":e.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:CE('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:Da([wm.config({mode:"special",onTab:function(){return w.some(!0)},onShiftTab:function(){return w.some(!0)}}),Dm.config({})])}]),Ri(o,"display"),zr(o,"aria-hidden")):(_m.set(t,[]),Ei(o,"display","none"),Rr(o,"aria-hidden","true"))}(r(),t,i.providers),u.set(t),o.fire("AfterProgressState",{state:t}))},o.on("ProgressState",(function(t){var n;s.get().each(Tg.clearTimeout),M(t.time)?(n=Tg.setEditorTimeout(o,(function(){return f(t.state)}),t.time),s.set(w.some(n))):(f(t.state),s.set(w.none()))})),St(n.getParam("toolbar_groups",{},"object"),(function(t,e){n.ui.registry.addGroupToolbarButton(e,t)}));var d,m=n.ui.registry.getAll(),g=m.buttons,p=m.menuItems,h=m.contextToolbars,v=m.sidebars,S=Dh(n),O={menuItems:p,menus:(d=n.getParam("menu"))?St(d,(function(t){return l(l({},t),{items:t.items})})):{},menubar:n.getParam("menubar"),toolbar:S.getOrThunk((function(){return n.getParam("toolbar",!0)})),allowToolbarGroups:_===mp.floating,buttons:g,sidebar:v};AT(n,h,y,{backstage:C}),sA(n,y);var T=n.getElement(),E=dt(),B={mothership:lt,uiMothership:ft,outerContainer:W},A={targetNode:T,height:E};return a.render(n,B,O,C,A)},getUi:function(){return{channels:{broadcastAll:ft.broadcast,broadcastOn:ft.broadcastOn,register:t}}}}},gA=e([Bn("lazySink"),Pn("dragBlockClass"),Kn("getBounds",bu),Un("useTabstopAt",c),Un("eventOrder",{}),cl("modalBehaviours",[wm]),Wu("onExecute"),Xu("onEscape")]),pA={sketch:o},hA=e([Pl({name:"draghandle",overrides:function(t,n){return{behaviours:Da([iA.config({mode:"mouse",getTarget:function(t){return Ou(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),Rl({schema:[Bn("dom")],name:"title"}),Rl({factory:pA,schema:[Bn("dom")],name:"close"}),Rl({factory:pA,schema:[Bn("dom")],name:"body"}),Pl({factory:pA,schema:[Bn("dom")],name:"footer"}),Vl({factory:{sketch:function(t,n){return l(l({},t),{dom:n.dom,components:n.components})}},schema:[Un("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),Un("components",[])],name:"blocker"})]),vA=Object.freeze({__proto__:null,block:function(t,n,e,o){Rr(t.element,"aria-busy",!0);var r=n.getRoot(t).getOr(t),i=Da([wm.config({mode:"special",onTab:function(){return w.some(!0)},onShiftTab:function(){return w.some(!0)}}),Dm.config({})]),u=o(r,i),a=r.getSystem().build(u);_m.append(r,Xi(a)),a.hasConfigured(wm)&&wm.focusIn(a),e.isBlocked()||n.onBlock(t),e.blockWith((function(){return _m.remove(r,a)}))},unblock:function(t,n,e){zr(t.element,"aria-busy"),e.isBlocked()&&n.onUnblock(t),e.clear()}}),bA=[Kn("getRoot",w.none),Uu("onBlock"),Uu("onUnblock")],yA=Ia({fields:bA,name:"blocking",apis:vA,state:Object.freeze({__proto__:null,init:function(){var t=pT();return ai({readState:t.isSet,blockWith:function(n){t.set({destroy:n})},clear:t.clear,isBlocked:t.isSet})}})}),xA=ff({name:"ModalDialog",configFields:gA(),partFields:hA(),factory:function(t,n,e,r){var i,u=Zn(w.none()),a=Wr("modal-events"),c=l(l({},t.eventOrder),((i={})[_o()]=[a].concat(t.eventOrder["alloy.system.attached"]||[]),i));return{uid:t.uid,dom:t.dom,components:n,apis:{show:function(n){u.set(w.some(n));var e=t.lazySink(n).getOrDie(),o=r.blocker(),i=e.getSystem().build(l(l({},o),{components:o.components.concat([Xi(n)]),behaviours:Da([Dm.config({}),Tm("dialog-blocker-events",[$o(Ze(),(function(){wm.focusIn(n)}))])])}));Cs(e,i),wm.focusIn(n)},hide:function(t){u.set(w.none()),dr(t.element).each((function(n){t.getSystem().getByDom(n).each((function(t){Ts(t)}))}))},getBody:function(n){return Jl(n,t,"body")},getFooter:function(n){return Jl(n,t,"footer")},setIdle:function(t){yA.unblock(t)},setBusy:function(t,n){yA.block(t,n)}},eventOrder:c,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:ll(t.modalBehaviours,[_m.config({}),wm.config({mode:"cyclic",onEnter:t.onExecute,onEscape:t.onEscape,useTabstopAt:t.useTabstopAt}),yA.config({getRoot:u.get}),Tm(a,[Qo((function(n){var e,r,i,u,a,c;e=n.element,r=Jl(n,t,"title").element,i=Pr(e,"id").fold((function(){var t=Wr("dialog-label");return Rr(r,"id",t),t}),o),Rr(e,"aria-labelledby",i),u=n.element,a=Jl(n,t,"body").element,c=w.from(Vr(u,"id")).fold((function(){var t=Wr("dialog-describe");return Rr(a,"id",t),t}),o),Rr(u,"aria-describedby",c)}))])])}},apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),wA=tn([Mn("type"),Mn("name")].concat(Wp)),SA=Cn,kA=[an("name","name",Nt((function(){return Wr("button-name")})),kn),Nn("icon"),Yn("align","end",["start","end"]),qn("primary",!1),qn("disabled",!1)],CA=d(kA,[Mn("text")]),OA=d([Dn("type",["submit","cancel","custom"])],CA),_A=d([Dn("type",["menu"]),Nn("text"),Nn("tooltip"),Nn("icon"),Vn("items",wA)],kA),TA=yn("type",{submit:OA,cancel:OA,custom:OA,menu:_A}),EA=[Mn("type"),Mn("text"),Dn("level",["info","warn","error","success"]),Mn("icon"),Un("url","")],BA=tn(EA),AA=[Mn("type"),Mn("text"),qn("disabled",!1),qn("primary",!1),an("name","name",Nt((function(){return Wr("button-name")})),kn),Nn("icon"),qn("borderless",!1)],MA=tn(AA),DA=[Mn("type"),Mn("name"),Mn("label"),qn("disabled",!1)],FA=tn(DA),IA=Cn,RA=[Mn("type"),Mn("name")],VA=RA.concat([Nn("label")]),PA=VA.concat([Un("columns","auto")]),HA=tn(PA),zA=ln([Mn("value"),Mn("text"),Mn("icon")]),NA=tn(VA),LA=kn,jA=tn(VA),UA=kn,WA=RA.concat([Xn("tag","textarea"),Mn("scriptId"),Mn("scriptUrl"),(void 0,Wn("settings",undefined,Tn))]),GA=RA.concat([Xn("tag","textarea"),Fn("init")]),XA=dn((function(t){return gn("customeditor.old",Zt(GA),t).orThunk((function(){return gn("customeditor.new",Zt(WA),t)}))})),YA=kn,qA=tn(VA),KA=nn(sn),JA=function(t){return[Mn("type"),An("columns",Sn),t]},$A=[Mn("type"),Mn("html"),Yn("presets","presentation",["presentation","document"])],QA=tn($A),ZA=VA.concat([qn("sandboxed",!0)]),tM=tn(ZA),nM=kn,eM=VA.concat([An("currentState",tn([Bn("blob"),Mn("url")]))]),oM=tn(eM),rM=VA.concat([Nn("inputMode"),Nn("placeholder"),qn("maximized",!1),qn("disabled",!1)]),iM=tn(rM),uM=kn,aM=[Mn("text"),Mn("value")],cM=[Mn("text"),Vn("items",(lA=function(){return sM},fA=Rt((function(){return lA()})),{extract:function(t,n,e){return fA().extract(t,n,e)},toString:function(){return fA().toString()}}))],sM=en([tn(aM),tn(cM)]),lM=VA.concat([Vn("items",sM),qn("disabled",!1)]),fM=tn(lM),dM=kn,mM=VA.concat([Rn("items",[Mn("text"),Mn("value")]),Gn("size",1),qn("disabled",!1)]),gM=tn(mM),pM=kn,hM=VA.concat([qn("constrain",!0),qn("disabled",!1)]),vM=tn(hM),bM=tn([Mn("width"),Mn("height")]),yM=[Mn("type"),Vn("header",kn),Vn("cells",nn(kn))],xM=tn(yM),wM=VA.concat([Nn("placeholder"),qn("maximized",!1),qn("disabled",!1)]),SM=tn(wM),kM=kn,CM=VA.concat([Yn("filetype","file",["image","media","file"]),Un("disabled",!1)]),OM=tn(CM),_M=tn([Mn("value"),Un("meta",{})]),TM=function(t){return an("items","items",Ht(),nn(dn((function(n){return gn("Checking item of "+t,EM,n).fold((function(t){return ct.error(vn(t))}),(function(t){return ct.value(t)}))}))))},EM=fn((function(){return bn("type",{alertbanner:BA,bar:tn((n=TM("bar"),[Mn("type"),n])),button:MA,checkbox:FA,colorinput:NA,colorpicker:jA,dropzone:qA,grid:tn(JA(TM("grid"))),iframe:tM,input:iM,listbox:fM,selectbox:gM,sizeinput:vM,textarea:SM,urlinput:OM,customeditor:XA,htmlpanel:QA,imagetools:oM,collection:HA,label:tn((t=TM("label"),[Mn("type"),Mn("label"),t])),table:xM,panel:AM});var t,n})),BM=[Mn("type"),Un("classes",[]),Vn("items",EM)],AM=tn(BM),MM=[an("name","name",Nt((function(){return Wr("tab-name")})),kn),Mn("title"),Vn("items",EM)],DM=[Mn("type"),Rn("tabs",MM)],FM=tn(DM),IM=CA,RM=TA,VM=tn([Mn("title"),An("body",bn("type",{panel:AM,tabpanel:FM})),Xn("size","normal"),Vn("buttons",RM),Un("initialData",{}),Kn("onAction",t),Kn("onChange",t),Kn("onSubmit",t),Kn("onClose",t),Kn("onCancel",t),Un("onTabChange",t)]),PM=tn(d([Dn("type",["cancel","custom"])],IM)),HM=tn([Mn("title"),Mn("url"),zn("height"),zn("width"),Hn("buttons",nn(PM)),Kn("onAction",t),Kn("onCancel",t),Kn("onClose",t),Kn("onMessage",t)]),zM=function(t){return O(t)?[t].concat(J(_t(t),zM)):_(t)?J(t,zM):[]},NM=function(t){return C(t.type)&&C(t.name)},LM={checkbox:IA,colorinput:LA,colorpicker:UA,dropzone:KA,input:uM,iframe:nM,sizeinput:bM,selectbox:pM,listbox:dM,size:bM,textarea:kM,urlinput:_M,customeditor:YA,collection:zA,togglemenuitem:SA},jM=function(t){var n=W(zM(t),NM),e=J(n,(function(t){return n=t,w.from(LM[n.type]).fold((function(){return[]}),(function(n){return[An(t.name,n)]}));var n}));return tn(e)},UM=function(t){return{internalDialog:pn(gn("dialog",VM,t)),dataValidator:jM(t),initialData:t.initialData}},WM={open:function(t,n){var e=UM(n);return t(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(t,n){return t(pn(gn("dialog",HM,n)))},redial:UM},GM=function(t){var n=[],e={};return wt(t,(function(t,o){t.fold((function(){n.push(o)}),(function(t){e[o]=t}))})),0<n.length?ct.error(n):ct.value(e)},XM=lf({name:"TabButton",configFields:[Un("uid",void 0),Bn("value"),an("dom","dom",Lt((function(){return{attributes:{role:"tab",id:Wr("aria"),"aria-selected":"false"}}})),xn()),Pn("action"),Un("domModification",{}),cl("tabButtonBehaviours",[Dm,wm,al]),Bn("view")],factory:function(t,n){return{uid:t.uid,dom:t.dom,components:t.components,events:Xm(t.action),behaviours:ll(t.tabButtonBehaviours,[Dm.config({}),wm.config({mode:"execution",useSpace:!0,useEnter:!0}),al.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),YM=e([Bn("tabs"),Bn("dom"),Un("clickToDismiss",!1),cl("tabbarBehaviours",[Tf,wm]),Lu(["tabClass","selectedClass"])]),qM=Hl({factory:XM,name:"tabs",unit:"tab",overrides:function(n){var e=function(t,n){Tf.dehighlight(t,n),Po(t,Fo(),{tabbar:t,button:n})},o=function(t,n){Tf.highlight(t,n),Po(t,Do(),{tabbar:t,button:n})};return{action:function(r){var i=r.getSystem().getByUid(n.uid).getOrDie(),u=Tf.isHighlighted(i,r);(u&&n.clickToDismiss?e:u?t:o)(i,r)},domModification:{classes:[n.markers.tabClass]}}}}),KM=e([qM]),JM=ff({name:"Tabbar",configFields:YM(),partFields:KM(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:ll(t.tabbarBehaviours,[Tf.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){Rr(n.element,"aria-selected","true")},onDehighlight:function(t,n){Rr(n.element,"aria-selected","false")}}),wm.config({mode:"flow",getInitial:function(t){return Tf.getHighlighted(t).map((function(t){return t.element}))},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),$M=lf({name:"Tabview",configFields:[cl("tabviewBehaviours",[_m])],factory:function(t,n){return{uid:t.uid,dom:t.dom,behaviours:ll(t.tabviewBehaviours,[_m.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),QM=e([Un("selectFirst",!0),Uu("onChangeTab"),Uu("onDismissTab"),Un("tabs",[]),cl("tabSectionBehaviours",[])]),ZM=Rl({factory:JM,schema:[Bn("dom"),In("markers",[Bn("tabClass"),Bn("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),tD=Rl({factory:$M,name:"tabview"}),nD=e([ZM,tD]),eD=ff({name:"TabSection",configFields:QM(),partFields:nD(),factory:function(t,n,e,o){var r=function(n,e){Kl(n,t,"tabbar").each((function(t){e(t).each(Ho)}))};return{uid:t.uid,dom:t.dom,components:n,behaviours:sl(t.tabSectionBehaviours),events:jo(K([t.selectFirst?[Qo((function(t,n){r(t,Tf.getFirst)}))]:[],[Go(Do(),(function(n,e){var o,r,i=e.event.button;o=i,r=al.getValue(o),Kl(o,t,"tabview").each((function(n){Y(t.tabs,(function(t){return t.value===r})).each((function(e){var r=e.view();Pr(o.element,"id").each((function(t){Rr(n.element,"aria-labelledby",t)})),_m.set(n,r),t.onChangeTab(n,o,r)}))}))})),Go(Fo(),(function(n,e){var o=e.event.button;t.onDismissTab(n,o)}))]])),apis:{getViewItems:function(n){return Kl(n,t,"tabview").map((function(t){return _m.contents(t)})).getOr([])},showTab:function(t,n){r(t,(function(t){var e=Tf.getCandidates(t);return Y(e,(function(t){return al.getValue(t)===n})).filter((function(n){return!Tf.isHighlighted(t,n)}))}))}}}},apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),oD=function(t,n){Ei(t,"height",n+"px"),Fe().browser.isIE()?Ri(t,"flex-basis"):Ei(t,"flex-basis",n+"px")},rD=function(t,n,e){Ou(t,'[role="dialog"]').each((function(t){_u(t,'[role="tablist"]').each((function(o){e.get().map((function(e){return Ei(n,"height","0"),Ei(n,"flex-basis","0"),Math.min(e,(i=n,u=o,a=lr(r=t).dom,c=Ou(r,".tox-dialog-wrap").getOr(r),s="fixed"===Mi(c,"position")?Math.max(a.clientHeight,window.innerHeight):Math.max(a.offsetHeight,a.scrollHeight),l=Ki(i),f=i.dom.offsetLeft>=u.dom.offsetLeft+ou(u)?Math.max(Ki(u),l):l,d=parseInt(Mi(r,"margin-top"),10)||0,m=parseInt(Mi(r,"margin-bottom"),10)||0,s-(Ki(r)+d+m-f)));var r,i,u,a,c,s,l,f,d,m})).each((function(t){oD(n,t)}))}))}))},iD=function(t){return _u(t,'[role="tabpanel"]')},uD=function(t){var n;return{smartTabHeight:(n=Zn(w.none()),{extraEvents:[Qo((function(e){var o=e.element;iD(o).each((function(r){var i;Ei(r,"visibility","hidden"),e.getSystem().getByDom(r).toOptional().each((function(e){var o,i,u,a=(i=r,u=e,L(o=t,(function(t,n){_m.set(u,o[n].view());var e=i.dom.getBoundingClientRect();return _m.set(u,[]),e.height}))),c=et(tt(a,(function(t,n){return n<t?-1:t<n?1:0})));n.set(c)})),rD(o,r,n),Ri(r,"visibility"),i=e,et(t).each((function(t){return eD.showTab(i,t.value)})),Tg.requestAnimationFrame((function(){rD(o,r,n)}))}))})),Go(Oo(),(function(t){var e=t.element;iD(e).each((function(t){rD(e,t,n)}))})),Go(ry,(function(t,e){var o=t.element;iD(o).each((function(t){var e=La(xr(t));Ei(t,"visibility","hidden");var r=Fi(t,"height").map((function(t){return parseInt(t,10)}));Ri(t,"height"),Ri(t,"flex-basis");var i=t.dom.getBoundingClientRect().height;r.forall((function(t){return t<i}))?(n.set(w.from(i)),rD(o,t,n)):r.each((function(n){oD(t,n)})),Ri(t,"visibility"),e.each(Na)}))}))],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}},aD="send-data-to-section",cD="send-data-to-view",sD=Wr("update-dialog"),lD=Wr("update-title"),fD=Wr("update-body"),dD=Wr("update-footer"),mD=Wr("body-send-message"),gD=function(t,n,e,o){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:l(l({},n.map((function(t){return{id:t}})).getOr({})),o?{"aria-live":"polite"}:{})},components:[],behaviours:Da([tS(0),O_.config({channel:fD,updateState:function(t,n){return w.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},renderComponents:function(t){switch(t.body.type){case"tabpanel":return[(u=t.body,a=e,c=Zn({}),s=function(t){var n=al.getValue(t),e=GM(n).getOr({}),o=c.get(),r=Ft(o,e);c.set(r)},l=function(t){var n=c.get();al.setValue(t,n)},f=Zn(null),d=L(u.tabs,(function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:a.shared.providers.translate(t.title)},view:function(){return[Gw.sketch((function(n){return{dom:{tag:"div",classes:["tox-form"]},components:L(t.items,(function(t){return FC(n,t,a)})),formBehaviours:Da([wm.config({mode:"acyclic",useTabstopAt:i(vS)}),Tm("TabView.form.events",[Qo(l),Zo(s)]),Ha.config({channels:Wt([{key:aD,value:{onReceive:s}},{key:cD,value:{onReceive:l}}])})])}}))]}}})),m=uD(d).smartTabHeight,eD.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n,e){var o=al.getValue(n);Po(t,oy,{name:o,oldName:f.get()}),f.set(o)},tabs:d,components:[eD.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[JM.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:Da([Wb.config({})])}),eD.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:m.selectFirst,tabSectionBehaviours:Da([Tm("tabpanel",m.extraEvents),wm.config({mode:"acyclic"}),vf.config({find:function(t){return et(eD.getViewItems(t))}}),al.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([aD],{}),c.get()},setValue:function(t,n){c.set(n),t.getSystem().broadcastOn([cD],{})}}})])}))];default:return[(n=t.body,o=e,{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[(r=Bg(Gw.sketch((function(t){return{dom:{tag:"div",classes:["tox-form"].concat(n.classes)},components:L(n.items,(function(n){return FC(t,n,o)}))}})))).asSpec()]}],behaviours:Da([wm.config({mode:"acyclic",useTabstopAt:i(vS)}),Zw(r),aS(r,{postprocess:function(t){return GM(t).fold((function(t){return console.error(t),{}}),(function(t){return t}))}})])})]}var n,o,r,u,a,c,s,l,f,d,m},initialData:t})])}},pD=sv.deviceType.isTouch(),hD=function(t,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,n]}},vD=function(t,n){return xA.parts.close(Eg.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:Da([Wb.config({})])}))},bD=function(){return xA.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},yD=function(t,n){return xA.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:CE("<p>"+n.translate(t)+"</p>")}]}]})},xD=function(t){return xA.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},wD=function(t,n){return[Pb.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),Pb.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]},SD=function(t){var n,e="tox-dialog",o=e+"-wrap",r=o+"__backdrop",i=e+"__disable-scroll";return xA.sketch({lazySink:t.lazySink,onEscape:function(n){return t.onEscape(n),w.some(!0)},useTabstopAt:function(t){return!vS(t)},dom:{tag:"div",classes:[e].concat(t.extraClasses),styles:l({position:"relative"},t.extraStyles)},components:d([t.header,t.body],t.footer.toArray()),parts:{blocker:{dom:CE('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:pD?[r,r+"--opaque"]:[r]}}]}},dragBlockClass:o,modalBehaviours:Da(d([Dm.config({}),Tm("dialog-events",t.dialogEvents.concat([$o(Ze(),(function(t,n){wm.focusIn(t)}))])),Tm("scroll-lock",[Qo((function(){vi(Ci(),i)})),Zo((function(){bi(Ci(),i)}))])],t.extraBehaviours)),eventOrder:l(((n={})[po()]=["dialog-events"],n[_o()]=["scroll-lock","dialog-events","alloy.base.behaviour"],n[To()]=["alloy.base.behaviour","dialog-events","scroll-lock"],n),t.eventOrder)})},kD=function(t){return Eg.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:Mg("close",t.icons)}}],action:function(t){Vo(t,Qb)}})},CD=function(t,n,e){var o=function(t){return[ji(e.translate(t.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:l({},n.map((function(t){return{id:t}})).getOr({}))},components:o(t),behaviours:Da([O_.config({channel:lD,renderComponents:o})])}},OD=function(){return{dom:CE('<div class="tox-dialog__draghandle"></div>')}},_D=function(t,n){return e={title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},o=n.shared.providers,r=xA.parts.title(CD(e,w.none(),o)),i=xA.parts.draghandle(OD()),u=xA.parts.close(kD(o)),a=[r].concat(e.draggable?[i]:[]).concat([u]),Pb.sketch({dom:CE('<div class="tox-dialog__header"></div>'),components:a});var e,o,r,i,u,a},TD=function(t,n,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.translate(t)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:n,components:[{dom:CE('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},ED=function(t,n,e){return{onClose:function(){return e.closeWindow()},onBlock:function(e){xA.setBusy(t(),(function(t,o){return TD(e.message,o,n)}))},onUnblock:function(){xA.setIdle(t())}}},BD=function(t,n,e,o){var r;return Gi(SD(l(l({},t),{lazySink:o.shared.getSink,extraBehaviours:d([O_.config({channel:sD,updateState:function(t,n){return w.some(n)},initialData:n}),lS({})],t.extraBehaviours),onEscape:function(t){Vo(t,Qb)},dialogEvents:e,eventOrder:((r={})[go()]=[O_.name(),Ha.name()],r[_o()]=["scroll-lock",O_.name(),"messages","dialog-events","alloy.base.behaviour"],r[To()]=["alloy.base.behaviour","dialog-events","messages",O_.name(),"scroll-lock"],r)})))},AD=function(t){return L(t,(function(t){return"menu"===t.type?(e=L((n=t).items,(function(t){var n=Zn(!1);return l(l({},t),{storage:n})})),l(l({},n),{items:e})):t;var n,e}))},MD=function(t){return X(t,(function(t,n){return"menu"!==n.type?t:X(n.items,(function(t,n){return t[n.name]=n.storage,t}),t)}),{})},DD=function(t,n){return[Ko(Ze(),hS),t($b,(function(t,e){n.onClose(),e.onClose()})),t(Qb,(function(t,n,e,o){n.onCancel(t),Vo(o,$b)})),Go(ey,(function(t,e){return n.onUnblock()})),Go(ny,(function(t,e){return n.onBlock(e.event)}))]},FD=function(t,n,e){var o=function(n,e){return Go(n,(function(n,o){r(n,(function(r,i){e(t(),r,o.event,n)}))}))},r=function(t,n){O_.getState(t).get().each((function(e){n(e.internalDialog,t)}))};return d(DD(o,n),[o(ty,(function(t,n){return n.onSubmit(t)})),o(Jb,(function(t,n,e){n.onChange(t,{name:e.name})})),o(Zb,(function(t,n,o,r){var i=function(){return wm.focusIn(r)},u=function(t){return Hr(t,"disabled")||Pr(t,"aria-disabled").exists((function(t){return"true"===t}))},a=xr(r.element),c=La(a);n.onAction(t,{name:o.name,value:o.value}),La(a).fold(i,(function(t){u(t)||c.exists((function(n){return Pe(t,n)&&u(n)}))?i():e().toOptional().filter((function(n){return!Pe(n.element,t)})).each(i)}))})),o(oy,(function(t,n,e){n.onTabChange(t,{newTabName:e.name,oldTabName:e.oldName})})),Zo((function(n){var e=t();al.setValue(n,e.getData())}))])},ID=function(t,n){var e=n.map((function(t){return t.footerButtons})).getOr([]),o=U(e,(function(t){return"start"===t.align})),r=function(t,n){return Pb.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:L(n,(function(t){return t.memento.asSpec()}))})};return[r("start",o.pass),r("end",o.fail)]},RD=function(t,n){return{dom:CE('<div class="tox-dialog__footer"></div>'),components:[],behaviours:Da([O_.config({channel:dD,initialData:t,updateState:function(t,e){var o=L(e.buttons,(function(t){var e,o,r=Bg((o=n,Bk(e=t,e.type,o)));return{name:t.name,align:t.align,memento:r}}));return w.some({lookupByName:function(t,n){return e=t,r=n,Y(o,(function(t){return t.name===r})).bind((function(t){return t.memento.getOpt(e)}));var e,r},footerButtons:o})},renderComponents:ID})])}},VD=RD,PD=function(t,n){return xA.parts.footer(RD(t,n))},HD=function(t,n){if(t.getRoot().getSystem().isConnected()){var e=vf.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper());return Gw.getField(e,n).fold((function(){var o=t.getFooter();return O_.getState(o).get().bind((function(t){return t.lookupByName(e,n)}))}),(function(t){return w.some(t)}))}return w.none()},zD=function(t,n,e){var o=function(n){var e=t.getRoot();e.getSystem().isConnected()&&n(e)},r={getData:function(){var n=t.getRoot(),o=n.getSystem().isConnected()?t.getFormWrapper():n,r=al.getValue(o),i=St(e,(function(t){return t.get()}));return l(l({},r),i)},setData:function(n){o((function(o){var i,u,a=r.getData(),c=l(l({},a),n),s=(i=c,u=t.getRoot(),O_.getState(u).get().map((function(t){return pn(gn("data",t.dataValidator,i))})).getOr(i)),f=t.getFormWrapper();al.setValue(f,s),wt(e,(function(t,n){Et(c,n)&&t.set(c[n])}))}))},disable:function(n){HD(t,n).each(Sh.disable)},enable:function(n){HD(t,n).each(Sh.enable)},focus:function(n){HD(t,n).each(Dm.focus)},block:function(t){if(!C(t))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");o((function(n){Po(n,ny,{message:t})}))},unblock:function(){o((function(t){Vo(t,ey)}))},showTab:function(n){o((function(e){var o=t.getBody();O_.getState(o).get().exists((function(t){return t.isTabPanel()}))&&vf.getCurrent(o).each((function(t){eD.showTab(t,n)}))}))},redial:function(t){o((function(e){var o=n(t);e.getSystem().broadcastOn([sD],o),e.getSystem().broadcastOn([lD],o.internalDialog),e.getSystem().broadcastOn([fD],o.internalDialog),e.getSystem().broadcastOn([dD],o.internalDialog),r.setData(o.initialData)}))},close:function(){o((function(t){Vo(t,$b)}))}};return r},ND=tinymce.util.Tools.resolve("tinymce.util.URI"),LD=["insertContent","setContent","execCommand","close","block","unblock"],jD=function(t){return O(t)&&-1!==LD.indexOf(t.mceAction)},UD=function(t,n,e,o){var r,u,a,c,s=_D(t.title,o),f=(u={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[gS({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:Da([Wb.config({}),Dm.config({})])})]}],behaviours:Da([wm.config({mode:"acyclic",useTabstopAt:i(vS)})])},xA.parts.body(u)),m=t.buttons.bind((function(t){return 0===t.length?w.none():w.some(PD({buttons:t},o))})),g=function(t,n){var e=function(n,e){return Go(n,(function(n,r){o(n,(function(o,i){e(t(),o,r.event,n)}))}))},o=function(t,n){O_.getState(t).get().each((function(e){n(e,t)}))};return d(DD(e,n),[e(Zb,(function(t,n,e){n.onAction(t,{name:e.name})}))])}((function(){return k}),ED((function(){return S}),o.shared.providers,n)),p=l(l({},t.height.fold((function(){return{}}),(function(t){return{height:t+"px","max-height":t+"px"}}))),t.width.fold((function(){return{}}),(function(t){return{width:t+"px","max-width":t+"px"}}))),h=t.width.isNone()&&t.height.isNone()?["tox-dialog--width-lg"]:[],v=new ND(t.url,{base_uri:new ND(window.location.href)}),b=v.protocol+"://"+v.host+(v.port?":"+v.port:""),y=Zn(w.none()),x=[Tm("messages",[Qo((function(){var n=wb(re(window),"message",(function(n){var o,r;v.isSameOrigin(new ND(n.raw.origin))&&(o=n.raw.data,jD(o)?function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content);break;case"setContent":t.setContent(e.content);break;case"execCommand":var o=!!T(e.ui)&&e.ui;t.execCommand(e.cmd,o,e.value);break;case"close":n.close();break;case"block":n.block(e.message);break;case"unblock":n.unblock()}}(e,k,o):!jD(r=o)&&O(r)&&Et(r,"mceAction")&&t.onMessage(k,o))}));y.set(w.some(n))})),Zo((function(){y.get().each((function(t){return t.unbind()}))}))]),Ha.config({channels:((r={})[mD]={onReceive:function(t,n){_u(t.element,"iframe").each((function(t){t.dom.contentWindow.postMessage(n,b)}))}},r)})],S=BD({header:s,body:f,footer:m,extraClasses:h,extraBehaviours:x,extraStyles:p},t,g,o),k=(c=function(t){a.getSystem().isConnected()&&t(a)},{block:function(t){if(!C(t))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");c((function(n){Po(n,ny,{message:t})}))},unblock:function(){c((function(t){Vo(t,ey)}))},close:function(){c((function(t){Vo(t,$b)}))},sendMessage:function(t){c((function(n){n.getSystem().broadcastOn([mD],t)}))}});return{dialog:a=S,instanceApi:k}},WD=function(t){var n,e,o,r,i=t.backstage,u=t.editor,a=Xh(u),c=(e=(n=t).backstage.shared,{open:function(t,o){var r=function(){xA.hide(c),o()},i=Bg(Bk({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:w.none()},"cancel",n.backstage)),u=bD(),a=vD(r,e.providers),c=Gi(SD({lazySink:function(){return e.getSink()},header:hD(u,a),body:yD(t,e.providers),footer:w.some(xD(wD([],[i.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Go(Qb,r)],eventOrder:{}}));xA.show(c);var s=i.get(c);Dm.focus(s)}}),s=(r=(o=t).backstage.shared,{open:function(t,n){var e=function(t){xA.hide(s),n(t)},i=Bg(Bk({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:w.none()},"submit",o.backstage)),u=Bk({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:w.none()},"cancel",o.backstage),a=bD(),c=vD((function(){return e(!1)}),r.providers),s=Gi(SD({lazySink:function(){return r.getSink()},header:hD(a,c),body:yD(t,r.providers),footer:w.some(xD(wD([],[u,i.asSpec()]))),onEscape:function(){return e(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Go(Qb,(function(){return e(!1)})),Go(ty,(function(){return e(!0)}))],eventOrder:{}}));xA.show(s);var l=i.get(s);Dm.focus(l)}}),f=function(t,n){return WM.open((function(t,e,o){var r=e,u=function(t,n,e){var o,r,i,u=_D(t.internalDialog.title,e),a=(o={body:t.internalDialog.body},r=e,i=gD(o,w.none(),r,!1),xA.parts.body(i)),c=AD(t.internalDialog.buttons),s=MD(c),l=PD({buttons:c},e),f=FD((function(){return p}),ED((function(){return g}),e.shared.providers,n),e.shared.getSink),d=function(t){switch(t){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}}(t.internalDialog.size),m={header:u,body:a,footer:w.some(l),extraClasses:d,extraBehaviours:[],extraStyles:{}},g=BD(m,t,f,e),p=zD({getRoot:function(){return g},getBody:function(){return xA.getBody(g)},getFooter:function(){return xA.getFooter(g)},getFormWrapper:function(){var t=xA.getBody(g);return vf.getCurrent(t).getOr(t)}},n.redial,s);return{dialog:g,instanceApi:p}}({dataValidator:o,initialData:r,internalDialog:t},{redial:WM.redial,closeWindow:function(){xA.hide(u.dialog),n(u.instanceApi)}},i);return xA.show(u.dialog),u.instanceApi.setData(r),u.instanceApi}),t)},m=function(t,n,e,o){return WM.open((function(t,r,c){var s,f,m,g=pn(gn("data",c,r)),p=(s=Zn(w.none()),{clear:function(){return s.set(w.none())},set:function(t){return s.set(w.some(t))},isSet:function(){return s.get().isSome()},on:function(t){return s.get().each(t)}}),h=i.shared.header.isPositionedAtTop(),v=function(){return p.on((function(t){pg.reposition(t),eE.refresh(t)}))},b=function(t,n,e,o){var r,i,u,a,c,s,l,f,d,m=Wr("dialog-label"),g=Wr("dialog-content"),p=Bg((u={title:t.internalDialog.title,draggable:!0},a=m,c=e.shared.providers,Pb.sketch({dom:CE('<div class="tox-dialog__header"></div>'),components:[CD(u,w.some(a),c),OD(),kD(c)],containerBehaviours:Da([iA.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return Tu(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),h=Bg((s={body:t.internalDialog.body},l=g,f=e,d=o,gD(s,w.some(l),f,d))),v=AD(t.internalDialog.buttons),b=MD(v),y=Bg(VD({buttons:v},e)),x=FD((function(){return k}),{onBlock:function(t){yA.block(S,(function(n,o){return TD(t.message,o,e.shared.providers)}))},onUnblock:function(){yA.unblock(S)},onClose:function(){return n.closeWindow()}},e.shared.getSink),S=Gi({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:((r={role:"dialog"})["aria-labelledby"]=m,r["aria-describedby"]=""+g,r)},eventOrder:((i={})[go()]=[O_.name(),Ha.name()],i[po()]=["execute-on-form"],i[_o()]=["reflecting","execute-on-form"],i),behaviours:Da([wm.config({mode:"cyclic",onEscape:function(t){return Vo(t,$b),w.some(!0)},useTabstopAt:function(t){return!vS(t)&&("button"!==er(t)||"disabled"!==Vr(t,"disabled"))}}),O_.config({channel:sD,updateState:function(t,n){return w.some(n)},initialData:t}),Dm.config({}),Tm("execute-on-form",x.concat([$o(Ze(),(function(t,n){wm.focusIn(t)}))])),yA.config({getRoot:function(){return w.some(S)}}),_m.config({}),lS({})]),components:[p.asSpec(),h.asSpec(),y.asSpec()]}),k=zD({getRoot:function(){return S},getFooter:function(){return y.get(S)},getBody:function(){return h.get(S)},getFormWrapper:function(){var t=h.get(S);return vf.getCurrent(t).getOr(t)}},n.redial,b);return{dialog:S,instanceApi:k}}({dataValidator:c,initialData:g,internalDialog:t},{redial:WM.redial,closeWindow:function(){p.on(pg.hide),u.off("ResizeEditor",v),p.clear(),e(b.instanceApi)}},i,o),y=Gi(pg.sketch(l(l({lazySink:i.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},h?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:Da(d([Tm("window-manager-inline-events",[Go(Eo(),(function(t,n){Vo(b.dialog,Qb)}))])],(f=u,m=h,a&&m?[]:[eE.config({contextual:{lazyContext:function(){return w.some(hu(re(f.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]))),isExtraPart:function(t,n){return Cb(e=n,".tox-alert-dialog")||Cb(e,".tox-confirm-dialog");var e}})));return p.set(y),pg.showWithin(y,n,Xi(b.dialog),w.some(Ci())),a&&h||(eE.refresh(y),u.on("ResizeEditor",v)),b.instanceApi.setData(g),wm.focusIn(b.dialog),b.instanceApi}),t)};return{open:function(t,n,e){return void 0!==n&&"toolbar"===n.inline?m(t,i.shared.anchors.inlineDialog(),e,n.ariaAttrs):void 0!==n&&"cursor"===n.inline?m(t,i.shared.anchors.cursor(),e,n.ariaAttrs):f(t,e)},openUrl:function(t,n){return function(t,n){return WM.openUrl((function(t){var e=UD(t,{closeWindow:function(){xA.hide(e.dialog),n(e.instanceApi)}},u,i);return xA.show(e.dialog),e.instanceApi}),t)}(t,n)},alert:function(t,n){c.open(t,(function(){n()}))},close:function(t){t.close()},confirm:function(t,n){s.open(t,(function(t){n(t)}))}}};s.add("silver",(function(t){var n=mA(t),o=n.uiMothership,r=n.backstage,i=n.renderUI,u=n.getUi;yb(t,r.shared);var a=WD({editor:t,backstage:r});return{renderUI:i,getWindowManagerImpl:e(a),getNotificationManagerImpl:function(){return function(t,n,e){var o=n.backstage;return{open:function(t,r){var i=!t.closeButton&&t.timeout&&(0<t.timeout||t.timeout<0),u=function(){r(),pg.hide(c)},a=Gi(Fg.sketch({text:t.text,level:P(["success","error","warning","warn","info"],t.type)?t.type:void 0,progress:!0===t.progressBar,icon:w.from(t.icon),closeButton:!i,onAction:u,iconProvider:o.shared.providers.icons,translationProvider:o.shared.providers.translate})),c=Gi(pg.sketch(l({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:n.backstage.shared.getSink,fireDismissalEventInstead:{}},o.shared.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));return e.add(c),0<t.timeout&&Tg.setTimeout((function(){u()}),t.timeout),{close:u,moveTo:function(t,n){pg.showAt(c,{anchor:"makeshift",x:t,y:n},Xi(a))},moveRel:function(t,e){var o,r;"banner"!==e?(o=function(t){switch(t){case"bc-bc":return _g;case"tc-tc":return Og;case"tc-bc":return va;case"bc-tc":default:return ba}}(e),r={anchor:"node",root:Ci(),node:w.some(re(t)),layouts:{onRtl:function(){return[o]},onLtr:function(){return[o]}}},pg.showAt(c,r,Xi(a))):pg.showAt(c,n.backstage.shared.anchors.banner(),Xi(a))},text:function(t){Fg.updateText(a,t)},settings:t,getEl:function(){return a.element.dom},progressBar:{value:function(t){Fg.updateProgress(a,t)}}}},close:function(t){t.close()},reposition:function(t){var n;j(t,(function(t){return t.moveTo(0,0)})),0<(n=t).length&&(et(n).each((function(t){return t.moveRel(null,"banner")})),j(n,(function(t,e){0<e&&t.moveRel(n[e-1].getEl(),"bc-tc")})))},getArgs:function(t){return t.settings}}}(0,{backstage:r},o)},ui:u()}}))}();